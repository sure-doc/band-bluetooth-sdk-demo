!function(){var e={689:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return I}});var i=n(67);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){return"function"==typeof e}function f(e){return void 0===e}function d(e){return e&&"object"===r(e)}var p=function(e){return!d(e)};function h(e){throw new TypeError(e)}l(Object.assign)||(Object.assign=function(e){null==e&&h("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),l(Object.defineProperties)||(Object.defineProperties=function(e,t){function n(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}p(e)&&h("bad desc");var n={};if(t(e,"enumerable")&&(n.enumerable=!!e.enumerable),t(e,"configurable")&&(n.configurable=!!e.configurable),t(e,"value")&&(n.value=e.value),t(e,"writable")&&(n.writable=!!e.writable),t(e,"get")){var r=e.get;l(r)||f(r)||h("bad get"),n.get=r}if(t(e,"set")){var i=e.set;l(i)||f(i)||h("bad set"),n.set=i}return("get"in n||"set"in n)&&("value"in n||"writable"in n)&&h("identity-confused descriptor"),n}p(e)&&h("bad obj"),t=Object(t);for(var r=Object.keys(t),i=[],o=0;o<r.length;o++)i.push([r[o],n(t[r[o]])]);for(var a=0;a<i.length;a++)Object.defineProperty(e,i[a][0],i[a][1]);return e});var v={WEAPP:"WEAPP",WEB:"WEB",RN:"RN",SWAN:"SWAN",ALIPAY:"ALIPAY",TT:"TT",QQ:"QQ",JD:"JD"};var y=function(){function e(t,n,r){c(this,e),this.index=r||0,this.requestParams=t,this.interceptors=n||[]}return s(e,[{key:"proceed",value:function(e){if(this.requestParams=e,this.index>=this.interceptors.length)throw new Error("chain 参数错误, 请勿直接修改 request.chain");var t=this._getNextInterceptor()(this._getNextChain()),n=t.catch((function(e){return Promise.reject(e)}));return Object.keys(t).forEach((function(e){return l(t[e])&&(n[e]=t[e])})),n}},{key:"_getNextInterceptor",value:function(){return this.interceptors[this.index]}},{key:"_getNextChain",value:function(){return new e(this.requestParams,this.interceptors,this.index+1)}}]),e}(),g=function(){function e(t){c(this,e),this.taroInterceptor=t,this.chain=new y}return s(e,[{key:"request",value:function(e){var t=this.chain,n=this.taroInterceptor;return t.interceptors=t.interceptors.filter((function(e){return e!==n})).concat(n),t.proceed(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}},{key:"addInterceptor",value:function(e){this.chain.interceptors.push(e)}},{key:"cleanInterceptors",value:function(){this.chain=new y}}]),e}();var m={640:1.17,750:1,828:.905};function b(e){return function(t){var n=t.designWidth,r=void 0===n?750:n,i=t.deviceRatio,o=void 0===i?m:i,a=t.baseFontSize,c=void 0===a?20:a;e.config=e.config||{},e.config.designWidth=r,e.config.deviceRatio=o,e.config.baseFontSize=c}}var w,S,I={Behavior:function(e){return e},getEnv:function(){return v.WEAPP},ENV_TYPE:v,Link:g,interceptors:Object.freeze({__proto__:null,timeoutInterceptor:function(e){var t,n=e.requestParams,r=new Promise((function(r,i){var o=setTimeout((function(){o=null,i(new Error("网络链接超时,请稍后再试！"))}),n&&n.timeout||6e4);(t=e.proceed(n)).then((function(e){o&&(clearTimeout(o),r(e))})).catch((function(e){o&&clearTimeout(o),i(e)}))}));return!f(t)&&l(t.abort)&&(r.abort=t.abort),r},logInterceptor:function(e){var t=e.requestParams;t.method,t.data,t.url;var n=e.proceed(t),r=n.then((function(e){return e}));return l(n.abort)&&(r.abort=n.abort),r}}),Current:i.Current,getCurrentInstance:i.getCurrentInstance,options:i.options,nextTick:i.nextTick,eventCenter:i.eventCenter,Events:i.Events,getInitPxTransform:b};I.initPxTransform=b(I),I.preload=(w=i.Current,function(e,t){w.preloadData=d(e)?e:o({},e,t)}),I.pxTransform=(S=I,function(e){var t=S.config||{},n=t.designWidth,r=void 0===n?750:n,i=t.deviceRatio,o=void 0===i?m:i;if(!(r in o))throw new Error("deviceRatio 配置中不存在 ".concat(r," 的设置！"));return parseInt(e,10)*o[r]+"rpx"})},67:function(e,t,n){"use strict";n.r(t),n.d(t,{Current:function(){return Qt},Events:function(){return v},FormElement:function(){return Pt},MutationObserver:function(){return ue},SVGElement:function(){return Kt},Style:function(){return Je},TaroElement:function(){return Ye},TaroEvent:function(){return Ot},TaroNode:function(){return Te},TaroRootElement:function(){return jt},TaroText:function(){return Rt},addLeadingSlash:function(){return on},cancelAnimationFrame:function(){return Wt},createComponentConfig:function(){return pn},createEvent:function(){return kt},createPageConfig:function(){return dn},createRecursiveComponentConfig:function(){return hn},document:function(){return Ft},eventCenter:function(){return Jt},eventHandler:function(){return Lt},eventSource:function(){return we},getComputedStyle:function(){return $t},getCurrentInstance:function(){return Yt},getPageInstance:function(){return nn},hooks:function(){return D},hydrate:function(){return _e},incrementId:function(){return se},injectPageInstance:function(){return tn},navigator:function(){return Vt},nextTick:function(){return vn},now:function(){return Gt},options:function(){return Xe},removePageInstance:function(){return rn},requestAnimationFrame:function(){return Ht},safeExecute:function(){return an},stringify:function(){return cn},window:function(){return Zt}});const r="[]",i="",o="!0",a="!1",c={bindTouchStart:i,bindTouchMove:i,bindTouchEnd:i,bindTouchCancel:i,bindLongTap:i},u={animation:i,bindAnimationStart:i,bindAnimationIteration:i,bindAnimationEnd:i,bindTransitionEnd:i};function s(e){return`'${e}'`}const l=Object.assign(Object.assign({"hover-class":s("none"),"hover-stop-propagation":a,"hover-start-time":"50","hover-stay-time":"400"},c),u),f={type:i,size:"23",color:i},d=Object.assign({longitude:i,latitude:i,scale:"16",markers:r,covers:i,polyline:r,circles:r,controls:r,"include-points":r,"show-location":i,"layer-style":"1",bindMarkerTap:i,bindControlTap:i,bindCalloutTap:i,bindUpdated:i},c),p={View:l,Icon:f,Progress:{percent:i,"stroke-width":"6",color:s("#09BB07"),activeColor:s("#09BB07"),backgroundColor:s("#EBEBEB"),active:a,"active-mode":s("backwards"),"show-info":a},RichText:{nodes:r},Text:{selectable:a,space:i,decode:a},Button:Object.assign({size:s("default"),type:i,plain:a,disabled:i,loading:a,"form-type":i,"open-type":i,"hover-class":s("button-hover"),"hover-stop-propagation":a,"hover-start-time":"20","hover-stay-time":"70",name:i},c),Checkbox:{value:i,disabled:i,checked:a,color:s("#09BB07"),name:i},CheckboxGroup:{bindChange:i,name:i},Form:{"report-submit":a,bindSubmit:i,bindReset:i,name:i},Input:{value:i,type:s(i),password:a,placeholder:i,"placeholder-style":i,"placeholder-class":s("input-placeholder"),disabled:i,maxlength:"140","cursor-spacing":"0",focus:a,"confirm-type":s("done"),"confirm-hold":a,cursor:"i.value.length","selection-start":"-1","selection-end":"-1",bindInput:i,bindFocus:i,bindBlur:i,bindConfirm:i,name:i},Label:{for:i,name:i},Picker:{mode:s("selector"),disabled:i,range:i,"range-key":i,value:i,start:i,end:i,fields:s("day"),"custom-item":i,name:i,bindCancel:i,bindChange:i,bindColumnChange:i},PickerView:{value:i,"indicator-style":i,"indicator-class":i,"mask-style":i,"mask-class":i,bindChange:i,name:i},PickerViewColumn:{name:i},Radio:{value:i,checked:a,disabled:i,color:s("#09BB07"),name:i},RadioGroup:{bindChange:i,name:i},Slider:{min:"0",max:"100",step:"1",disabled:i,value:"0",activeColor:s("#1aad19"),backgroundColor:s("#e9e9e9"),"block-size":"28","block-color":s("#ffffff"),"show-value":a,bindChange:i,bindChanging:i,name:i},Switch:{checked:a,disabled:i,type:s("switch"),color:s("#04BE02"),bindChange:i,name:i},CoverImage:{src:i,bindLoad:"eh",bindError:"eh"},Textarea:{value:i,placeholder:i,"placeholder-style":i,"placeholder-class":s("textarea-placeholder"),disabled:i,maxlength:"140","auto-focus":a,focus:a,"auto-height":a,fixed:a,"cursor-spacing":"0",cursor:"-1","selection-start":"-1","selection-end":"-1",bindFocus:i,bindBlur:i,bindLineChange:i,bindInput:i,bindConfirm:i,name:i},CoverView:Object.assign({"scroll-top":a},c),MovableArea:{"scale-area":a},MovableView:Object.assign(Object.assign({direction:"none",inertia:a,"out-of-bounds":a,x:i,y:i,damping:"20",friction:"2",disabled:i,scale:a,"scale-min":"0.5","scale-max":"10","scale-value":"1",bindChange:i,bindScale:i,bindHTouchMove:i,bindVTouchMove:i,width:s("10px"),height:s("10px")},c),u),ScrollView:Object.assign(Object.assign({"scroll-x":a,"scroll-y":a,"upper-threshold":"50","lower-threshold":"50","scroll-top":i,"scroll-left":i,"scroll-into-view":i,"scroll-with-animation":a,"enable-back-to-top":a,bindScrollToUpper:i,bindScrollToLower:i,bindScroll:i},c),u),Swiper:Object.assign({"indicator-dots":a,"indicator-color":s("rgba(0, 0, 0, .3)"),"indicator-active-color":s("#000000"),autoplay:a,current:"0",interval:"5000",duration:"500",circular:a,vertical:a,"previous-margin":s("0px"),"next-margin":s("0px"),"display-multiple-items":"1",bindChange:i,bindTransition:i,bindAnimationFinish:i},c),SwiperItem:{"item-id":i},Navigator:{url:i,"open-type":s("navigate"),delta:"1","hover-class":s("navigator-hover"),"hover-stop-propagation":a,"hover-start-time":"50","hover-stay-time":"600",bindSuccess:i,bindFail:i,bindComplete:i},Audio:{id:i,src:i,loop:a,controls:a,poster:i,name:i,author:i,bindError:i,bindPlay:i,bindPause:i,bindTimeUpdate:i,bindEnded:i},Camera:{"device-position":s("back"),flash:s("auto"),bindStop:i,bindError:i},Image:Object.assign({src:i,mode:s("scaleToFill"),"lazy-load":a,bindError:i,bindLoad:i},c),LivePlayer:Object.assign({src:i,autoplay:a,muted:a,orientation:s("vertical"),"object-fit":s("contain"),"background-mute":a,"min-cache":"1","max-cache":"3",bindStateChange:i,bindFullScreenChange:i,bindNetStatus:i},u),Video:Object.assign({src:i,duration:i,controls:o,"danmu-list":i,"danmu-btn":i,"enable-danmu":i,autoplay:a,loop:a,muted:a,"initial-time":"0","page-gesture":a,direction:i,"show-progress":o,"show-fullscreen-btn":o,"show-play-btn":o,"show-center-play-btn":o,"enable-progress-gesture":o,"object-fit":s("contain"),poster:i,"show-mute-btn":a,bindPlay:i,bindPause:i,bindEnded:i,bindTimeUpdate:i,bindFullScreenChange:i,bindWaiting:i,bindError:i},u),Canvas:Object.assign({"canvas-id":i,"disable-scroll":a,bindError:i},c),Ad:{"unit-id":i,"ad-intervals":i,bindLoad:i,bindError:i,bindClose:i},WebView:{src:i,bindMessage:i,bindLoad:i,bindError:i},Block:{},Map:d,Slot:{name:i},SlotView:{name:i}},h=new Set(["input","checkbox","picker","picker-view","radio","slider","switch","textarea"]);new Set(["input","textarea"]),new Set(["progress","icon","rich-text","input","textarea","slider","switch","audio","ad","official-account","open-data","navigation-bar"]),new Map([["view",-1],["catch-view",-1],["cover-view",-1],["static-view",-1],["pure-view",-1],["block",-1],["text",-1],["static-text",6],["slot",8],["slot-view",8],["label",6],["form",4],["scroll-view",4],["swiper",4],["swiper-item",4]]);class v{constructor(e){var t;this.callbacks=null!==(t=null==e?void 0:e.callbacks)&&void 0!==t?t:{}}on(e,t,n){let r,i,o,a;if(!t)return this;e=e.split(v.eventSplitter),this.callbacks||(this.callbacks={});const c=this.callbacks;for(;r=e.shift();)a=c[r],i=a?a.tail:{},i.next=o={},i.context=n,i.callback=t,c[r]={tail:o,next:a?a.next:i};return this}once(e,t,n){const r=(...i)=>{t.apply(this,i),this.off(e,r,n)};return this.on(e,r,n),this}off(e,t,n){let r,i,o,a,c,u;if(!(i=this.callbacks))return this;if(!(e||t||n))return delete this.callbacks,this;for(e=e?e.split(v.eventSplitter):Object.keys(i);r=e.shift();)if(o=i[r],delete i[r],o&&(t||n))for(a=o.tail;(o=o.next)!==a;)c=o.callback,u=o.context,(t&&c!==t||n&&u!==n)&&this.on(r,c,u);return this}trigger(e){let t,n,r,i;if(!(r=this.callbacks))return this;e=e.split(v.eventSplitter);const o=[].slice.call(arguments,1);for(;t=e.shift();)if(n=r[t])for(i=n.tail;(n=n.next)!==i;)n.callback.apply(n.context||this,o);return this}}function y(e){return"string"==typeof e}function g(e){return void 0===e}function m(e){return null===e}function b(e){return null!==e&&"object"==typeof e}function w(e){return"function"==typeof e}v.eventSplitter=/\s+/;const S=Array.isArray;var I;!function(e){e[e.SINGLE=0]="SINGLE",e[e.MULTI=1]="MULTI",e[e.WATERFALL=2]="WATERFALL"}(I||(I={}));const C={app:["onLaunch","onShow","onHide"],page:["onLoad","onUnload","onReady","onShow","onHide",["onPullDownRefresh","onReachBottom","onPageScroll","onResize","onTabItemTap","onTitleClick","onOptionMenuClick","onPopMenuClick","onPullIntercept","onAddToFavorites"],["onShareAppMessage","onShareTimeline"]],component:["attached","detached"]};function _(e,t){return{type:e,initial:t||null}}const D=new class extends v{constructor(e,t){super(t),this.hooks=e;for(const t in e){const{initial:n}=e[t];w(n)&&this.on(t,n)}}tapOneOrMany(e,t){(w(t)?[t]:t).forEach((t=>this.on(e,t)))}tap(e,t){const n=this.hooks,{type:r,initial:i}=n[e];r===I.SINGLE?(this.off(e),this.on(e,w(t)?t:t[t.length-1])):(i&&this.off(e,i),this.tapOneOrMany(e,t))}call(e,...t){var n;const r=this.hooks[e];if(!r)return;const{type:i}=r,o=this.callbacks;if(!o)return;const a=o[e];if(a){const e=a.tail;let r,o=a.next,c=t;for(;o!==e;){if(r=null===(n=o.callback)||void 0===n?void 0:n.apply(o.context||this,c),i===I.WATERFALL){c=[r]}o=o.next}return r}}isExist(e){var t;return Boolean(null===(t=this.callbacks)||void 0===t?void 0:t[e])}}({getMiniLifecycle:_(I.SINGLE,(e=>e)),getMiniLifecycleImpl:_(I.SINGLE,(function(){return this.call("getMiniLifecycle",C)})),getLifecycle:_(I.SINGLE,((e,t)=>e[t])),getPathIndex:_(I.SINGLE,(e=>`[${e}]`)),getEventCenter:_(I.SINGLE,(e=>new e)),isBubbleEvents:_(I.SINGLE,(e=>new Set(["touchstart","touchmove","touchcancel","touchend","touchforcechange","tap","longpress","longtap","transitionend","animationstart","animationiteration","animationend"]).has(e))),getSpecialNodes:_(I.SINGLE,(()=>["view","text","image"])),onRemoveAttribute:_(I.SINGLE),batchedEventUpdates:_(I.SINGLE),mergePageInstance:_(I.SINGLE),modifyPageObject:_(I.SINGLE),createPullDownComponent:_(I.SINGLE),getDOMNode:_(I.SINGLE),modifyHydrateData:_(I.SINGLE),modifySetAttrPayload:_(I.SINGLE),modifyRmAttrPayload:_(I.SINGLE),onAddEvent:_(I.SINGLE),modifyMpEvent:_(I.MULTI),modifyMpEventImpl:_(I.SINGLE,(function(e){try{this.call("modifyMpEvent",e)}catch(e){console.warn("[Taro modifyMpEvent hook Error]: ",e)}})),modifyTaroEvent:_(I.MULTI),modifyDispatchEvent:_(I.MULTI),initNativeApi:_(I.MULTI),patchElement:_(I.MULTI)}),T={},E=(...e)=>{};function A(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function x(e){let t="",n=!1;for(let r=0;r<e.length;r++)"-"!==e[r]?(t+=n?e[r].toUpperCase():e[r],n=!1):n=!0;return t}Object.prototype.hasOwnProperty;function O(e,t){if(!e)throw new Error(t)}(new Date).getTime().toString();new Set(["addPhoneContact","authorize","canvasGetImageData","canvasPutImageData","canvasToTempFilePath","checkSession","chooseAddress","chooseImage","chooseInvoiceTitle","chooseLocation","chooseVideo","clearStorage","closeBLEConnection","closeBluetoothAdapter","closeSocket","compressImage","connectSocket","createBLEConnection","downloadFile","exitMiniProgram","getAvailableAudioSources","getBLEDeviceCharacteristics","getBLEDeviceServices","getBatteryInfo","getBeacons","getBluetoothAdapterState","getBluetoothDevices","getClipboardData","getConnectedBluetoothDevices","getConnectedWifi","getExtConfig","getFileInfo","getImageInfo","getLocation","getNetworkType","getSavedFileInfo","getSavedFileList","getScreenBrightness","getSetting","getStorage","getStorageInfo","getSystemInfo","getUserInfo","getWifiList","hideHomeButton","hideShareMenu","hideTabBar","hideTabBarRedDot","loadFontFace","login","makePhoneCall","navigateBack","navigateBackMiniProgram","navigateTo","navigateToBookshelf","navigateToMiniProgram","notifyBLECharacteristicValueChange","hideKeyboard","hideLoading","hideNavigationBarLoading","hideToast","openBluetoothAdapter","openDocument","openLocation","openSetting","pageScrollTo","previewImage","queryBookshelf","reLaunch","readBLECharacteristicValue","redirectTo","removeSavedFile","removeStorage","removeTabBarBadge","requestSubscribeMessage","saveFile","saveImageToPhotosAlbum","saveVideoToPhotosAlbum","scanCode","sendSocketMessage","setBackgroundColor","setBackgroundTextStyle","setClipboardData","setEnableDebug","setInnerAudioOption","setKeepScreenOn","setNavigationBarColor","setNavigationBarTitle","setScreenBrightness","setStorage","setTabBarBadge","setTabBarItem","setTabBarStyle","showActionSheet","showFavoriteGuide","showLoading","showModal","showShareMenu","showTabBar","showTabBarRedDot","showToast","startBeaconDiscovery","startBluetoothDevicesDiscovery","startDeviceMotionListening","startPullDownRefresh","stopBeaconDiscovery","stopBluetoothDevicesDiscovery","stopCompass","startCompass","startAccelerometer","stopAccelerometer","showNavigationBarLoading","stopDeviceMotionListening","stopPullDownRefresh","switchTab","uploadFile","vibrateLong","vibrateShort","writeBLECharacteristicValue"]);const k="小程序 setData",B="页面初始化",L="root",P="document-fragment",N="id",M="class",j="style",R="focus",U="view",F="static-view",$="pure-view",q="props",V="dataset",G="value",z="input",H="custom-wrapper",W="catchMove",J="catch-view",Z="comment",K="onLoad",Q="onReady",Y="onShow",X="onHide",ee="options",te="externalClasses",ne="behaviors",re=[];class ie{constructor(e){this.records=[],this.callback=e}observe(e,t){this.disconnect(),this.target=e,this.options=t||{},re.push(this)}disconnect(){this.target=null;const e=re.indexOf(this);e>=0&&re.splice(e,1)}takeRecords(){return this.records.splice(0,this.records.length)}}const oe=(e,t)=>{const{characterData:n,characterDataOldValue:r,attributes:i,attributeOldValue:o,childList:a}=t;switch(e.type){case"characterData":return!!n&&(r||(e.oldValue=null),!0);case"attributes":return!!i&&(o||(e.oldValue=null),!0);case"childList":return!!a}};let ae=!1;function ce(e,t){e.records.push(t),ae||(ae=!0,Promise.resolve().then((()=>{ae=!1,re.forEach((e=>e.callback(e.takeRecords())))})))}class ue{constructor(e){ENABLE_MUTATION_OBSERVER?this.core=new ie(e):this.core={observe:E,disconnect:E,takeRecords:E}}observe(...e){this.core.observe(...e)}disconnect(){this.core.disconnect()}takeRecords(){return this.core.takeRecords()}static record(e){!function(e){re.forEach((t=>{const{options:n}=t;for(let o=e.target;o;o=o.parentNode){if(i=o,(r=t.target)&&r.sid===(null==i?void 0:i.sid)&&oe(e,n)){ce(t,e);break}if(!n.subtree)break}var r,i}))}(e)}}const se=()=>{const e=[];for(let t=65;t<=90;t++)e.push(t);for(let t=97;t<=122;t++)e.push(t);const t=e.length-1,n=[0,0];return()=>{const r=n.map((t=>e[t])),i=String.fromCharCode(...r);let o=n.length-1;for(n[o]++;n[o]>t;){if(n[o]=0,o-=1,o<0){n.push(0);break}n[o]++}return i}};function le(e){return 1===e.nodeType}function fe(e){return e.nodeName===Z}function de(e){const t=Object.keys(e.props).find((e=>!(/^(class|style|id)$/.test(e)||e.startsWith("data-"))));return Boolean(t)}function pe(e){switch(e){case j:return"st";case N:return"uid";case M:return"cl";default:return e}}const he=new Map;function ve(e,t,n){w(n)&&(n={value:n}),Object.defineProperty(e.prototype,t,Object.assign({configurable:!0,enumerable:!0},n))}let ye;function ge(){return ye||(ye=function(e){const t={},n=e.View,r={"#text":{},StaticView:n,StaticImage:e.Image,StaticText:e.Text,PureView:n,CatchView:n};return e=Object.assign(Object.assign({},e),r),Object.keys(e).sort(((e,t)=>{const n=/^(Static|Pure|Catch)*(View|Image|Text)$/,r=n.test(e),i=n.test(t);return r&&i?e>t?1:-1:r?-1:i||e>=t?1:-1})).forEach(((n,r)=>{const i={_num:String(r)};Object.keys(e[n]).filter((e=>!/^bind/.test(e)&&!["focus","blur"].includes(e))).sort().forEach(((e,t)=>{i[x(e)]="p"+t})),t[A(n)]=i})),t}(p)),ye}class me extends Set{constructor(e,t){super(),e.trim().split(/\s+/).forEach(super.add.bind(this)),this.el=t}get value(){return[...this].filter((e=>""!==e)).join(" ")}add(e){return super.add(e),this._update(),this}get length(){return this.size}remove(e){super.delete(e),this._update()}toggle(e){super.has(e)?super.delete(e):super.add(e),this._update()}replace(e,t){super.delete(e),super.add(t),this._update()}contains(e){return super.has(e)}toString(){return this.value}_update(){this.el.className=this.value}}class be extends Map{removeNode(e){const{sid:t,uid:n}=e;this.delete(t),n!==t&&n&&this.delete(n)}removeNodeTree(e){this.removeNode(e);const{childNodes:t}=e;t.forEach((e=>this.removeNodeTree(e)))}}const we=new be,Se={window:T,document:T};let Ie,Ce;function _e(e){Ce||(Ce=ge()),Ie||(Ie=D.call("getSpecialNodes"));const t=e.nodeName;if(function(e){return 3===e.nodeType}(e))return{v:e.nodeValue,nn:Ce[t]._num};const n={nn:t,sid:e.sid};e.uid!==e.sid&&(n.uid=e.uid),!e.isAnyEventBinded()&&Ie.indexOf(t)>-1&&(n.nn=`static-${t}`,t!==U||de(e)||(n.nn=$));const{props:r}=e;for(const e in r){const i=x(e);e.startsWith("data-")||e===M||e===j||e===N||i===W||(n[i]=r[e]),t===U&&i===W&&!1!==r[e]&&(n.nn=J)}let{childNodes:i}=e;i=i.filter((e=>!fe(e))),i.length>0?n.cn=i.map(_e):n.cn=[],""!==e.className&&(n.cl=e.className);const o=e.cssText;""!==o&&"swiper-item"!==t&&(n.st=o),D.call("modifyHydrateData",n);const a=n.nn,c=Ce[a];if(c){n.nn=c._num;for(const e in n)e in c&&(n[c[e]]=n[e],delete n[e])}return n}const De=se();class Te extends class{constructor(){this.__handlers={}}addEventListener(e,t,n){if(e=e.toLowerCase(),D.call("onAddEvent",e,t,n,this),"regionchange"===e)return this.addEventListener("begin",t,n),void this.addEventListener("end",t,n);let r=Boolean(n),i=!1;if(b(n)&&(r=Boolean(n.capture),i=Boolean(n.once)),i){const r=function(){t.apply(this,arguments),this.removeEventListener(e,r)};return void this.addEventListener(e,r,Object.assign(Object.assign({},n),{once:!1}))}const o=t;t=function(){o.apply(this,arguments)},t.oldHandler=o;const a=this.__handlers[e];S(a)?a.push(t):this.__handlers[e]=[t]}removeEventListener(e,t){if("regionchange"===(e=e.toLowerCase()))return this.removeEventListener("begin",t),void this.removeEventListener("end",t);if(!t)return;const n=this.__handlers[e];if(!S(n))return;const r=n.findIndex((e=>{if(e===t||e.oldHandler===t)return!0}));n.splice(r,1)}isAnyEventBinded(){const e=this.__handlers,t=Object.keys(e).find((t=>e[t].length));return Boolean(t)}}{constructor(){super(),this.parentNode=null,this.childNodes=[],this.hydrate=e=>()=>_e(e),this.uid="_"+De(),this.sid=this.uid,we.set(this.sid,this)}updateChildNodes(e){this.enqueueUpdate({path:`${this._path}.cn`,value:e?()=>[]:()=>this.childNodes.filter((e=>!fe(e))).map(_e)})}get _root(){var e;return(null===(e=this.parentNode)||void 0===e?void 0:e._root)||null}findIndex(e){const t=this.childNodes.indexOf(e);return O(-1!==t,"The node to be replaced is not a child of this node."),t}get _path(){const e=this.parentNode;if(e){const t=e.childNodes.filter((e=>!fe(e))).indexOf(this),n=D.call("getPathIndex",t);return`${e._path}.cn.${n}`}return""}get nextSibling(){const e=this.parentNode;return(null==e?void 0:e.childNodes[e.findIndex(this)+1])||null}get previousSibling(){const e=this.parentNode;return(null==e?void 0:e.childNodes[e.findIndex(this)-1])||null}get parentElement(){const e=this.parentNode;return 1===(null==e?void 0:e.nodeType)?e:null}get firstChild(){return this.childNodes[0]||null}get lastChild(){const e=this.childNodes;return e[e.length-1]||null}set textContent(e){const t=this.childNodes.slice(),n=[];for(;this.firstChild;)this.removeChild(this.firstChild,{doUpdate:!1});if(""===e)this.updateChildNodes(!0);else{const t=Se.document.createTextNode(e);n.push(t),this.appendChild(t),this.updateChildNodes()}ue.record({type:"childList",target:this,removedNodes:t,addedNodes:n})}insertBefore(e,t,n){if(e.nodeName===P)return e.childNodes.reduceRight(((e,t)=>(this.insertBefore(t,e),t)),t),e;if(e.remove({cleanRef:!1}),e.parentNode=this,t){const n=this.findIndex(t);this.childNodes.splice(n,0,e)}else this.childNodes.push(e);if(this._root)if(t)n?this.enqueueUpdate({path:e._path,value:this.hydrate(e)}):this.updateChildNodes();else{1===this.childNodes.length?this.updateChildNodes():this.enqueueUpdate({path:e._path,value:this.hydrate(e)})}return ue.record({type:"childList",target:this,addedNodes:[e],removedNodes:n?[t]:[],nextSibling:n?t.nextSibling:t||null,previousSibling:e.previousSibling}),e}appendChild(e){return this.insertBefore(e)}replaceChild(e,t){if(t.parentNode===this)return this.insertBefore(e,t,!0),t.remove({doUpdate:!1}),t}removeChild(e,t={}){const{cleanRef:n,doUpdate:r}=t;!1!==n&&!1!==r&&ue.record({type:"childList",target:this,removedNodes:[e],nextSibling:e.nextSibling,previousSibling:e.previousSibling});const i=this.findIndex(e);return this.childNodes.splice(i,1),e.parentNode=null,!1!==n&&we.removeNodeTree(e),this._root&&!1!==r&&this.updateChildNodes(),e}remove(e){var t;null===(t=this.parentNode)||void 0===t||t.removeChild(this,e)}hasChildNodes(){return this.childNodes.length>0}enqueueUpdate(e){var t;null===(t=this._root)||void 0===t||t.enqueueUpdate(e)}get ownerDocument(){return Se.document}static extend(e,t){ve(Te,e,t)}}const Ee="webkit",Ae=["all","appearance","blockOverflow","blockSize","bottom","clear","contain","content","continue","cursor","direction","display","filter","float","gap","height","inset","isolation","left","letterSpacing","lightingColor","markerSide","mixBlendMode","opacity","order","position","quotes","resize","right","rowGap","tabSize","tableLayout","top","userSelect","verticalAlign","visibility","voiceFamily","volume","whiteSpace","widows","width","zIndex","pointerEvents"];function xe(e,t,n){!n&&Ae.push(e),t.forEach((t=>{Ae.push(e+t),e===Ee&&Ae.push("Webkit"+t)}))}const Oe="Color",ke="Style",Be="Width",Le="Image",Pe="Size",Ne=[Oe,ke,Be],Me=["FitLength","FitWidth",Le],je=[...Me,"Radius"],Re=[...Ne,...Me],Ue=["EndRadius","StartRadius"],Fe=["Bottom","Left","Right","Top"],$e=["End","Start"],qe=["Content","Items","Self"],Ve=["BlockSize","Height","InlineSize",Be],Ge=["After","Before"];function ze(e){ue.record({type:"attributes",target:e._element,attributeName:"style",oldValue:e.cssText})}function He(e){const t=e._element;t._root&&t.enqueueUpdate({path:`${t._path}.st`,value:e.cssText})}function We(e,t){this[t]!==e&&(!this._pending&&ze(this),m(e)||g(e)?(this._usedStyleProp.delete(t),delete this._value[t]):(this._usedStyleProp.add(t),this._value[t]=e),!this._pending&&He(this))}xe("borderBlock",Ne),xe("borderBlockEnd",Ne),xe("borderBlockStart",Ne),xe("outline",[...Ne,"Offset"]),xe("border",[...Ne,"Boundary","Break","Collapse","Radius","Spacing"]),xe("borderFit",["Length",Be]),xe("borderInline",Ne),xe("borderInlineEnd",Ne),xe("borderInlineStart",Ne),xe("borderLeft",Re),xe("borderRight",Re),xe("borderTop",Re),xe("borderBottom",Re),xe("textDecoration",[Oe,ke,"Line"]),xe("textEmphasis",[Oe,ke,"Position"]),xe("scrollMargin",Fe),xe("scrollPadding",Fe),xe("padding",Fe),xe("margin",[...Fe,"Trim"]),xe("scrollMarginBlock",$e),xe("scrollMarginInline",$e),xe("scrollPaddingBlock",$e),xe("scrollPaddingInline",$e),xe("gridColumn",$e),xe("gridRow",$e),xe("insetBlock",$e),xe("insetInline",$e),xe("marginBlock",$e),xe("marginInline",$e),xe("paddingBlock",$e),xe("paddingInline",$e),xe("pause",Ge),xe("cue",Ge),xe("mask",["Clip","Composite",Le,"Mode","Origin","Position","Repeat",Pe,"Type"]),xe("borderImage",["Outset","Repeat","Slice","Source","Transform",Be]),xe("maskBorder",["Mode","Outset","Repeat","Slice","Source",Be]),xe("font",["Family","FeatureSettings","Kerning","LanguageOverride","MaxSize","MinSize","OpticalSizing","Palette",Pe,"SizeAdjust","Stretch",ke,"Weight","VariationSettings"]),xe("transform",["Box","Origin",ke]),xe("background",[Oe,Le,"Attachment","BlendMode","Clip","Origin","Position","Repeat",Pe]),xe("listStyle",[Le,"Position","Type"]),xe("scrollSnap",["Align","Stop","Type"]),xe("grid",["Area","AutoColumns","AutoFlow","AutoRows"]),xe("gridTemplate",["Areas","Columns","Rows"]),xe("overflow",["Block","Inline","Wrap","X","Y"]),xe("transition",["Delay","Duration","Property","TimingFunction"]),xe("color",["Adjust","InterpolationFilters","Scheme"]),xe("textAlign",["All","Last"]),xe("page",["BreakAfter","BreakBefore","BreakInside"]),xe("animation",["Delay","Direction","Duration","FillMode","IterationCount","Name","PlayState","TimingFunction"]),xe("flex",["Basis","Direction","Flow","Grow","Shrink","Wrap"]),xe("offset",[...Ge,...$e,"Anchor","Distance","Path","Position","Rotate"]),xe("perspective",["Origin"]),xe("clip",["Path","Rule"]),xe("flow",["From","Into"]),xe("align",["Content","Items","Self"],!0),xe("alignment",["Adjust","Baseline"],!0),xe("borderStart",Ue,!0),xe("borderEnd",Ue,!0),xe("borderCorner",["Fit",Le,"ImageTransform"],!0),xe("borderTopLeft",je,!0),xe("borderTopRight",je,!0),xe("borderBottomLeft",je,!0),xe("borderBottomRight",je,!0),xe("column",["s","Count","Fill","Gap","Rule","RuleColor","RuleStyle","RuleWidth","Span",Be],!0),xe("break",[...Ge,"Inside"],!0),xe("wrap",[...Ge,"Flow","Inside","Through"],!0),xe("justify",qe,!0),xe("place",qe,!0),xe("max",[...Ve,"Lines"],!0),xe("min",Ve,!0),xe("line",["Break","Clamp","Grid","Height","Padding","Snap"],!0),xe("inline",["BoxAlign",Pe,"Sizing"],!0),xe("text",["CombineUpright","GroupAlign","Height","Indent","Justify","Orientation","Overflow","Shadow","SpaceCollapse","SpaceTrim","Spacing","Transform","UnderlinePosition","Wrap"],!0),xe("shape",["ImageThreshold","Inside","Margin","Outside"],!0),xe("word",["Break","Spacing","Wrap"],!0),xe("object",["Fit","Position"],!0),xe("box",["DecorationBreak","Shadow","Sizing","Snap"],!0),xe(Ee,["LineClamp","BoxOrient","TextFillColor","TextStroke","TextStrokeColor","TextStrokeWidth"],!0);class Je{constructor(e){this._element=e,this._usedStyleProp=new Set,this._value={}}setCssVariables(e){this.hasOwnProperty(e)||Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>this._value[e]||"",set:t=>{We.call(this,t,e)}})}get cssText(){if(!this._usedStyleProp.size)return"";const e=[];return this._usedStyleProp.forEach((t=>{const n=this[t];if(m(n)||g(n))return;let r=/^--/.test(t)?t:A(t);0!==r.indexOf("webkit")&&0!==r.indexOf("Webkit")||(r=`-${r}`),e.push(`${r}: ${n};`)})),e.join(" ")}set cssText(e){if(this._pending=!0,ze(this),this._usedStyleProp.forEach((e=>{this.removeProperty(e)})),""===e||g(e)||m(e))return this._pending=!1,void He(this);const t=e.split(";");for(let e=0;e<t.length;e++){const n=t[e].trim();if(""===n)continue;const[r,...i]=n.split(":"),o=i.join(":");g(o)||this.setProperty(r.trim(),o.trim())}this._pending=!1,He(this)}setProperty(e,t){"-"===e[0]?this.setCssVariables(e):e=x(e),m(t)||g(t)?this.removeProperty(e):this[e]=t}removeProperty(e){if(e=x(e),!this._usedStyleProp.has(e))return"";const t=this[e];return this[e]=void 0,t}getPropertyValue(e){const t=this[e=x(e)];return t||""}}function Ze(){return!0}function Ke(e,t){const n=[],r=null!=t?t:Ze;let i=e;for(;i;)1===i.nodeType&&r(i)&&n.push(i),i=Qe(i,e);return n}function Qe(e,t){const n=e.firstChild;if(n)return n;let r=e;do{if(r===t)return null;const e=r.nextSibling;if(e)return e;r=r.parentElement}while(r);return null}!function(e){const t={};for(let e=0;e<Ae.length;e++){const n=Ae[e];t[n]={get(){const e=this._value[n];return m(e)||g(e)?"":e},set(e){We.call(this,e,n)}}}Object.defineProperties(e.prototype,t)}(Je);class Ye extends Te{constructor(){super(),this.props={},this.dataset=T,this.nodeType=1,this.style=new Je(this),D.call("patchElement",this)}_stopPropagation(e){let t=this;for(;t=t.parentNode;){const n=t.__handlers[e.type];if(S(n))for(let e=n.length;e--;){n[e]._stop=!0}}}get id(){return this.getAttribute(N)}set id(e){this.setAttribute(N,e)}get className(){return this.getAttribute(M)||""}set className(e){this.setAttribute(M,e)}get cssText(){return this.getAttribute(j)||""}get classList(){return new me(this.className,this)}get children(){return this.childNodes.filter(le)}get attributes(){const e=this.props,t=Object.keys(e),n=this.style.cssText;return t.map((t=>({name:t,value:e[t]}))).concat(n?{name:j,value:n}:[])}get textContent(){let e="";const t=this.childNodes;for(let n=0;n<t.length;n++)e+=t[n].textContent;return e}set textContent(e){super.textContent=e}hasAttribute(e){return!g(this.props[e])}hasAttributes(){return this.attributes.length>0}get focus(){return function(){this.setAttribute(R,!0)}}set focus(e){this.setAttribute(R,e)}blur(){this.setAttribute(R,!1)}setAttribute(e,t){const n=this.nodeName===U&&!de(this)&&!this.isAnyEventBinded();switch(e!==j&&ue.record({target:this,type:"attributes",attributeName:e,oldValue:this.getAttribute(e)}),e){case j:this.style.cssText=t;break;case N:this.uid!==this.sid&&we.delete(this.uid),t=String(t),this.props[e]=this.uid=t,we.set(t,this);break;default:this.props[e]=t,e.startsWith("data-")&&(this.dataset===T&&(this.dataset=Object.create(null)),this.dataset[x(e.replace(/^data-/,""))]=t)}if(!this._root)return;const r=ge(),i=r[this.nodeName],o=r.view._num,a=r[F]._num,c=r[J]._num,u=this._path,s=x(e=pe(e)),l={path:`${u}.${s}`,value:w(t)?()=>t:t};if(D.call("modifySetAttrPayload",this,e,l,r),i){const t=i[s]||e;l.path=`${u}.${x(t)}`}this.enqueueUpdate(l),this.nodeName===U&&(s===W?this.enqueueUpdate({path:`${u}.nn`,value:t?c:this.isAnyEventBinded()?o:a}):n&&de(this)&&this.enqueueUpdate({path:`${u}.nn`,value:a}))}removeAttribute(e){const t=this.nodeName===U&&de(this)&&!this.isAnyEventBinded();if(ue.record({target:this,type:"attributes",attributeName:e,oldValue:this.getAttribute(e)}),e===j)this.style.cssText="";else{if(D.call("onRemoveAttribute",this,e))return;if(!this.props.hasOwnProperty(e))return;delete this.props[e]}if(!this._root)return;const n=ge(),r=n[this.nodeName],i=n.view._num,o=n[F]._num,a=n[$]._num,c=this._path,u=x(e=pe(e)),s={path:`${c}.${u}`,value:""};if(D.call("modifyRmAttrPayload",this,e,s,n),r){const t=r[u]||e;s.path=`${c}.${x(t)}`}this.enqueueUpdate(s),this.nodeName===U&&(u===W?this.enqueueUpdate({path:`${c}.nn`,value:this.isAnyEventBinded()?i:de(this)?o:a}):t&&!de(this)&&this.enqueueUpdate({path:`${c}.nn`,value:a}))}getAttribute(e){const t=e===j?this.style.cssText:this.props[e];return null!=t?t:""}getElementsByTagName(e){return Ke(this,(t=>t.nodeName===e||"*"===e&&this!==t))}getElementsByClassName(e){return Ke(this,(t=>{const n=t.classList;return e.trim().split(/\s+/).every((e=>n.has(e)))}))}dispatchEvent(e){const t=e.cancelable,n=this.__handlers[e.type];if(!S(n))return!1;for(let r=n.length;r--;){const i=n[r];let o;if(i._stop?i._stop=!1:(D.call("modifyDispatchEvent",e,this),o=i.call(this,e)),(!1===o||e._end)&&t&&(e.defaultPrevented=!0),e._end&&e._stop)break}return e._stop?this._stopPropagation(e):e._stop=!0,null!=n}addEventListener(e,t,n){const r=this.nodeName,i=D.call("getSpecialNodes");let o=!0;if(b(n)&&!1===n.sideEffect&&(o=!1,delete n.sideEffect),!1!==o&&!this.isAnyEventBinded()&&i.indexOf(r)>-1){const e=ge()[r]._num;this.enqueueUpdate({path:`${this._path}.nn`,value:e})}super.addEventListener(e,t,n)}removeEventListener(e,t,n=!0){super.removeEventListener(e,t);const r=this.nodeName,i=D.call("getSpecialNodes");if(!1!==n&&!this.isAnyEventBinded()&&i.indexOf(r)>-1){const e=ge()[de(this)?`static-${r}`:`pure-${r}`]._num;this.enqueueUpdate({path:`${this._path}.nn`,value:e})}}static extend(e,t){ve(Ye,e,t)}}const Xe={prerender:!0,debug:!1};function et(e,t,n){const r=e.index,i=e.index=r+n;for(let n=r;n<i;n++){"\n"===t.charAt(n)?(e.line++,e.column=0):e.column++}}function tt(e,t,n){return et(e,t,n-e.index)}function nt(e){return{index:e.index,line:e.line,column:e.column}}const rt=/\s/;function it(e){return rt.test(e)}const ot=/=/;function at(e){return ot.test(e)}function ct(e){const t=e.toLowerCase();return!!Xe.html.skipElements.has(t)}const ut=/[A-Za-z0-9]/;function st(e,t,n){if(!it(n.charAt(e)))return!1;const r=n.length;for(let r=e-1;r>t;r--){const e=n.charAt(r);if(!it(e)){if(at(e))return!1;break}}for(let t=e+1;t<r;t++){const e=n.charAt(t);if(!it(e))return!at(e)}}class lt{constructor(e){this.tokens=[],this.position={index:0,column:0,line:0},this.html=e}scan(){const{html:e,position:t}=this,n=e.length;for(;t.index<n;){const n=t.index;if(this.scanText(),t.index===n){if(e.startsWith("!--",n+1))this.scanComment();else{const e=this.scanTag();ct(e)&&this.scanSkipTag(e)}}}return this.tokens}scanText(){const{html:e,position:t}=this;let n=function(e,t){for(;;){const n=e.indexOf("<",t);if(-1===n)return n;const r=e.charAt(n+1);if("/"===r||"!"===r||ut.test(r))return n;t=n+1}}(e,t.index);if(n===t.index)return;-1===n&&(n=e.length);const r=nt(t),i=e.slice(t.index,n);tt(t,e,n);const o=nt(t);this.tokens.push({type:"text",content:i,position:{start:r,end:o}})}scanComment(){const{html:e,position:t}=this,n=nt(t);et(t,e,4);let r=e.indexOf("--\x3e",t.index),i=r+3;-1===r&&(r=i=e.length);const o=e.slice(t.index,r);tt(t,e,i),this.tokens.push({type:"comment",content:o,position:{start:n,end:nt(t)}})}scanTag(){this.scanTagStart();const e=this.scanTagName();return this.scanAttrs(),this.scanTagEnd(),e}scanTagStart(){const{html:e,position:t}=this,n="/"===e.charAt(t.index+1),r=nt(t);et(t,e,n?2:1),this.tokens.push({type:"tag-start",close:n,position:{start:r}})}scanTagEnd(){const{html:e,position:t}=this,n="/"===e.charAt(t.index);et(t,e,n?2:1);const r=nt(t);this.tokens.push({type:"tag-end",close:n,position:{end:r}})}scanTagName(){const{html:e,position:t}=this,n=e.length;let r=t.index;for(;r<n;){const t=e.charAt(r);if(!(it(t)||"/"===t||">"===t))break;r++}let i=r+1;for(;i<n;){const t=e.charAt(i);if(!!(it(t)||"/"===t||">"===t))break;i++}tt(t,e,i);const o=e.slice(r,i);return this.tokens.push({type:"tag",content:o}),o}scanAttrs(){const{html:e,position:t,tokens:n}=this;let r=t.index,i=null,o=r;const a=[],c=e.length;for(;r<c;){const t=e.charAt(r);if(i){t===i&&(i=null),r++;continue}if("/"===t||">"===t){r!==o&&a.push(e.slice(o,r));break}if(st(r,o,e)){r!==o&&a.push(e.slice(o,r)),o=r+1,r++;continue}"'"===t||'"'===t?(i=t,r++):r++}tt(t,e,r);const u=a.length,s="attribute";for(let e=0;e<u;e++){const t=a[e];if(t.includes("=")){const r=a[e+1];if(r&&r.startsWith("=")){if(r.length>1){const i=t+r;n.push({type:s,content:i}),e+=1;continue}const i=a[e+2];if(e+=1,i){const r=t+"="+i;n.push({type:s,content:r}),e+=1;continue}}}if(t.endsWith("=")){const r=a[e+1];if(r&&!r.includes("=")){const i=t+r;n.push({type:s,content:i}),e+=1;continue}const i=t.slice(0,-1);n.push({type:s,content:i})}else n.push({type:s,content:t})}}scanSkipTag(e){const{html:t,position:n}=this,r=e.toLowerCase(),i=t.length;for(;n.index<i;){const e=t.indexOf("</",n.index);if(-1===e){this.scanText();break}tt(n,t,e);if(r===this.scanTag().toLowerCase())break}}}function ft(e){const t=e.charAt(0),n=e.length-1;return('"'===t||"'"===t)&&t===e.charAt(n)?e.slice(1,n):e}class dt{constructor(){this.styles=[]}extractStyle(e){let t=e;return t=t.replace(/<style\s?[^>]*>((.|\n|\s)+?)<\/style>/g,((e,t)=>{const n=t.trim();return this.stringToSelector(n),""})),t.trim()}stringToSelector(e){let t=e.indexOf("{");for(;t>-1;){const n=e.indexOf("}"),r=e.slice(0,t).trim();let i=e.slice(t+1,n);i=i.replace(/:(.*);/g,(function(e,t){return`:${t.trim().replace(/ +/g,"+++")};`})),i=i.replace(/ /g,""),i=i.replace(/\+\+\+/g," "),/;$/.test(i)||(i+=";"),r.split(",").forEach((e=>{const t=this.parseSelector(e);this.styles.push({content:i,selectorList:t})})),t=(e=e.slice(n+1)).indexOf("{")}}parseSelector(e){return e.trim().replace(/ *([>~+]) */g," $1").replace(/ +/g," ").replace(/\[\s*([^[\]=\s]+)\s*=\s*([^[\]=\s]+)\s*\]/g,"[$1=$2]").split(" ").map((e=>{const t=e.charAt(0),n={isChild:">"===t,isGeneralSibling:"~"===t,isAdjacentSibling:"+"===t,tag:null,id:null,class:[],attrs:[]};return""!==(e=(e=(e=e.replace(/^[>~+]/,"")).replace(/\[(.+?)\]/g,(function(e,t){const[r,i]=t.split("="),o=-1===t.indexOf("="),a={all:o,key:r,value:o?null:i};return n.attrs.push(a),""}))).replace(/([.#][A-Za-z0-9-_]+)/g,(function(e,t){return"#"===t[0]?n.id=t.substr(1):"."===t[0]&&n.class.push(t.substr(1)),""})))&&(n.tag=e),n}))}matchStyle(e,t,n){const r=(i=this.styles,i.sort(((e,t)=>{const n=ht(e.selectorList),r=ht(t.selectorList);if(n!==r)return n-r;const i=vt(e.selectorList),o=vt(t.selectorList);return i!==o?i-o:yt(e.selectorList)-yt(t.selectorList)}))).reduce(((r,{content:i,selectorList:o},a)=>{let c=n[a],u=o[c];const s=o[c+1];((null==s?void 0:s.isGeneralSibling)||(null==s?void 0:s.isAdjacentSibling))&&(u=s,c+=1,n[a]+=1);let l=this.matchCurrent(e,t,u);if(l&&u.isGeneralSibling){let e=pt(t);for(;e;){if(e.h5tagName&&this.matchCurrent(e.h5tagName,e,o[c-1])){l=!0;break}e=pt(e),l=!1}}if(l&&u.isAdjacentSibling){const e=pt(t);if(e&&e.h5tagName){this.matchCurrent(e.h5tagName,e,o[c-1])||(l=!1)}else l=!1}if(l){if(c===o.length-1)return r+i;c<o.length-1&&(n[a]+=1)}else u.isChild&&c>0&&(n[a]-=1,this.matchCurrent(e,t,o[n[a]])&&(n[a]+=1));return r}),"");var i;return r}matchCurrent(e,t,n){if(n.tag&&n.tag!==e)return!1;if(n.id&&n.id!==t.id)return!1;if(n.class.length){const e=t.className.split(" ");for(let t=0;t<n.class.length;t++){const r=n.class[t];if(-1===e.indexOf(r))return!1}}if(n.attrs.length)for(let e=0;e<n.attrs.length;e++){const{all:r,key:i,value:o}=n.attrs[e];if(r&&!t.hasAttribute(i))return!1;if(t.getAttribute(i)!==ft(o||""))return!1}return!0}}function pt(e){if(!e.parentElement)return null;const t=e.previousSibling;return t?1===t.nodeType?t:pt(t):null}function ht(e){return e.reduce(((e,t)=>e+(t.id?1:0)),0)}function vt(e){return e.reduce(((e,t)=>e+t.class.length+t.attrs.length),0)}function yt(e){return e.reduce(((e,t)=>e+(t.tag?1:0)),0)}function gt(e,t){const n=Object.create(null),r=e.split(",");for(let e=0;e<r.length;e++)n[r[e]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}const mt={img:"image",iframe:"web-view"},bt=Object.keys(p).map((e=>e.toLowerCase())).join(","),wt=gt(bt,!0),St=gt("a,i,abbr,iframe,select,acronym,slot,small,span,bdi,kbd,strong,big,map,sub,sup,br,mark,mark,meter,template,canvas,textarea,cite,object,time,code,output,u,data,picture,tt,datalist,var,dfn,del,q,em,s,embed,samp,b",!0),It=gt("address,fieldset,li,article,figcaption,main,aside,figure,nav,blockquote,footer,ol,details,form,p,dialog,h1,h2,h3,h4,h5,h6,pre,dd,header,section,div,hgroup,table,dl,hr,ul,dt",!0),Ct={li:["ul","ol","menu"],dt:["dl"],dd:["dl"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table"],td:["table"]};function _t(e,t){const n=Ct[e];if(n){let r=t.length-1;for(;r>=0;){const i=t[r].tagName;if(i===e)break;if(n&&n.includes(i))return!0;r--}}return!1}function Dt(e){const t=e.indexOf("=");if(-1===t)return[e];return[e.slice(0,t).trim(),e.slice(t+"=".length).trim()]}function Tt(e,t,n,r){return e.filter((e=>"comment"!==e.type&&("text"!==e.type||""!==e.content))).map((e=>{if("text"===e.type){let n=t.createTextNode(e.content);return w(Xe.html.transformText)&&(n=Xe.html.transformText(n,e)),null==r||r.appendChild(n),n}const i=t.createElement((o=e.tagName,Xe.html.renderHTMLTag?o:mt[o]?mt[o]:wt(o)?o:It(o)?"view":St(o)?"text":"view"));var o;i.h5tagName=e.tagName,null==r||r.appendChild(i),Xe.html.renderHTMLTag||(i.className=`h5-${e.tagName}`);for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t],[r,o]=Dt(n);if("class"===r)i.className+=" "+ft(o);else{if("o"===r[0]&&"n"===r[1])continue;i.setAttribute(r,null==o||ft(o))}}const{styleTagParser:a,descendantList:c}=n,u=c.slice(),s=a.matchStyle(e.tagName,i,u);return i.setAttribute("style",s+i.style.cssText),Tt(e.children,t,{styleTagParser:a,descendantList:u},i),w(Xe.html.transformElement)?Xe.html.transformElement(i,e):i}))}function Et(e,t){const n=new dt;e=n.extractStyle(e);const r={tagName:"",children:[],type:"element",attributes:[]};return At({tokens:new lt(e).scan(),options:Xe,cursor:0,stack:[r]}),Tt(r.children,t,{styleTagParser:n,descendantList:Array(n.styles.length).fill(0)})}function At(e){const{tokens:t,stack:n}=e;let{cursor:r}=e;const i=t.length;let o=n[n.length-1].children;for(;r<i;){const e=t[r];if("tag-start"!==e.type){o.push(e),r++;continue}const a=t[++r];r++;const c=a.content.toLowerCase();if(e.close){let e=n.length,o=!1;for(;--e>-1;)if(n[e].tagName===c){o=!0;break}for(;r<i;){if("tag-end"!==t[r].type)break;r++}if(o){n.splice(e);break}continue}let u=Xe.html.closingElements.has(c);if(u&&(u=!_t(c,n)),u){let e=n.length-1;for(;e>0;){if(c===n[e].tagName){n.splice(e);o=n[e-1].children;break}e-=1}}const s=[];let l;for(;r<i&&(l=t[r],"tag-end"!==l.type);)s.push(l.content),r++;r++;const f=[],d={type:"element",tagName:a.content,attributes:s,children:f};o.push(d);if(!(l.close||Xe.html.voidElements.has(c))){n.push({tagName:c,children:f});const e={tokens:t,cursor:r,stack:n};At(e),r=e.cursor}}e.cursor=r}function xt(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);const n=Et(t,e.ownerDocument);for(let t=0;t<n.length;t++)e.appendChild(n[t])}Xe.html={skipElements:new Set(["style","script"]),voidElements:new Set(["!doctype","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),closingElements:new Set(["html","head","body","p","dt","dd","li","option","thead","th","tbody","tr","td","tfoot","colgroup"]),renderHTMLTag:!1},ENABLE_INNER_HTML&&(Te.extend("innerHTML",{set(e){xt.call(this,this,e)},get:()=>""}),ENABLE_ADJACENT_HTML&&Te.extend("insertAdjacentHTML",(function(e,t){var n,r;const i=Et(t,this.ownerDocument);for(let t=0;t<i.length;t++){const o=i[t];switch(e){case"beforebegin":null===(n=this.parentNode)||void 0===n||n.insertBefore(o,this);break;case"afterbegin":this.hasChildNodes()?this.insertBefore(o,this.childNodes[0]):this.appendChild(o);break;case"beforeend":this.appendChild(o);break;case"afterend":null===(r=this.parentNode)||void 0===r||r.appendChild(o)}}}))),ENABLE_CLONE_NODE&&Te.extend("cloneNode",(function(e=!1){const t=this.ownerDocument;let n;1===this.nodeType?n=t.createElement(this.nodeName):3===this.nodeType&&(n=t.createTextNode(""));for(const e in this){const t=this[e];[q,V].includes(e)&&"object"==typeof t?n[e]=Object.assign({},t):"_value"===e?n[e]=t:e===j&&(n.style._value=Object.assign({},t._value),n.style._usedStyleProp=new Set(Array.from(t._usedStyleProp)))}return e&&(n.childNodes=this.childNodes.map((e=>e.cloneNode(!0)))),n})),ENABLE_CONTAINS&&Te.extend("contains",(function(e){let t=!1;return this.childNodes.some((n=>{const{uid:r}=n;if(r===e.uid||r===e.id||n.contains(e))return t=!0,!0})),t})),ENABLE_SIZE_APIS&&Ye.extend("getBoundingClientRect",(function(){return Xe.miniGlobal?new Promise((e=>{Xe.miniGlobal.createSelectorQuery().select(`#${this.uid}`).boundingClientRect((t=>{e(t)})).exec()})):Promise.resolve(null)})),ENABLE_TEMPLATE_CONTENT&&Ye.extend("content",{get(){return function(e){if("template"===e.nodeName){const t=e.ownerDocument.createElement(P);return t.childNodes=e.childNodes,e.childNodes=[t],t.parentNode=e,t.childNodes.forEach((e=>{e.parentNode=t})),t}}(this)}});class Ot{constructor(e,t,n){this._stop=!1,this._end=!1,this.defaultPrevented=!1,this.timeStamp=Date.now(),this.type=e.toLowerCase(),this.mpEvent=n,this.bubbles=Boolean(t&&t.bubbles),this.cancelable=Boolean(t&&t.cancelable)}stopPropagation(){this._stop=!0}stopImmediatePropagation(){this._end=this._stop=!0}preventDefault(){this.defaultPrevented=!0}get target(){var e,t;const n=this.cacheTarget;if(n)return n;{const n=Object.create((null===(e=this.mpEvent)||void 0===e?void 0:e.target)||null),r=Se.document.getElementById(n.id);n.dataset=null!==r?r.dataset:T;for(const e in null===(t=this.mpEvent)||void 0===t?void 0:t.detail)n[e]=this.mpEvent.detail[e];return this.cacheTarget=n,n}}get currentTarget(){var e,t,n,r;const i=this.cacheCurrentTarget;if(i)return i;{const i=Se.document,o=Object.create((null===(e=this.mpEvent)||void 0===e?void 0:e.currentTarget)||null),a=i.getElementById(o.id),c=i.getElementById((null===(n=null===(t=this.mpEvent)||void 0===t?void 0:t.target)||void 0===n?void 0:n.id)||null);if(null===a||a&&a===c)return this.cacheCurrentTarget=this.target,this.target;o.dataset=a.dataset;for(const e in null===(r=this.mpEvent)||void 0===r?void 0:r.detail)o[e]=this.mpEvent.detail[e];return this.cacheCurrentTarget=o,o}}}function kt(e,t){if("string"==typeof e)return new Ot(e,{bubbles:!0,cancelable:!0});const n=new Ot(e.type,{bubbles:!0,cancelable:!0},e);for(const t in e)"currentTarget"!==t&&"target"!==t&&"type"!==t&&"timeStamp"!==t&&(n[t]=e[t]);return"confirm"===n.type&&(null==t?void 0:t.nodeName)===z&&(n.keyCode=13),n}const Bt={};function Lt(e){var t;D.call("modifyMpEventImpl",e),e.currentTarget||(e.currentTarget=e.target);const n=e.currentTarget,r=(null===(t=n.dataset)||void 0===t?void 0:t.sid)||n.id||"",i=Se.document.getElementById(r);if(i){const t=()=>{const t=kt(e,i);D.call("modifyTaroEvent",t,i),i.dispatchEvent(t)};if(D.isExist("batchedEventUpdates")){const n=e.type;!D.call("isBubbleEvents",n)||!function(e,t){var n;let r=!1;for(;(null==e?void 0:e.parentElement)&&e.parentElement._path!==L;){if(null===(n=e.parentElement.__handlers[t])||void 0===n?void 0:n.length){r=!0;break}e=e.parentElement}return r}(i,n)||"touchmove"===n&&i.props.catchMove?D.call("batchedEventUpdates",(()=>{Bt[n]&&(Bt[n].forEach((e=>e())),delete Bt[n]),t()})):(Bt[n]||(Bt[n]=[])).push(t)}else t()}}class Pt extends Ye{get value(){const e=this.props.value;return null==e?"":e}set value(e){this.setAttribute(G,e)}dispatchEvent(e){if(e.mpEvent){const t=e.mpEvent.detail.value;"change"===e.type?this.props.value=t:e.type===z&&(this.value=t)}return super.dispatchEvent(e)}}const Nt=new class{constructor(){this.recorder=new Map}start(e){Xe.debug&&this.recorder.set(e,Date.now())}stop(e){if(!Xe.debug)return;const t=Date.now()-this.recorder.get(e);console.log(`${e} 时长： ${t}ms`)}};function Mt(e,t){const n=t.slice(1);let r,i=e,o="";if(n.some(((e,n)=>{const a=e.replace(/^\[(.+)\]$/,"$1").replace(/\bcn\b/g,"childNodes");if(i=i[a],g(i))return!0;if(i.nodeName===H){const e=he.get(i.sid);e&&(r=e,o=t.slice(n+2).join("."))}})),r)return{customWrapper:r,splitedPath:o}}class jt extends Ye{constructor(){super(),this.updatePayloads=[],this.updateCallbacks=[],this.pendingUpdate=!1,this.ctx=null,this.nodeName=L,this.tagName=L.toUpperCase()}get _path(){return L}get _root(){return this}enqueueUpdate(e){this.updatePayloads.push(e),!this.pendingUpdate&&this.ctx&&this.performUpdate()}performUpdate(e=!1,t){this.pendingUpdate=!0;const n=this.ctx;setTimeout((()=>{Nt.start(k);const r=Object.create(null),i=new Set(e?["root.cn.[0]","root.cn[0]"]:[]);for(;this.updatePayloads.length>0;){const{path:e,value:t}=this.updatePayloads.shift();e.endsWith("cn")&&i.add(e),r[e]=t}for(const e in r){i.forEach((t=>{e.includes(t)&&e!==t&&delete r[e]}));const t=r[e];w(t)&&(r[e]=t())}if(w(t))return t(r);this.pendingUpdate=!1;let o={};const a=new Map;if(e)o=r;else for(const e in r){const t=Mt(this,e.split("."));if(t){const{customWrapper:n,splitedPath:i}=t;a.set(n,Object.assign(Object.assign({},a.get(n)||{}),{[`i.${i}`]:r[e]}))}else o[e]=r[e]}const c=a.size,u=Object.keys(o).length>0,s=c+(u?1:0);let l=0;const f=()=>{++l===s&&(Nt.stop(k),this.flushUpdateCallback(),e&&Nt.stop(B))};c&&a.forEach(((e,t)=>{t.setData(e,f)})),u&&n.setData(o,f)}),0)}enqueueUpdateCallback(e,t){this.updateCallbacks.push((()=>{t?e.call(t):e()}))}flushUpdateCallback(){const e=this.updateCallbacks;if(!e.length)return;const t=e.slice(0);this.updateCallbacks.length=0;for(let e=0;e<t.length;e++)t[e]()}}class Rt extends Te{constructor(e){super(),this.nodeType=3,this.nodeName="#text",this._value=e}set textContent(e){ue.record({target:this,type:"characterData",oldValue:this._value}),this._value=e,this.enqueueUpdate({path:`${this._path}.v`,value:e})}get textContent(){return this._value}set nodeValue(e){this.textContent=e}get nodeValue(){return this._value}set data(e){this.textContent=e}get data(){return this._value}}class Ut extends Ye{constructor(){super(),this.createEvent=kt,this.nodeType=9,this.nodeName="#document"}createElement(e){if(e===L)return new jt;const t=h.has(e)?new Pt:new Ye;return t.nodeName=e,t.tagName=e.toUpperCase(),t}createElementNS(e,t){return this.createElement(t)}createTextNode(e){return new Rt(e)}getElementById(e){const t=we.get(e);return g(t)?null:t}querySelector(e){return/^#/.test(e)?this.getElementById(e.slice(1)):null}querySelectorAll(){return[]}createComment(){const e=new Rt("");return e.nodeName=Z,e}get defaultView(){return Se.window}}let Ft;{function yn(){const e=new Ut,t=e.createElement.bind(e),n=t("html"),r=t("head"),i=t("body"),o=t("app");o.id="app";const a=t("container");return e.appendChild(n),n.appendChild(r),n.appendChild(i),i.appendChild(a),a.appendChild(o),e.documentElement=n,e.head=r,e.body=i,e}Ft=Se.document=yn()}function $t(e){return e.style}const qt="(Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/534.36 (KHTML, like Gecko) NodeJS/v4.1.0 Chrome/76.0.3809.132 Safari/534.36",Vt={appCodeName:"Mozilla",appName:"Netscape",appVersion:"5.0 "+qt,cookieEnabled:!0,mimeTypes:[],onLine:!0,platform:"MacIntel",plugins:[],product:"Taro",productSub:"20030107",userAgent:"Mozilla/5.0 "+qt,vendor:"Joyent",vendorSub:""};let Gt;!function(){let e;"undefined"!=typeof performance&&null!==performance&&performance.now?Gt=()=>performance.now():Date.now?(e=Date.now(),Gt=()=>Date.now()-e):(e=(new Date).getTime(),Gt=()=>(new Date).getTime()-e)}();let zt=0;const Ht="undefined"!=typeof requestAnimationFrame&&null!==requestAnimationFrame?requestAnimationFrame:function(e){const t=Gt(),n=Math.max(zt+16,t);return setTimeout((function(){e(zt=n)}),n-t)},Wt="undefined"!=typeof cancelAnimationFrame&&null!==cancelAnimationFrame?cancelAnimationFrame:function(e){clearTimeout(e)},Jt=D.call("getEventCenter",v);let Zt;{class gn extends v{constructor(){super(),this.navigator=Vt,this.requestAnimationFrame=Ht,this.cancelAnimationFrame=Wt,this.getComputedStyle=$t;[...Object.getOwnPropertyNames(n.g||{}),...Object.getOwnPropertySymbols(n.g||{})].forEach((e=>{"atob"!==e&&"document"!==e&&(Object.prototype.hasOwnProperty.call(this,e)||(this[e]=n.g[e]))})),this.Date||(this.Date=Date)}get document(){return Se.document}addEventListener(e,t){y(e)&&this.on(e,t,null)}removeEventListener(e,t){y(e)&&this.off(e,t,null)}setTimeout(...e){return setTimeout(...e)}clearTimeout(...e){return clearTimeout(...e)}}Zt=Se.window=new gn}class Kt extends Ye{}const Qt={app:null,router:null,page:null},Yt=()=>Qt,Xt=new Map,en=se();function tn(e,t){D.call("mergePageInstance",Xt.get(t),e),Xt.set(t,e)}function nn(e){return Xt.get(e)}function rn(e){Xt.delete(e)}function on(e){return null==e?"":"/"===e.charAt(0)?e:"/"+e}function an(e,t,...n){const r=Xt.get(e);if(null==r)return;const i=D.call("getLifecycle",r,t);if(S(i)){return i.map((e=>e.apply(r,n)))[0]}return w(i)?i.apply(r,n):void 0}function cn(e){if(null==e)return"";const t=Object.keys(e).map((t=>t+"="+e[t])).join("&");return""===t?t:"?"+t}function un(e,t){const n=e.indexOf("?");return`${n>-1?e.substring(0,n):e}${cn(t)}`}function sn(e){return e+"."+Q}function ln(e){return e+"."+Y}function fn(e){return e+"."+X}function dn(e,t,n,r){const i=null!=t?t:`taro_page_${en()}`,[o,a,c,u,s,l,f]=D.call("getMiniLifecycleImpl").page;let d,p,h=null,v=!1,y=[];function m(e){const t=e.route||e.__route__||e.$taroPath;Qt.router={params:e.$taroParams,path:on(t),$taroPath:e.$taroPath,onReady:sn(i),onShow:ln(i),onHide:fn(i)},g(e.exitState)||(Qt.router.exitState=e.exitState)}const b={[o](t={},n){p=new Promise((e=>{d=e})),Nt.start(B),Qt.page=this,this.config=r||{};const o=Object.assign({},t,{$taroTimestamp:Date.now()}),a=this.$taroPath=un(i,o);null==this.$taroParams&&(this.$taroParams=o),m(this);const c=()=>{Qt.app.mount(e,a,(()=>{h=Se.document.getElementById(a),O(null!==h,"没有找到页面实例。"),an(a,K,this.$taroParams),d(),h.ctx=this,h.performUpdate(!0,n)}))};v?y.push(c):c()},[a](){const e=this.$taroPath;an(e,a),v=!0,Qt.app.unmount(e,(()=>{v=!1,Xt.delete(e),h&&(h.ctx=null,h=null),y.length&&(y.forEach((e=>e())),y=[])}))},[c](){an(this.$taroPath,Q),Ht((()=>Jt.trigger(sn(i)))),this.onReady.called=!0},[u](e={}){p.then((()=>{Qt.page=this,m(this),an(this.$taroPath,Y,e),Ht((()=>Jt.trigger(ln(i))))}))},[s](){Qt.page===this&&(Qt.page=null,Qt.router=null),an(this.$taroPath,X),Jt.trigger(fn(i))}};return l.forEach((e=>{b[e]=function(){return an(this.$taroPath,e,...arguments)}})),f.forEach((t=>{var n;(e[t]||(null===(n=e.prototype)||void 0===n?void 0:n[t])||e[t.replace(/^on/,"enable")])&&(b[t]=function(...e){var n;const r=null===(n=e[0])||void 0===n?void 0:n.target;if(null==r?void 0:r.id){const e=r.id,t=Se.document.getElementById(e);t&&(r.dataset=t.dataset)}return an(this.$taroPath,t,...e)})})),b.eh=Lt,g(n)||(b.data=n),D.call("modifyPageObject",b),b}function pn(e,t,n){const r=null!=t?t:`taro_component_${en()}`;let i=null;const[o,a]=D.call("getMiniLifecycleImpl").component,c={[o](){var t;Nt.start(B);const n=un(r,{id:(null===(t=this.getPageId)||void 0===t?void 0:t.call(this))||en()});Qt.app.mount(e,n,(()=>{i=Se.document.getElementById(n),O(null!==i,"没有找到组件实例。"),this.$taroInstances=Xt.get(n),an(n,K),i.ctx=this,i.performUpdate(!0)}))},[a](){const e=un(r,{id:this.getPageId()});Qt.app.unmount(e,(()=>{Xt.delete(e),i&&(i.ctx=null)}))},methods:{eh:Lt}};return g(n)||(c.data=n),[ee,te,ne].forEach((t=>{var n;c[t]=null!==(n=e[t])&&void 0!==n?n:T})),c}function hn(e){const t=e===H,[n,r]=D.call("getMiniLifecycleImpl").component,i=t?{[n](){var e,t;const n=(null===(e=this.data.i)||void 0===e?void 0:e.sid)||(null===(t=this.props.i)||void 0===t?void 0:t.sid);y(n)&&he.set(n,this)},[r](){var e,t;const n=(null===(e=this.data.i)||void 0===e?void 0:e.sid)||(null===(t=this.props.i)||void 0===t?void 0:t.sid);y(n)&&he.delete(n)}}:T;return Object.assign({properties:{i:{type:Object,value:{nn:U}},l:{type:String,value:""}},options:{addGlobalClass:!0,virtualHost:!t},methods:{eh:Lt}},i)}const vn=(e,t)=>{const n=Qt.router,r=()=>{setTimeout((function(){t?e.call(t):e()}),1)};if(null!==n){let i=null;const o=n.$taroPath;i=Se.document.getElementById(o),(null==i?void 0:i.pendingUpdate)?i.enqueueUpdateCallback(e,t):r()}else r()}},398:function(e,t,n){const{hooks:r}=n(67),i=n(689).Z;r.isExist("initNativeApi")&&r.call("initNativeApi",i),e.exports=i,e.exports.default=e.exports},85:function(e){"use strict";var t="%[a-f0-9]{2}",n=new RegExp(t,"gi"),r=new RegExp("("+t+")+","gi");function i(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],i(n),i(r))}function o(e){try{return decodeURIComponent(e)}catch(o){for(var t=e.match(n),r=1;r<t.length;r++)t=(e=i(t,r).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var i=o(n[0]);i!==n[0]&&(t[n[0]]=i)}n=r.exec(e)}t["%C2"]="�";for(var a=Object.keys(t),c=0;c<a.length;c++){var u=a[c];e=e.replace(new RegExp(u,"g"),t[u])}return e}(e)}}},560:function(e){"use strict";e.exports=function(e,t){for(var n={},r=Object.keys(e),i=Array.isArray(t),o=0;o<r.length;o++){var a=r[o],c=e[a];(i?-1!==t.indexOf(a):t(a,c,e))&&(n[a]=c)}return n}},973:function(e,t,n){var r=n(783),i=n(12),o=n(900),a=n(691),c=n(18);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=c,e.exports=u},768:function(e,t,n){var r=n(896),i=n(473),o=n(678),a=n(240),c=n(296);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=c,e.exports=u},725:function(e,t,n){var r=n(369)(n(31),"Map");e.exports=r},736:function(e,t,n){var r=n(660),i=n(472),o=n(637),a=n(389),c=n(804);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=c,e.exports=u},869:function(e,t,n){var r=n(31).Symbol;e.exports=r},746:function(e,t,n){var r=n(947);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},365:function(e,t,n){var r=n(869),i=n(43),o=n(283),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},930:function(e,t,n){var r=n(98),i=n(754),o=n(917),a=n(304),c=/^\[object .+?Constructor\]$/,u=Function.prototype,s=Object.prototype,l=u.toString,f=s.hasOwnProperty,d=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?d:c).test(a(e))}},823:function(e,t,n){var r=n(31)["__core-js_shared__"];e.exports=r},274:function(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},623:function(e,t,n){var r=n(5);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},369:function(e,t,n){var r=n(930),i=n(502);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},43:function(e,t,n){var r=n(869),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,c=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(e){}var i=a.call(e);return r&&(t?e[c]=n:delete e[c]),i}},502:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},783:function(e,t,n){var r=n(163);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},12:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},900:function(e,t,n){var r=n(163),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},691:function(e,t,n){var r=n(163),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},18:function(e,t,n){var r=n(163);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},5:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},754:function(e,t,n){var r,i=n(823),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},896:function(e){e.exports=function(){this.__data__=[],this.size=0}},473:function(e,t,n){var r=n(746),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},678:function(e,t,n){var r=n(746);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},240:function(e,t,n){var r=n(746);e.exports=function(e){return r(this.__data__,e)>-1}},296:function(e,t,n){var r=n(746);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},660:function(e,t,n){var r=n(973),i=n(768),o=n(725);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},472:function(e,t,n){var r=n(623);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},637:function(e,t,n){var r=n(623);e.exports=function(e){return r(this,e).get(e)}},389:function(e,t,n){var r=n(623);e.exports=function(e){return r(this,e).has(e)}},804:function(e,t,n){var r=n(623);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},163:function(e,t,n){var r=n(369)(Object,"create");e.exports=r},283:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},31:function(e,t,n){var r=n(274),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},304:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},947:function(e){e.exports=function(e,t){return e===t||e!=e&&t!=t}},98:function(e,t,n){var r=n(365),i=n(917);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},917:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},983:function(e,t,n){var r=n(736);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},125:function(e,t,n){var r,i;!function(o,a){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}function c(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function u(e,n,r){return function(){typeof console!==t&&(c.call(this,n,r),this[e].apply(this,arguments))}}function s(e,t,n){return a(e)||u.apply(this,arguments)}function l(e,n,i){var o,a=this;n=null==n?"WARN":n;var u="loglevel";function l(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(e){}}}function f(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}function d(){if(typeof window!==t&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||s,a.getLevel=function(){return o},a.setLevel=function(n,r){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==r&&l(n),c.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){n=e,f()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(n,!1),d()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var p=f();null==p&&(p=n),a.setLevel(p,!1)}var f=new l,d={};f.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new l(e,f.getLevel(),f.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return f.noConflict=function(){return typeof window!==t&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return d},f.default=f,f},void 0===(i="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=i)}()},803:function(e,t,n){"use strict";const r=n(570),i=n(85),o=n(602),a=n(560),c=Symbol("encodeFragmentIdentifier");function u(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function s(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function l(e,t){return t.decode?i(e):e}function f(e){return Array.isArray(e)?e.sort():"object"==typeof e?f(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function d(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function p(e){const t=(e=d(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function h(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function v(e,t){u((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"colon-list-separator":return(e,n,r)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const i="string"==typeof n&&n.includes(e.arrayFormatSeparator),o="string"==typeof n&&!i&&l(n,e).includes(e.arrayFormatSeparator);n=o?l(n,e):n;const a=i||o?n.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===n?n:l(n,e);r[t]=a};case"bracket-separator":return(t,n,r)=>{const i=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!i)return void(r[t]=n?l(n,e):n);const o=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>l(t,e)));void 0!==r[t]?r[t]=[].concat(r[t],o):r[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const i of e.split("&")){if(""===i)continue;let[e,a]=o(t.decode?i.replace(/\+/g," "):i,"=");a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:l(a,t),n(l(e,t),a,r)}for(const e of Object.keys(r)){const n=r[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=h(n[e],t);else r[e]=h(n,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=f(n):e[t]=n,e}),Object.create(null))}t.extract=p,t.parse=v,t.stringify=(e,t)=>{if(!e)return"";u((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[s(t,e),"[",i,"]"].join("")]:[...n,[s(t,e),"[",s(i,e),"]=",s(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[s(t,e),"[]"].join("")]:[...n,[s(t,e),"[]=",s(r,e)].join("")];case"colon-list-separator":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[s(t,e),":list="].join("")]:[...n,[s(t,e),":list=",s(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:(i=null===i?"":i,0===r.length?[[s(n,e),t,s(i,e)].join("")]:[[r,s(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,s(t,e)]:[...n,[s(t,e),"=",s(r,e)].join("")]}}(t),i={};for(const t of Object.keys(e))n(t)||(i[t]=e[t]);const o=Object.keys(i);return!1!==t.sort&&o.sort(t.sort),o.map((n=>{const i=e[n];return void 0===i?"":null===i?s(n,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?s(n,t)+"[]":i.reduce(r(n),[]).join("&"):s(n,t)+"="+s(i,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,r]=o(e,"#");return Object.assign({url:n.split("?")[0]||"",query:v(p(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:l(r,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0,[c]:!0},n);const r=d(e.url).split("?")[0]||"",i=t.extract(e.url),o=t.parse(i,{sort:!1}),a=Object.assign(o,e.query);let u=t.stringify(a,n);u&&(u=`?${u}`);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l=`#${n[c]?s(e.fragmentIdentifier,n):e.fragmentIdentifier}`),`${r}${u}${l}`},t.pick=(e,n,r)=>{r=Object.assign({parseFragmentIdentifier:!0,[c]:!1},r);const{url:i,query:o,fragmentIdentifier:u}=t.parseUrl(e,r);return t.stringifyUrl({url:i,query:a(o,n),fragmentIdentifier:u},r)},t.exclude=(e,n,r)=>{const i=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,i,r)}},570:function(e){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},602:function(e){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},737:function(e,t){!function(){var e={6063:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=u(n(9616)),l=u(n(5707)),f=o(n(4349)),d=u(n(3654)),p=n(9047),h=u(n(1423)),v=n(5755),y=n(3126),g=n(8265),m=function(){function e(){this.clientMap=new Map,this.workerMap=new Map}return e.prototype.init=function(e){var t=this;if(this.options=e,e.printValueChange&&(0,f.setPrintValueChange)(e.printValueChange),e.printWrite&&(0,f.setPrintWrite)(e.printWrite),e.logger&&(0,f.setLogger)(e.logger),(0,p.setBluetooth)(e.bluetooth),(0,y.initOnBluetoothAdapterStateChange)(),(0,g.initOnBLEConnectionStateChange)(),(0,g.initOnBLECharacteristicValueChange)(),s.default[e.platform]){var n=s.default[e.platform],r=n.Adapter,i=n.Client;return this.adapter=new r,this.adapter.addStateChangeListener((function(e){return e.available||(t.clientMap.clear(),t.workerMap.clear()),!1})),this.newClient=function(e){return new i(e)},!1!==e.openBLEAdapter?this.adapter.available?Promise.resolve(l.default.success()):this.adapter.openBLEAdapter():Promise.resolve(l.default.success())}f.default.error("not support platform: ",s.default.wx,e.platform)},e.prototype.connectDevice=function(e,t){var n=this;void 0===t&&(t=1e4);var r=this.options.discoverDelay,i=function(i){return i.connect(t).then((function(t){return i.discoverServices(void 0===r?300:r).catch((function(t){return i.discoverServices(1e3).catch((function(t){return n.disconnectDevice(e),Promise.reject(t)}))}))}))};if(this.clientMap.has(e)){var o=this.clientMap.get(e);return o&&!o.connected?i(o):Promise.resolve(l.default.success())}var a=this.newClient(e);return this.clientMap.set(e,a),null==a||a.addConnectionChangeListener((function(e){return!e.connected&&(setTimeout((function(){var t=n.workerMap.get(e.deviceId);t&&(t.recycle(),n.workerMap.delete(e.deviceId)),a.recycle(),n.clientMap.delete(e.deviceId)}),0),!0)})),i(a)},e.prototype.disconnectDevice=function(e){var t=this.clientMap.get(e);this.clientMap.delete(e);var n=this.workerMap.get(e);if(null==n||n.recycle(),this.workerMap.delete(e),t)return t.disconnect()},e.prototype.bindDevice=function(e,t){var n=this.clientMap.get(e);if(!n)return Promise.reject(l.default.fail("no client for:"+e));if(!n.connected)return Promise.reject(l.default.fail("client disconnect for:"+e));f.default.debug("scanResult",t.scanResult),t.scanResult&&(0,p.getBluetooth)().setStorage({key:t.scanResult.mac,data:e});var r=h.default.getProtocolByServices(n.services);if(!r)return f.default.error("not suport services",n.services),Promise.reject(l.default.fail("no support protocol:"+e));f.default.debug("current bind UUID",r.uuid);var i=new d.default(n,r.bind,r.uuid);return this.workerMap.set(e,i),i.process(t)},e.prototype.startDataSync=function(e,t){var n=this.clientMap.get(e);if(!n)return Promise.reject(l.default.fail("no client for:"+e));if(!n.connected)return Promise.reject(l.default.fail("client disconnect for:"+e));var r=h.default.getProtocolByServices(n.services);if(!r)return f.default.error("not suport services",n.services),Promise.reject(l.default.fail("no support protocol:"+e));f.default.debug("current sync UUID",r.uuid);var i=this.workerMap.get(e);i&&(i.recycle(),this.workerMap.delete(e));var o=new d.default(n,r.sync,r.uuid);return this.workerMap.set(e,o),o.process(t)},e.prototype.readDeviceInfo=function(e,t){return a(this,void 0,void 0,(function(){var n;return c(this,(function(r){return(n=this.clientMap.get(e))?n.connected?[2,h.default.getProtocolByServices(n.services).readDeviceInfo.readDeviceInfo(n,t)]:[2,Promise.reject(l.default.fail("client disconnect for:"+e))]:[2,Promise.reject(l.default.fail("no client for:"+e))]}))}))},e.prototype.startDeviceUpgrade=function(e,t){var n=this.clientMap.get(e);if(!n)return Promise.reject(l.default.fail("no client for:"+e));if(!n.connected)return Promise.reject(l.default.fail("client disconnect for:"+e));var r=h.default.getProtocolByServices(n.services);if(!r)return f.default.error("device upgrade not suport services",n.services),Promise.reject(l.default.fail("no support protocol:"+e));f.default.debug("current ota UUID",r.uuid);var i=this.workerMap.get(e);i&&(i.recycle(),this.workerMap.delete(e));var o=new d.default(n,r.ota,r.uuid);this.workerMap.set(e,o);var a={upgradeInfo:t};return o.process(a)},e.prototype.send=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i,o,a=this;return c(this,(function(c){return n=this.clientMap.get(e),r=this.workerMap.get(e),n?n.connected?(t.setEncoder&&t.setEncoder(r.encoder),null,i=t.await?new Promise((function(n,r){var i=!1,o=setTimeout((function(){i=!0,r(l.default.fail("request timeout: ",t))}),t.await.timeout||1e4);a.workerMap.get(e).decoder.addDataChangeListener(t.await.eventName,(function(e,a){if(i)return!0;clearTimeout(o);var c=t.await.onDataChange(e,a);return!!c.isConsumer&&(setTimeout((function(){c.isSucceed?n(l.default.success(t)):(f.default.error("send fail",t.getCmd(),(0,v.ab2hex)(e)),r(l.default.fail("error response: ",(0,v.ab2hex)(e))))}),0),!0)}))})):Promise.resolve(l.default.success()),o=t.getBytes(),n.writeList(t.serviceId,t.characteristicId,o),[2,i]):[2,Promise.reject(l.default.fail("client disconnect for:"+e))]:[2,Promise.reject(l.default.fail("no client for:"+e))]}))}))},e}();t.default=new m},9433:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GpsManager=t.GpsStatus=void 0;var i,o=r(n(3701)),a=r(n(6538)),c=n(8192),u=r(n(1795)),s=r(n(4349)),l=r(n(5883)),f=r(n(6063)),d=1e6,p=s.default;!function(e){e[e.Enabled=1]="Enabled",e[e.NoPermission=2]="NoPermission",e[e.Close=3]="Close"}(i=t.GpsStatus||(t.GpsStatus={}));var h=function(){function e(e){this.deviceGpsMap=new Map,this.options=e}return Object.defineProperty(e.prototype,"deviceIds",{get:function(){return Array.from(this.deviceGpsMap.keys())},enumerable:!1,configurable:!0}),e.prototype.receiveDeviceGpsSwitch=function(e){var t=this,n=e.deviceId,r=e.categoryId,i=e.commandId,o=e.seq,a=e.gpsSwitch,u=e.gpsStatus;p.info("收到gpsSwitch",a);var s=a.GpsEnable;if(1===s||4===s)return this._sendGpsSwitchRsp({deviceId:n,errorCode:this._getRspCode(u),categoryId:r,commandId:i,seq:o}),(f=this.deviceGpsMap.get(n))||(f=new v({deviceId:n,timeout:a.Timeout,interval:a.Interval,getGpsInfo:function(){return t.options.getGpsInfo({deviceId:n})}}),this.deviceGpsMap.set(n,f)),void this.options.onStartRequest({deviceId:n,gpsSwitch:a,deviceIds:this.deviceIds});if(2===s||3===s){if(this._sendGpsSwitchRsp({deviceId:n,errorCode:c.AliceErrorCode.RET_GE_SUCCESS,categoryId:r,commandId:i,seq:o}),2===s);else{var l=a.trackID;p.debug("trackID:",l)}var f;return(f=this.deviceGpsMap.get(n))&&(f.stop(),this.deviceGpsMap.delete(n)),p.info("收到设备结束:",s),void this.options.onStopRequest({deviceId:n,gpsSwitch:a,deviceIds:this.deviceIds})}},e.prototype._sendGpsSwitchRsp=function(e){var t=e.deviceId,n=e.errorCode,r=e.categoryId,i=e.commandId,o=e.seq,c={ErrorCode:n},s=u.default.encodePb(a.default,"ErrorCode_t",c),d=new l.default(r,i+128,s,o);return f.default.send(t,d)},e.prototype._getRspCode=function(e){return e===i.Enabled?c.AliceErrorCode.RET_GE_SUCCESS:e===i.NoPermission?1003002:1003001},e}();t.GpsManager=h;var v=function(){function e(e){this.deviceId=e.deviceId,this.interval=1e3*Math.max(e.interval||1,1),this.timeout=(new Date).getTime()+1e3*e.timeout*60,this.getGpsInfo=e.getGpsInfo,this.gpsInfoList=[],this.lastLocationInfo=null,this.currentDistance=0,this.start()}return e.prototype.start=function(){var e=this;this.intervalId=setInterval((function(){if(e.timeout>(new Date).getTime())e.stop();else{var t=e.getGpsInfo();e.didRecievedLocationInfo(t)}}),this.interval)},e.prototype.stop=function(){clearInterval(this.intervalId)},e.prototype.didRecievedLocationInfo=function(e){var t=e.locationInfo,n=e.gpsStatus;p.debug("didRecievedLocationInfo:",t,n);var r={StateCode:0};return n!==i.Enabled?(r.StateCode=0,void this.send(r)):this.checkLocationInfo(t)?(r.TimesTamp=Math.round(t.time/1e3),t.speed>.1?(r.Speed=t.speed,r.InvertSpeed=1e3/t.speed):r.Speed=0,t.accuracy>30?r.StateCode=2:r.StateCode=3,this.lastLocationInfo&&this.gpsInfoList.length>0?t.distance=function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0);var i=t*Math.PI/180,o=r*Math.PI/180,a=i-o,c=e*Math.PI/180-n*Math.PI/180;return parseInt((12756274*Math.asin(Math.sqrt(Math.pow(Math.sin(a/2),2)+Math.cos(i)*Math.cos(o)*Math.pow(Math.sin(c/2),2)))).toFixed(2),10)}(t.longitude,t.latitude,this.lastLocationInfo.longitude,this.lastLocationInfo.latitude):(p.info("第一个轨迹点:",t),t.distance=0),this.getIsUpdate(t)&&this.gpsInfoList.push(t),this.lastLocationInfo=t,r.Distance=t.distance,r.Longitude=t.longitude*d,r.Latitude=t.latitude*d,r.Altitude=t.altitude,r.Precision=100*t.accuracy,this.currentDistance=parseFloat(r.Distance)+this.currentDistance,void this.send(r)):(r.StateCode=1,void this.send(r))},e.prototype.checkLocationInfo=function(e){return!!e&&(p.debug("gsp经纬度为0"),0!==(e.latitude||0))},e.prototype.getIsUpdate=function(e){return this.lastLocationInfo&&this.lastLocationInfo.time===e.time?(p.debug("gps时间和上一笔相同"),!1):!this.lastLocationInfo||this.lastLocationInfo.latitude!==e.latitude||this.lastLocationInfo.longitude!==e.longitude||(p.debug("gsp经纬度和上一笔相同"),!1)},e.prototype.send=function(e){p.info("下发Gsp:","累记距离:",this.currentDistance,e);var t=u.default.encodePb(o.default,"GpsLocationRsp_t",e),n=new l.default(c.AliceCategory.SportType.cmd,c.AliceCategory.SportType.sendGpsSwitchRsp,t);f.default.send(this.deviceId,n).then((function(e){p.info("send gps data response",e)})).catch((function(e){p.error("send gps data error",e)}))},e}()},6779:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Platform=void 0,function(e){e[e.unknown=0]="unknown",e[e.android=1]="android",e[e.ios=2]="ios"}(t.Platform||(t.Platform={}))},398:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionType=void 0,function(e){e[e.None=0]="None",e[e.Read=1]="Read",e[e.Write=2]="Write",e[e.Enable=3]="Enable",e[e.Indicate=4]="Indicate",e[e.Disable=5]="Disable",e[e.DataSync=6]="DataSync",e[e.SetMtu=7]="SetMtu",e[e.SendFile=8]="SendFile"}(t.ActionType||(t.ActionType={}))},9799:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.uuid,n=e.isPrimary;this.uuid=t.toUpperCase(),this.isPrimary=n,this.characteristics=[]}},5707:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){this.success=e,this.msg=t,this.value=r,this.originResponse=n,this.data=n}return e.success=function(t,n){return void 0===t&&(t=null),void 0===n&&(n=null),new e(!0,"success",t,n)},e.fail=function(t,n,r){return void 0===t&&(t=""),void 0===n&&(n=null),void 0===r&&(r=null),new e(!1,t,n,r)},e.failCode=function(t,n,r,i){void 0===t&&(t=-1),void 0===n&&(n=""),void 0===r&&(r=null),void 0===i&&(i=null);var o=new e(!1,n,r,i);return o.code=t,o},e}();t.default=n},8848:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScanMode=void 0,function(e){e[e.ALL=0]="ALL",e[e.Normal=1]="Normal"}(t.ScanMode||(t.ScanMode={}))},3654:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(398),u=a(n(5707)),s=a(n(4349)),l=function(){function e(e,t,n){var r=this;this.currentStep=0,this.mtu=23,this.client=e,this.isRecycle=!1,this.protocol=t,this.uuid=n,t.uuid=n,this.protocolName=n+"_"+t.protocolType,this.actions=t.actions,this.encoder=t.encoder,this.decoder=t.decoder,this.dataBuilder=t.dataBuilder,this.dataBuilder&&(this.dataBuilder.client=e,this.dataBuilder.deviceId=e.deviceId),this.client.addDataChangeListener(this.protocolName,(function(e){return!!r.isRecycle||(r.client.connected?(r.decoder.decode(e),!1):(setTimeout((function(){r.recycle()}),0),!0))}))}return e.prototype.recycle=function(){this.isRecycle=!0,this.client.removeDataChangeListener(this.protocolName)},e.prototype.process=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(i){switch(i.label){case 0:return this.isRecycle?(s.default.error("已经recycle"),[2,Promise.reject(u.default.fail("当前worker已回收"))]):(this.dataBuilder&&(this.dataBuilder.onDataReport=e.listeners.onDataReport,this.dataBuilder.context=e),this.currentAction=this.actions[this.currentStep],this.currentAction?this.currentAction.when&&!this.currentAction.when(e)?[3,6]:(s.default.debug("*********".concat(this.currentAction.name,"**********")),this.currentAction.await?(t=this.waitCondition(e),s.default.debug("Step",this.currentStep,"await 执行动作",this.currentAction.name),[4,this.doAction(this.currentAction,e)]):[3,3]):(s.default.debug("协议执行完毕"),[2,Promise.resolve(u.default.success())]));case 1:return i.sent(),s.default.debug("Step",this.currentStep,this.currentAction.name,"等待条件"),[4,t];case 2:return i.sent(),s.default.debug("Step",this.currentStep,this.currentAction.name,"条件通过"),[3,5];case 3:return s.default.debug("Step",this.currentStep,this.currentAction.name,"执行动作"),[4,this.doAction(this.currentAction,e)];case 4:i.sent(),i.label=5;case 5:return[3,7];case 6:s.default.debug("跳过动作 skip action: ",this.currentAction.name),i.label=7;case 7:return this.currentAction.next?(n=this.currentAction.next(e),(r=this.actions.findIndex((function(e){return e.name===n})))>=0?this.currentStep=r:(s.default.error("nextActionName is error",n,this.currentStep),this.currentStep++)):this.currentStep++,[4,this.process(e)];case 8:return[2,i.sent()]}}))}))},e.prototype.doAction=function(e,t){return r(this,void 0,void 0,(function(){var n,r,a,u,l,f,d,p,h,v,y,g,m,b,w,S=this;return i(this,(function(i){switch(i.label){case 0:switch(n=e.serviceId,r=e.characteristicId,a=e.mtu,e.actionType){case c.ActionType.None:return[3,1];case c.ActionType.DataSync:return[3,2];case c.ActionType.Enable:return[3,3];case c.ActionType.Indicate:return[3,5];case c.ActionType.Disable:return[3,7];case c.ActionType.Read:return[3,8];case c.ActionType.SetMtu:return[3,9];case c.ActionType.Write:return[3,11]}return[3,22];case 1:return[2];case 2:return this.decoder.addDataChangeListener("data",(function(e,t){return!!S.isRecycle||(setTimeout((function(){if(S.dataBuilder){var n=S.dataBuilder.receiveData(e,t);n&&S.dataBuilder.onDataReport(n)}}),0),!1)})),[2];case 3:return[4,this.client.enable(n,r)];case 4:return[2,i.sent()];case 5:return[4,this.client.enable(n,r,!0)];case 6:return[2,i.sent()];case 7:return[2,this.client.disable(n,r)];case 8:return[2,this.client.read(n,r)];case 9:return s.default.log("SetMtu:"+a),[4,this.client.setMtu(a,t.platform)];case 10:return(u=i.sent()).originResponse&&(this.mtu=u.originResponse.mtu),s.default.log("SetMtu done:"+this.mtu,t.platform),t.mtu=this.mtu,[2];case 11:return l=e.value(t),f=[],l instanceof ArrayBuffer?(f=this.encoder.encode(l,e.writeTag),[3,15]):[3,12];case 12:return l instanceof Array?(f=l,[3,15]):[3,13];case 13:return p=(d=this.encoder).encode,[4,l];case 14:f=p.apply(d,[i.sent(),e.writeTag]),i.label=15;case 15:i.trys.push([15,20,21,22]),h=o(f),v=h.next(),i.label=16;case 16:return v.done?[3,19]:(y=v.value,[4,this.client.write(n,r,y)]);case 17:if(!(g=i.sent()).success)return[2,Promise.reject(g)];i.label=18;case 18:return v=h.next(),[3,16];case 19:return[3,22];case 20:return m=i.sent(),b={error:m},[3,22];case 21:try{v&&!v.done&&(w=h.return)&&w.call(h)}finally{if(b)throw b.error}return[7];case 22:return[2]}}))}))},e.prototype.waitCondition=function(e){var t=this;console.log("this.currentAction.await",this.currentAction.await,this.currentAction.name,this.currentAction.await.timeout);var n=this.currentAction.await,r=n.timeout,i=n.onDataChange,o=n.eventName,a=n.onTimeout,c=this.encoder;return new Promise((function(n,l){var f=setTimeout((function(){s.default.error("动作await超时:"+t.currentAction.name+" time:"+r),(null==a?void 0:a(e))?n(u.default.success("await超时，执行超时回调，当前动作：",t.currentAction.name)):l(u.default.fail("await超时，当前动作: ",t.currentAction.name))}),r||1e4);t.decoder.addDataChangeListener(o,(function(t,r){clearTimeout(f);var o=i(t,e,c,r);return!0===o?setTimeout((function(){n(u.default.success())}),0):!1===o?setTimeout((function(){l(u.default.fail("await条件失败，value: ",t))}),0):o.success?setTimeout((function(){n(o)}),0):setTimeout((function(){l(o)}),0),!0}))}))},e}();t.default=l},9616:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3126)),o=r(n(8265));t.default={wx:{Adapter:i.default,Client:o.default}}},3126:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initOnBluetoothAdapterStateChange=void 0;var i=r(n(4349)),o=r(n(5707)),a=n(9047),c=[];t.initOnBluetoothAdapterStateChange=function(){(0,a.getBluetooth)().onBluetoothAdapterStateChange((function(e){var t=[];i.default.debug("onBluetoothAdapterStateChange:",e),c.forEach((function(n){var r=n.cb;r&&(r(e)||t.push({cb:r}))})),c=t}))};var u=function(){function e(){var e=this;this.available=!1,this.addStateChangeListener((function(t){return e.updateAvailable(t.available,(new Date).getTime()),!1})),this.getBLEAdapterState()}return e.prototype.addStateChangeListener=function(e){c.push({cb:e})},e.prototype.openBLEAdapter=function(){var e=this;return new Promise((function(t,n){var r=function(e,r){e?t(o.default.success()):n(o.default.fail("打开适配器失败",r))};(0,a.getBluetooth)().openBluetoothAdapter({success:function(){i.default.debug("开启蓝牙适配器"),e.getBLEAdapterState(r)},fail:function(n){i.default.error("开启蓝牙适配器失败",n.errCode,n.errMsg),e.getBLEAdapterState((function(n){n?t(o.default.success()):e.reopenBLEAdapter(r)}))}})}))},e.prototype.reopenBLEAdapter=function(e){var t=this;i.default.debug("重启蓝牙适配器"),(0,a.getBluetooth)().closeBluetoothAdapter({success:function(){},complete:function(){(0,a.getBluetooth)().openBluetoothAdapter({success:function(){},complete:function(){t.getBLEAdapterState(e)}})}})},e.prototype.getBLEAdapterState=function(e){var t=this,n=(new Date).getTime();(0,a.getBluetooth)().getBluetoothAdapterState({success:function(r){t.updateAvailable(r.available,n),null==e||e(t.available,r)},fail:function(r){t.updateAvailable(!1,n),i.default.error("getBluetoothAdapterState失败"),null==e||e(!1,r)}})},e.prototype.updateAvailable=function(e,t){this.updateAvailableTs&&this.updateAvailableTs>t||(this.available=e,this.updateAvailableTs=t)},e}();t.default=u},8265:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initOnBLECharacteristicValueChange=t.initOnBLEConnectionStateChange=void 0;var s=u(n(9799)),l=o(n(4349)),f=u(n(5707)),d=n(6779),p=n(5755),h=n(9047),v=new Map;t.initOnBLEConnectionStateChange=function(){(0,h.getBluetooth)().onBLEConnectionStateChange((function(e){if(v.has(e.deviceId)){var t=v.get(e.deviceId);l.default.info("connection state change:",e,t.length);var n=[];t.forEach((function(t){var r=t.cb;r&&(r({connected:e.connected,deviceId:e.deviceId})||n.push({cb:r}))})),v.set(e.deviceId,n)}}))};var y=new Map;t.initOnBLECharacteristicValueChange=function(){(0,h.getBluetooth)().onBLECharacteristicValueChange((function(e){var t=y.get(e.deviceId);t&&((0,l.isPrintValueChange)()&&l.default.debug("Frame Data","["+(0,p.subUUID)(e.characteristicId)+"]",(0,p.ab2hex)(e.value)),t(e))}))};var g=function(){function e(e){var t=this;this.writBufferQueue=[],this.deviceId=e,this.performance={},this.mClientDataChangeListener=[],this.isRecycle=!1,this.addConnectionChangeListener((function(e){return t.connected=e.connected,!e.connected&&(setTimeout((function(){t.recycle()}),0),!0)})),this.setDefaultDataChange(),l.default.log("new WXClient deviceId:"+this.deviceId)}return e.prototype.recycle=function(){this.isRecycle=!0,this.mClientDataChangeListener=[]},e.prototype.setDefaultDataChange=function(){var e=this;y.set(this.deviceId,(function(t){var n=[];e.mClientDataChangeListener.forEach((function(e){e.callback(t)||n.push(e)})),e.mClientDataChangeListener=n}))},e.prototype.addConnectionChangeListener=function(e){v.has(this.deviceId)?v.get(this.deviceId).push({cb:e}):v.set(this.deviceId,[{cb:e}])},e.prototype.addDataChangeListener=function(e,t){this.mClientDataChangeListener.push({callbackId:e,callback:t})},e.prototype.removeDataChangeListener=function(e){for(var t=[],n=0;n<this.mClientDataChangeListener.length;n++)this.mClientDataChangeListener[n].callbackId!==e&&t.push(this.mClientDataChangeListener[n]);this.mClientDataChangeListener=t,l.default.debug("removeDataChangeListener>>",e,this.mClientDataChangeListener)},e.prototype.connect=function(e){var t=this;return void 0===e&&(e=1e4),this.services=[],this.writing=!1,this.serviceMap=new Map,new Promise((function(n,r){t.performance.connectStart=new Date,(0,h.getBluetooth)().createBLEConnection({deviceId:t.deviceId,timeout:e,success:function(e){return l.default.info("connect success: ",t.deviceId),n(f.default.success(e))},fail:function(e){-1===e.errCode||-1===e.code?(l.default.warn("重复连接: ",t.deviceId,e),t.connected=!0,n(f.default.success(e))):(l.default.error("蓝牙连接失败: ",t.deviceId,e),r(f.default.fail("connect fail",e)),t.connected=!1,t.recycle())},complete:function(e){var n=new Date;t.performance.connectEnd=n,t.performance.connectTime=n.getTime()-t.performance.connectStart.getTime()}})}))},e.prototype.disconnect=function(){var e=this,t=this.deviceId;return new Promise((function(n,r){(0,h.getBluetooth)().closeBLEConnection({deviceId:t,success:function(e){l.default.info("disconnect: ",t),n(f.default.success(e))},fail:function(e){10006===e.errCode||10006===e.code?n(f.default.success(e)):(l.default.error("断开蓝牙连接失败: ",t,e),r(f.default.fail("disconnect fail",e)))},complete:function(t){e.recycle()}})}))},e.prototype.discoverServices=function(e){var t=this;return this.performance.getServicesStart=new Date,new Promise((function(n,r){setTimeout((function(){(0,h.getBluetooth)().getBLEDeviceServices({deviceId:t.deviceId,success:function(e){return a(t,void 0,void 0,(function(){var t,i;return c(this,(function(o){switch(o.label){case 0:if(l.default.debug("获取到服务",e),!e||!e.services||0===e.services.length)return l.default.error("获取服务为空"),r(f.default.fail("获取服务为空",e)),[2];t=0,o.label=1;case 1:return t<e.services.length?-1!==e.services[t].uuid.indexOf("1801")?[3,5]:(i=new s.default(e.services[t]),this.services.push(i),this.serviceMap.set(e.services[t].uuid,i),"0000180A-0000-1000-8000-00805F9B34FB"!==(a=e.services[t].uuid)&&"0000FCC0-0000-1000-8000-00805F9B34FB"!==a?[3,3]:[4,this.discoverCharacteristic(e.services[t].uuid)]):[3,6];case 2:return o.sent(),[3,5];case 3:return[4,this.discoverCharacteristic(e.services[t].uuid).then((function(e){})).catch((function(e){}))];case 4:o.sent(),o.label=5;case 5:return t++,[3,1];case 6:return n(f.default.success(e)),[2]}var a}))}))},fail:function(e){l.default.error("获取服务失败: ",t.deviceId,e),r(f.default.fail("获取服务失败",e)),10006===(e.errCode||e.code)&&(t.connected=!1)},complete:function(e){try{var n=new Date;t.performance.getServicesEnd=n,t.performance.getCharacteristicsStart=n,t.performance.getServiceTime=n.getTime()-t.performance.getServicesStart.getTime()}catch(e){}}})}),e)}))},e.prototype.discoverCharacteristic=function(e){var t=this,n=this.deviceId;return new Promise((function(r,i){(0,h.getBluetooth)().getBLEDeviceCharacteristics({deviceId:n,serviceId:e,success:function(n){t.serviceMap.get(e).characteristics=n.characteristics,r(f.default.success())},fail:function(r){l.default.error("discover fail: ",n,e,r),i(f.default.fail("获取特征值失败",r)),10006===(r.errCode||r.code)&&(t.connected=!1)},complete:function(e){}})}))},e.prototype.enable=function(e,t){var n=this;return l.default.debug("打开通道:",t),new Promise((function(r,i){(0,h.getBluetooth)().notifyBLECharacteristicValueChange({state:!0,deviceId:n.deviceId,serviceId:e,characteristicId:t,success:function(e){r(f.default.success(e))},fail:function(t){l.default.error("打开通道失败:",e,n.deviceId,t),i(f.default.fail("enable fail",t))}})}))},e.prototype.disable=function(e,t){var n=this;return l.default.info("close characteristic: ",t),new Promise((function(r,i){(0,h.getBluetooth)().notifyBLECharacteristicValueChange({state:!1,deviceId:n.deviceId,serviceId:e,characteristicId:t,success:function(e){r(f.default.success(e))},fail:function(e){l.default.error("disable fail: ",n.deviceId,e),i(f.default.fail("disable fail",e))}})}))},e.prototype.read=function(e,t){var n=this;return l.default.info("read characteristic: ",this.deviceId,t),new Promise((function(r,i){var o=setTimeout((function(){n.removeDataChangeListener(t),i(f.default.fail("read fail timeout",null))}),3e3);n.addDataChangeListener(t,(function(e){return e.characteristicId.toUpperCase().indexOf(t)>-1&&(clearTimeout(o),r(f.default.success(null,e.value)),!0)})),(0,h.getBluetooth)().readBLECharacteristicValue({deviceId:n.deviceId,serviceId:e,characteristicId:t,success:function(e){},fail:function(e){n.removeDataChangeListener(t),l.default.error("read fail: ",n.deviceId,e),i(f.default.fail("read fail",e))}})}))},e.prototype.writeList=function(e,t,n){for(var r=0;r<n.length;r++){var i={};i.byte=n[r],i.characteristicId=t,i.serviceId=e,this.writBufferQueue.push(i)}this.writing||this.handWriteQueue()},e.prototype.write=function(e,t,n){var r=this;return this.writing?Promise.reject(f.default.fail("client is writing:"+(0,p.ab2hex)(n))):((0,l.isPrintWrite)()&&l.default.info("write: characteristicId=".concat((0,p.subUUID)(t),", hex=").concat((0,p.ab2hex)(n))),new Promise((function(i){r.writing=!0,r.doWxWrite(e,t,n,i,0)})).then((function(e){return r.writing=!1,e})))},e.prototype.doWxWrite=function(e,t,n,r,i){var o=this;(0,h.getBluetooth)().writeBLECharacteristicValue({deviceId:this.deviceId,serviceId:e,characteristicId:t,value:n,success:function(e){r(f.default.success(e))},fail:function(a){10008===(a.errCode||a.code)&&i<3?(i>1&&l.default.error("write: retryCount: ",i,o.deviceId,t,a),setTimeout((function(){o.doWxWrite(e,t,n,r,i+1)}),100)):(l.default.error("write: ",o.deviceId,t,a),r(f.default.fail("write fail",a)))},complete:function(){}})},e.prototype.setMtu=function(e,t){var n=this;return new Promise((function(r){if((0,h.getBluetooth)().setBLEMTU)if(t===d.Platform.ios)r(f.default.success({mtu:158}));else{var i=setTimeout((function(){l.default.error("setBLEMTU timeout"),r(f.default.success({mtu:23}))}),1500);l.default.log("setBLEMTU ",e),(0,h.getBluetooth)().setBLEMTU({deviceId:n.deviceId,mtu:e,success:function(t){i&&clearTimeout(i);var n=t.mtu;n||(n=e),l.default.log("setBLEMTU success",t,n),r(f.default.success({mtu:n}))},fail:function(e){i&&clearTimeout(i),l.default.error("setMtu fail: ",n.deviceId,e),r(f.default.success({mtu:23}))}})}else l.default.error("setMtu fail: setBLEMTU 未实现 "),r(f.default.success({mtu:23}))}))},e.prototype.handWriteQueue=function(){var e=this;if(this.writBufferQueue.length>0){var t=this.writBufferQueue.shift();this.write(t.serviceId,t.characteristicId,t.byte).then((function(){e.handWriteQueue()})).catch((function(t){l.default.error("WriteQueue error",t),e.handWriteQueue()}))}},e}();t.default=g},9047:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getBluetooth=t.setBluetooth=void 0;var a=o(n(7498));t.setBluetooth=function(e){e&&(a=e)},t.getBluetooth=function(){return a}},7498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setStorage=t.setBLEMTU=t.readBLECharacteristicValue=t.notifyBLECharacteristicValueChange=t.getBLEDeviceCharacteristics=t.getBLEDeviceServices=t.writeBLECharacteristicValue=t.closeBLEConnection=t.createBLEConnection=t.onBLECharacteristicValueChange=t.onBLEConnectionStateChange=t.onBluetoothDeviceFound=t.onBluetoothAdapterStateChange=t.stopBluetoothDevicesDiscovery=t.startBluetoothDevicesDiscovery=t.getBluetoothAdapterState=t.closeBluetoothAdapter=t.openBluetoothAdapter=void 0;var r=n(6493);t.openBluetoothAdapter=(0,r.getMethod)((function(){return wx}),"openBluetoothAdapter"),t.closeBluetoothAdapter=(0,r.getMethod)((function(){return wx}),"closeBluetoothAdapter"),t.getBluetoothAdapterState=(0,r.getMethod)((function(){return wx}),"getBluetoothAdapterState"),t.startBluetoothDevicesDiscovery=(0,r.getMethod)((function(){return wx}),"startBluetoothDevicesDiscovery"),t.stopBluetoothDevicesDiscovery=(0,r.getMethod)((function(){return wx}),"stopBluetoothDevicesDiscovery"),t.onBluetoothAdapterStateChange=(0,r.getMethod)((function(){return wx}),"onBluetoothAdapterStateChange"),t.onBluetoothDeviceFound=(0,r.getMethod)((function(){return wx}),"onBluetoothDeviceFound"),t.onBLEConnectionStateChange=(0,r.getMethod)((function(){return wx}),"onBLEConnectionStateChange"),t.onBLECharacteristicValueChange=(0,r.getMethod)((function(){return wx}),"onBLECharacteristicValueChange"),t.createBLEConnection=(0,r.getMethod)((function(){return wx}),"createBLEConnection"),t.closeBLEConnection=(0,r.getMethod)((function(){return wx}),"closeBLEConnection"),t.writeBLECharacteristicValue=(0,r.getMethod)((function(){return wx}),"writeBLECharacteristicValue"),t.getBLEDeviceServices=(0,r.getMethod)((function(){return wx}),"getBLEDeviceServices"),t.getBLEDeviceCharacteristics=(0,r.getMethod)((function(){return wx}),"getBLEDeviceCharacteristics"),t.notifyBLECharacteristicValueChange=(0,r.getMethod)((function(){return wx}),"notifyBLECharacteristicValueChange"),t.readBLECharacteristicValue=(0,r.getMethod)((function(){return wx}),"readBLECharacteristicValue"),t.setBLEMTU=(0,r.getMethod)((function(){return wx}),"setBLEMTU"),t.setStorage=(0,r.getMethod)((function(){return wx}),"setStorage")},4240:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseAdvertisData=t.DeviceInfoUUIDS=t.BatteryState=t.AliceRequest=t.AliceUtils=t.pdfile=t.PbHandler=t.GpsStatus=t.GpsManager=t.BLEManager=void 0;var u=c(n(6063)),s=n(6063);Object.defineProperty(t,"BLEManager",{enumerable:!0,get:function(){return c(s).default}});var l=n(9433);Object.defineProperty(t,"GpsManager",{enumerable:!0,get:function(){return l.GpsManager}}),Object.defineProperty(t,"GpsStatus",{enumerable:!0,get:function(){return l.GpsStatus}});var f=n(1795);Object.defineProperty(t,"PbHandler",{enumerable:!0,get:function(){return c(f).default}}),t.pdfile=o(n(7250)),t.AliceUtils=o(n(2252));var d=n(5883);Object.defineProperty(t,"AliceRequest",{enumerable:!0,get:function(){return c(d).default}});var p=n(5901);Object.defineProperty(t,"BatteryState",{enumerable:!0,get:function(){return p.BatteryState}}),Object.defineProperty(t,"DeviceInfoUUIDS",{enumerable:!0,get:function(){return p.DeviceInfoUUIDS}});var h=n(3737);Object.defineProperty(t,"parseAdvertisData",{enumerable:!0,get:function(){return h.parseAdvertisData}}),a(n(8192),t),a(n(7807),t),t.default=u.default},9638:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ListenerUUID=void 0;var a=n(398),c=o(n(5707)),u=n(5755),s=o(n(4349)),l=o(n(1795)),f=o(n(8093)),d=o(n(2587)),p=o(n(608)),h=n(2252),v=n(8192),y="AC00",g="AC31";t.ListenerUUID="AC21";var m,b,w=function(e,n){return{serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(t.ListenerUUID),eventName:"rsp",timeout:3e3,onDataChange:function(t){return new f.default(t).isMatch(e,n),!0}}};t.default=[{name:"EnableCharacteristic",serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(t.ListenerUUID),actionType:a.ActionType.Enable},{name:"SendDeviceTime",serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(g),actionType:a.ActionType.Write,value:function(e){var t=(new Date).getTimezoneOffset(),n={timezone:t=t>0?-t:Math.abs(t),timestamp:parseInt(String((new Date).getTime()/1e3),10),timezoneCity:e.timezoneCity||"",timeFormat:e.timeFormat||0,dateFormat:e.dateFormat||0},r=l.default.encodePb(d.default,"time_t",n);return(0,h.formatApplicationPacket)(v.AliceCategory.DeviceInfoType.cmd,v.AliceCategory.DeviceInfoType.setTime,r)},await:w(v.AliceCategory.DeviceInfoType.cmd,v.AliceCategory.DeviceInfoType.setTime)},{name:"SetLanguage",serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(g),actionType:a.ActionType.Write,value:function(e){var t=e.languageConfig;t||(t={language:"zh",local:"CN"});var n={language:t.language,local:t.local},r=l.default.encodePb(d.default,"DeviceLanguageSet_t",n);return(0,h.formatApplicationPacket)(v.AliceCategory.DeviceInfoType.cmd,v.AliceCategory.DeviceInfoType.setLanguage,r)},await:w(v.AliceCategory.DeviceInfoType.cmd,v.AliceCategory.DeviceInfoType.setLanguage)},{name:"SendBind",serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(g),actionType:a.ActionType.Write,value:function(e){var t,n={account:null!==(t=e.userId)&&void 0!==t?t:"000000",masterMac:new Uint8Array(6)},r=l.default.encodePb(p.default,"bindReq_t",n);return(0,h.formatApplicationPacket)(v.AliceCategory.BasicType.cmd,v.AliceCategory.BasicType.bindReq,r)},await:{serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(t.ListenerUUID),eventName:"rsp",timeout:3e3,onDataChange:function(e){var t=new f.default(e);if(t.isMatch(v.AliceCategory.BasicType.cmd,v.AliceCategory.BasicType.bindReq)){if(t.hasProtoBuff()){var n=t.parsePb(p.default,"bindReqAck_t");return s.default.log("bindAck:",n.pbInfo),n.pbInfo&&0!==n.pbInfo.BindReqAck&&s.default.debug("发送绑定请求设备报错:"+n.pbInfo.BindReqAck),!(!n.pbInfo||0!==n.pbInfo.BindReqAck)||c.default.failCode(2,"设备拒绝绑定请求",n.pbInfo)}return!0}return!1}}},{name:"WaitingBindReply",serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(t.ListenerUUID),actionType:a.ActionType.None,await:{timeout:3e4,eventName:"data",onDataChange:function(e,t){var n=new f.default(e),r=n.getData();try{if(t.lastSeq=r.seq,r.commandId===v.AliceCategory.BasicType.bindConfirm&&r.categoryId===v.AliceCategory.BasicType.cmd)return r=n.parsePb(p.default,"bindConfirm_t"),s.default.log("bindConfirm:",r.pbInfo),1===r.pbInfo.bindConfirm||c.default.failCode(1,"设备不允许绑定",r.pbInfo)}catch(e){s.default.warn("bindConfirm报错:"+e,e)}return!1}}},("BindConfirm",m=v.AliceCategory.BasicType.cmd,b=v.AliceCategory.BasicType.bindConfirm,{name:"BindConfirm",serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(g),actionType:a.ActionType.Write,value:function(e){var t=(0,h.formatApplicationPacket)(m,b+128,undefined),n=(0,h.formatPayload)(t,!1,!0,!1,e.lastSeq);return s.default.log("App回复categoryId:".concat(m," commandId:").concat(b," seq:").concat(e.lastSeq)),n.buffer}}),{name:"SendResult",serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(g),actionType:a.ActionType.Write,value:function(e){var t,n,o;return r(this,void 0,void 0,(function(){var r,a,c,u,f;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,null===(t=e.listeners)||void 0===t?void 0:t.onConfirmBind()];case 1:return r=i.sent(),s.default.info("SDK 收到 onConfirmBind",r),[3,3];case 2:return a=i.sent(),s.default.error("SDK onConfirmBind 发生异常",a),r={error:a},[3,3];case 3:return"error"in r?(u=r.error,c={response:{bindResult:!1,errorMsg:null!==(n=null==u?void 0:u.errorMsg)&&void 0!==n?n:(null==u?void 0:u.message)||"绑定失败"},error:u}):c={confirmResult:r,response:{bindResult:null!==(o=null==r?void 0:r.success)&&void 0!==o&&o,errorMsg:(null==r?void 0:r.errorMsg)||"绑定失败"}},e.bindResult=c,f=l.default.encodePb(p.default,"bindResult_t",c.response),[2,(0,h.formatApplicationPacket)(v.AliceCategory.BasicType.cmd,v.AliceCategory.BasicType.bindResult,f)]}}))}))},await:{serviceId:(0,u.fill)(y),characteristicId:(0,u.fill)(t.ListenerUUID),eventName:"rsp",timeout:1e4,onDataChange:function(e,t){return t.bindResult.error?c.default.failCode(3,"确认绑定发生异常",null,{error:t.bindResult.error}):t.bindResult.response.bindResult?(new f.default(e).isMatch(v.AliceCategory.BasicType.cmd,v.AliceCategory.BasicType.bindResult),!0):c.default.failCode(4,"确认绑定返回绑定结果为失败",null,{confirmResult:t.bindResult.confirmResult})}}}]},9222:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AliceDataBuilder=void 0;var a=n(5901),c=o(n(8093)),u=o(n(1023)),s=o(n(4349)),l=o(n(5883)),f=o(n(6063)),d=n(8192),p=o(n(5719)),h=o(n(2587)),v=o(n(2339)),y=o(n(389)),g=o(n(3701)),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.receiveData=function(e){var t,n,r,i=new c.default(e),o=i.getData(),a=null;o.categoryId===d.AliceCategory.FileType.cmd&&(a=this.handlerFile(i)),function(e,t){var n=S.find((function(e){return e.categoryId===t.categoryId&&e.commandId===t.commandId}));n&&e.parsePb(n.pbfile,n.lookup)}(i,o);var u={isSendResp:w(o)};if((u=null!==(r=null===(n=null===(t=this.context.listeners)||void 0===t?void 0:t.onReceivePb)||void 0===n?void 0:n.call(t,i,u))&&void 0!==r?r:u).isSendResp){var p=new l.default(o.categoryId,o.commandId+128,a,o.seq);p.await=null,s.default.log("send 默认回复:"+o.categoryId+"/"+o.commandId),f.default.send(this.deviceId,p).catch((function(){}))}return i},t.prototype.handlerFile=function(e){var t=this,n=e.getData();if(n.commandId===d.AliceCategory.FileType.file_send_notify)return u.default.receiveFileSendNotify(e);if(n.commandId===d.AliceCategory.FileType.file_send_block)return u.default.receiveFileSendBlock(e);if(n.commandId===d.AliceCategory.FileType.file_send_finish)try{return u.default.receiveFileSendFinish(e,(function(e){var n=new d.AliceFileData(e.fileInfo);t.dataReport(n)}))}catch(e){return void s.default.error("file_send_finish error: ".concat(e),e)}if(n.commandId===d.AliceCategory.FileType.file_send_cancel)return u.default.receiveFileSendCancel(e);s.default.error("handlerFile error, 无效命令",n)},t}(a.DataBuilder);t.AliceDataBuilder=m;var b=[{categoryId:d.AliceCategory.SportType.cmd,commandId:d.AliceCategory.SportType.getGpsSwitch},{categoryId:11,commandId:1},{categoryId:11,commandId:3},{categoryId:6,commandId:1}];function w(e){var t=e.categoryId,n=e.commandId;return!b.some((function(e){return e.categoryId===t&&e.commandId===n}))}var S=[{categoryId:1,commandId:11,pbfile:h.default,lookup:"findPhone_t"},{categoryId:1,commandId:16,pbfile:h.default,lookup:"EventDisc_t"},{categoryId:2,commandId:13,pbfile:p.default,lookup:"SleepReport_t"},{categoryId:3,commandId:12,pbfile:g.default,lookup:"GpsSwitch_t"},{categoryId:4,commandId:7,pbfile:y.default,lookup:"PhoneCallChange_t"},{categoryId:5,commandId:6,pbfile:v.default,lookup:"pushStatus_t"},{categoryId:5,commandId:8,pbfile:v.default,lookup:"syncChoosedWatchface_t"}]},4564:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(5901),c=n(5755),u=o(n(4349)),s=n(9638),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.payloadBuffList=[],t._frameSeq=0,t._highLen=0,t.received=0,t}return i(t,e),t.prototype.decode=function(e){var t=e.value;if(e.characteristicId.indexOf(s.ListenerUUID)<=-1)u.default.debug("其他特征值",e.characteristicId);else if(t){var n=new DataView(t),r=0,i=n.getUint8(r);r++;var o=(0,c.getBitValue)(i,0),a=(0,c.getBitValue)(i,1),l=(0,c.getBitValue)(i,2),f=n.getUint8(r);r++;var d=n.getUint16(r,!0);r+=2;var p=0;l&&(p=n.getUint16(r,!0),r+=2);var h=t.slice(r,r+d);o&&a?this.parseTransportBuff(h.byteLength,h):o?(this._frameSeq=f,this._highLen=p,this.payloadBuffList=[],this.payloadBuffList.push(h)):a?(this.payloadBuffList.push(h),this.mergePayloadBuffList()):this._frameSeq+1===f?(this._frameSeq=f,this.payloadBuffList.push(h)):(this._frameSeq=f,this.payloadBuffList.push(h),u.default.error("帧数不匹配",f,this._frameSeq+1))}},t.prototype.reset=function(){this._frameSeq=0,this._highLen=0,this.payloadBuffList=[]},t.prototype.mergePayloadBuffList=function(){for(var e=0,t=0;t<this.payloadBuffList.length;t++)e+=this.payloadBuffList[t].byteLength;var n=new Uint8Array(e),r=0;for(t=0;t<this.payloadBuffList.length;t++){var i=this.payloadBuffList[t];n.set(new Uint8Array(i),r),r+=i.byteLength}var o=n.buffer;this.parseTransportBuff(o.byteLength,o)},t.prototype.parseTransportBuff=function(e,t){this.reset();var n=new DataView(t),r=n.getUint8(0),i=(0,c.getBitValue)(r,0),o=(0,c.getBitValue)(r,2),a={isReq:i,seq:n.getUint16(2,!0),isEncrypt:o};u.default.debug("triggerListener 数据:"+JSON.stringify(a)),i?this.triggerListener("data",t,a):this.triggerListener("rsp",t,a)},t}(a.Decoder);t.default=l},8784:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2252),o=r(n(4349)),a=function(){function e(){this.mtu=23}return e.prototype.crc=function(e){return null},e.prototype.encode=function(e,t){var n,r;t?(n=t.isReq,r=t.seq?t.seq:(0,i.getAutoIncrementSeq)()):(n=!0,r=(0,i.getAutoIncrementSeq)());var o=(0,i.formatPayload)(e,n,!n,!1,r);return(0,i.formatTransportBuff)(this.mtu,o.buffer)},e.prototype.setMtu=function(e){this.mtu=e,o.default.log("AliceEncoder mtu",e)},e}();t.default=a},2409:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(398),o=n(5755),a=r(n(1795)),c=r(n(2587)),u=r(n(3986)),s=n(2252),l=r(n(8093)),f=r(n(4349)),d=n(8192),p="AC00",h="AC31",v="AC21";function y(e,t){return{serviceId:(0,o.fill)(p),characteristicId:(0,o.fill)(v),eventName:"rsp",timeout:3e3,onDataChange:function(n){var r=new l.default(n).getData();return r.categoryId===e&&t===r.commandId}}}t.default=[{name:"setMtu",mtu:244,actionType:i.ActionType.SetMtu},{name:"EnableCharacteristic",serviceId:(0,o.fill)(p),characteristicId:(0,o.fill)(v),actionType:i.ActionType.Enable},{name:"SendMtu",serviceId:(0,o.fill)(p),characteristicId:(0,o.fill)(h),actionType:i.ActionType.Write,when:function(e){return e.mtu>23},await:{serviceId:(0,o.fill)(p),characteristicId:(0,o.fill)(v),eventName:"rsp",timeout:3e3,onDataChange:function(e,t,n){var r,i=new l.default(e);return i.parsePb(c.default,"connectNegotiationParm_t"),(null===(r=i.getData().pbInfo)||void 0===r?void 0:r.maxTransimissionUnit)?n.setMtu(i.getData().pbInfo.maxTransimissionUnit):n.setMtu(t.mtu),!0}},value:function(e){var t={maxTransimissionUnit:e.mtu};f.default.log("sendMtu",t);var n=a.default.encodePb(c.default,"connectNegotiationParm_t",t);return(0,s.formatApplicationPacket)(d.AliceCategory.BasicType.cmd,d.AliceCategory.BasicType.ConnectParm,n)}},{name:"SendDeviceTime",serviceId:(0,o.fill)(p),characteristicId:(0,o.fill)(h),actionType:i.ActionType.Write,await:y(d.AliceCategory.DeviceInfoType.cmd,d.AliceCategory.DeviceInfoType.setTime),value:function(e){var t=(new Date).getTimezoneOffset(),n={timezone:t=t>0?-t:Math.abs(t),timestamp:parseInt(String((new Date).getTime()/1e3),10),timezoneCity:e.timezoneCity||"",timeFormat:e.timeFormat||0,dateFormat:e.dateFormat||0};f.default.log("sendTimeInfo",n);var r=a.default.encodePb(c.default,"time_t",n);return(0,s.formatApplicationPacket)(d.AliceCategory.DeviceInfoType.cmd,d.AliceCategory.DeviceInfoType.setTime,r)}},{name:"SendUserInfo",serviceId:(0,o.fill)(p),characteristicId:(0,o.fill)(h),actionType:i.ActionType.Write,value:function(e){var t=new ArrayBuffer(4),n=new DataView(t),r=new Date(e.userInfo.birthday);n.setUint16(0,r.getFullYear(),!1),n.setUint8(2,r.getMonth()+1),n.setUint8(3,r.getDate());var i=n.getInt32(0,!1),o={Weight:e.userInfo.weight,Height:e.userInfo.height,Birthday:i,Age:e.userInfo.age,Gender:1===e.userInfo.gender?1:0,NickName:e.userInfo.nickName};f.default.log("SendUserInfo",o);var c=a.default.encodePb(u.default,"UserInfo_t",o);return(0,s.formatApplicationPacket)(d.AliceCategory.HealthType.cmd,d.AliceCategory.HealthType.set_userInfo,c)},await:y(d.AliceCategory.HealthType.cmd,d.AliceCategory.HealthType.set_userInfo)},{name:"DataSync",serviceId:(0,o.fill)(p),characteristicId:(0,o.fill)(v),actionType:i.ActionType.DataSync}]},2252:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.format=t.parseFileData=t.parseFileInfo=t.formatTransportBuff=t.formatPayload=t.getFrameCtrl=t.getAutoIncrementSeq=t.formatApplicationPacket=t.getCtrl=void 0;var a=o(n(4349)),c=n(5755),u=o(n(1675)),s=o(n(1795)),l=n(9232);function f(e,t,n){var r=0;return e&&(r|=1),t&&(r|=2),n&&(r|=4),r}function d(e,t,n,r){var i=0;return e&&(i|=1),t&&(i|=2),n&&(i|=4),r&&(i|=8),i}t.getFrameCtrl=f,t.getCtrl=d;var p=0;function h(e){var t=e.fileBuffer,n=t.slice(0,32),r={},i=new DataView(n);r.fileType=(0,c.toUtf8String)(n.slice(0,8)),r.version=i.getUint16(11,!0);for(var o=t.slice(32,t.byteLength),s=0,l=[],f=!1;s<o.byteLength;){var d=new u.default(o,s);d.getUint16("header",!0).getUint32("startTime",!0).getUint32("endTime",!0).getUint8("type").getUint8("r").getUint16("check").getUint16("pbLength",!0);var p=d.build();42405===p.header?(s=d.getByteOffset())+p.pbLength>o.byteLength?(a.default.error("长度大于包总数",s+p.pbLength,o.byteLength),f=!0):(p.pbBuffer=o.slice(s,s+p.pbLength),s+=p.pbLength,l.push(p)):(a.default.error("parseFileInfo pb解析失败"),f=!0,s+=1)}return f&&a.default.error("文件解析失败过"),{fileHeader:r,pbPacketList:l}}t.getAutoIncrementSeq=function(){return++p>65535&&(p=0),p},t.formatPayload=function(e,t,n,r,i){if(t!==n){var o=d(t,n,r,true),u=e.byteLength,s=6,l=new ArrayBuffer(s+=2),f=new DataView(l);f.setUint8(0,o),f.setUint8(1,1),f.setUint16(2,i,!0),f.setUint16(4,u,!0),f.setUint16(6,43690,!0);var p=(0,c.appendBuffer)(l,e),h=(0,c.getCRC32ForAlice)(p).toString(16);h=(0,c.formatWithZero)(h,8);var v=(0,c.hex2ArrayBuffer)(h);return v=(0,c.hex2ArrayBuffer)((0,c.ab2hex)(v,!0)),{ctrl:o,seq:i,length:u,isEncrypt:r,crc32:h,buffer:(0,c.appendBuffer)(p,v)}}a.default.error("formatPayload 非法参数")},t.formatTransportBuff=function(e,t){e||(e=23);var n=e-3;n-=4;var r=t.byteLength+2,i=Math.floor(r/n);r%n!=0&&i++;for(var o=0,a=new Array(i),u=0;u<i;u++){var s=f(0===u,u===i-1,0===u),l=u,d=0;if(0===u){var p=t.slice(0,n-2);d=p.byteLength,o+=n-2;var h=new ArrayBuffer(6);(v=new DataView(h)).setUint8(0,s),v.setUint8(1,l),v.setUint16(2,d,!0),v.setUint16(4,t.byteLength,!0),a[u]=(0,c.appendBuffer)(h,p)}else{var v,y=t.slice(o,Math.min(t.byteLength,o+n));d=y.byteLength,o+=n,h=new ArrayBuffer(4),(v=new DataView(h)).setUint8(0,s),v.setUint8(1,l),v.setUint16(2,d,!0),a[u]=(0,c.appendBuffer)(h,y)}}return a},t.formatApplicationPacket=function(e,t,n){var r=new ArrayBuffer(2),i=new DataView(r);return i.setUint8(0,e),i.setUint8(1,t),n?(0,c.appendBuffer)(r,n):r},t.parseFileInfo=h,t.parseFileData=function(e){var t;try{var n=(t=h(e)).fileHeader.fileType,o=t.pbPacketList.map((function(e){var t=(0,l.findFileMeta)({fileType:n,pbPacket:e});if(t)try{return{data:s.default.decodePb(t.pdfile,t.lookup,e.pbBuffer),originData:e}}catch(n){throw n.decodePbError={fileMeta:t,pbPacket:e},n}else a.default.error("无效数据 fileType=".concat(n),e)}));return{fileHeader:t.fileHeader,fileList:o}}catch(n){var u=n;u.aliceFileInfo=t;var f=["解析文件失败 ".concat(u),u,e,t];throw u.decodePbError&&(f.push(u.decodePbError),f.push((0,c.ab2hex)(u.decodePbError.pbPacket.pbBuffer))),a.default.error.apply(a.default,i([],r(f),!1)),u}},t.format=function(e,t,n){void 0===n&&(n=1);var r=1===n?t:t+6e4*(new Date).getTimezoneOffset()+288e5,i=new Date(r),o={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,String(i.getFullYear()).substr(4-RegExp.$1.length))),o)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?o[a]:("00"+o[a]).substr(String(o[a]).length)));return e}},8093:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1795)),o=n(5755),a=r(n(4349)),c=n(8192),u=function(){function e(e){if(this.dataType=c.DataType_Alice,e){var t=new DataView(e);this.packet={};var n=t.getUint8(0),r=0;r++,r++,this.packet.seq=t.getUint16(r,!0),r+=2;var i=t.getUint16(r,!0);r+=2;var u=(0,o.getBitValue)(n,1);this.packet.isRsp=u,(0,o.getBitValue)(n,3)&&(r+=2);var s=e.slice(0,r+i),l=e.slice(r,r+i),f=e.slice(e.byteLength-4,e.byteLength),d=(0,o.getCRC32ForAlice)(s).toString(16);d=(0,o.formatWithZero)(d,8);var p=(0,o.ab2hex)(f,!0);d!==p&&a.default.error("crc fail",p,"本地计算:",d);var h=new DataView(l);this.packet.categoryId=h.getUint8(0),this.packet.commandId=h.getUint8(1),this.packet.commandId>=128||u?(this.packet.isReq=!1,this.packet.commandId=this.packet.commandId-128):this.packet.isReq=!0,a.default.log("收到数据:".concat(this.packet.categoryId,"/").concat(this.packet.commandId," seq:").concat(this.packet.seq," ").concat(this.packet.isReq," ").concat((0,o.ab2hexLimit)(e,20))),h.byteLength>2&&(this.packet.pbArrayBuffer=l.slice(2,l.byteLength))}}return e.prototype.getData=function(){return this.packet},e.prototype.isMatch=function(e,t){t>128&&(t-=128);var n=this.packet.categoryId===e&&this.packet.commandId===t;return n||a.default.error("isMatch fail 解包:".concat(this.packet.categoryId,"/").concat(this.packet.commandId," 不匹配:").concat(e,"/").concat(t)),n},e.prototype.hasProtoBuff=function(){return this.packet.pbArrayBuffer&&this.packet.pbArrayBuffer.byteLength>0},e.prototype.parsePb=function(e,t,n){if(a.default.log("parsePb",e,this.packet),e&&t||a.default.error("parsePb error: pbRoot, lookup empty:",e,t),this.packet.pbArrayBuffer)try{var r=new Uint8Array(this.packet.pbArrayBuffer);this.packet.pbInfo=i.default.decodePb(e,t,r),n?a.default.debug("pbInfo",this.packet.pbInfo):a.default.log("pbInfo",this.packet.pbInfo)}catch(e){a.default.error("pb解析失败:"+e,t,(0,o.ab2hex)(this.packet.pbArrayBuffer))}return this.packet},e}();t.default=u},1023:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(7107)),a=i(n(1795)),c=i(n(4349)),u=n(8192),s=function(){function e(){this.fileMap=new Map,this.fileMap=new Map}return e.prototype.receiveFileSendNotify=function(e){var t=e.parsePb(o.default,"FileSendRequest_t"),n=t.pbInfo.taskId,i=r(r({},t.pbInfo),{blockList:[]});this.fileMap.set(n,i),c.default.info("receive file notify:",this.fileMap);var s={taskId:n,errorCode:u.AliceErrorCode.RET_GE_SUCCESS,recievedSize:0};return a.default.encodePb(o.default,"FileSendResponse",s)},e.prototype.receiveFileSendBlock=function(e){try{var t=e.parsePb(o.default,"fileChunkSendRequest",!0).pbInfo,n=t.index,r=t.taskId;c.default.debug("receive file block：index"+n);var i=this.fileMap.get(r);return i?(n>0&&i.blockList.length!==n&&c.default.error("文件块编号不对, taskId:"+r,i.blockList.length),i.blockList.push(t.content),c.default.debug("file.blockList:"+i.blockList.length),a.default.encodePb(o.default,"fileChunkSendResponse ",{taskId:r,errorCode:u.AliceErrorCode.RET_GE_SUCCESS})):(c.default.error("block 未接收到文件通知",this.fileMap,r),a.default.encodePb(o.default,"fileChunkSendResponse ",{taskId:r,errorCode:u.AliceErrorCode.RET_GE_UNKNOW}))}catch(e){c.default.debug(" receiveFileSendBlock err"+e)}},e.prototype.receiveFileSendFinish=function(e,t){var n=e.parsePb(o.default,"fileSendComplete_t"),r=n.pbInfo.taskId,i=u.AliceErrorCode.RET_GE_SUCCESS,s=this.fileMap.get(r);if(c.default.info("receive file finish",n.pbInfo),s){for(var l=s.blockList,f=s.fileSize||0,d=0,p=0;p<l.length;p++)d+=l[p].byteLength;if(1!==s.fileType&&d===f||1===s.fileType&&d>=f){var h=new Uint8Array(d),v=0;for(p=0;p<l.length;p++)h.set(new Uint8Array(l[p]),v),v+=l[p].byteLength;s.fileBuffer=h.buffer,s.blockList=[],c.default.info("receive file finish: fileName=".concat(s.fileName,", byteSize=").concat(d,", fileType=").concat(s.fileType)),null==t||t({fileInfo:s})}else c.default.error("finish 文件校验失败 size不一致 bytSize/fileSize",d,f),c.default.error("block list",l.length,"file",s.fileName),i=u.AliceErrorCode.RET_GE_NO_MEM;this.fileMap.delete(r)}else c.default.error("finish 未接收到文件通知",this.fileMap,r),i=u.AliceErrorCode.RET_GE_UNKNOW;return a.default.encodePb(o.default,"fileSendComplete_t ",{taskId:r,errorCode:i})},e.prototype.receiveFileSendCancel=function(e){var t=e.parsePb(o.default,"fileSendCancel_t");c.default.log("fileCancel",t.pbInfo);var n=t.pbInfo.taskId;try{this.fileMap.delete(n)}catch(e){c.default.error(e)}return a.default.encodePb(o.default,"fileSendComplete_t ",{taskId:n,errorCode:u.AliceErrorCode.RET_GE_SUCCESS})},e}();t.default=new s},9232:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.findFileMeta=void 0;var c=o(n(7250)),u=[{fileType:["HR"],pd:[{pdfile:c.filerecard,lookup:"HrDataPacket_t"}]},{fileType:["SPO2-S","SPO2-P"],pd:[{pdfile:c.filerecard,lookup:"Spo2DataPacket_t"}]},{fileType:["SLEP"],pd:[{pbPacketType:0,pdfile:c.filerecard,lookup:"SleepDataPacket_t"},{pbPacketType:1,pdfile:c.filerecard,lookup:"SleepReport_t"}]},{fileType:["ACTIS"],pd:[{pdfile:c.filerecard,lookup:"ActiveDataPacket_t"}]},{fileType:["ACTI-2"],pd:[{pdfile:c.filerecard,lookup:"History7DayData_t"}]},{fileType:["ACTI"],pd:[{pdfile:c.filerecard,lookup:"DayActiveData_t"}]},{fileType:["R_HR"],pd:[{pdfile:c.filerecard,lookup:"RESTING_HR_DATA_t"}]},{fileType:["SPOR"],pd:[{pdfile:c.sport,lookup:"SportDetailPacket_t"}]},{fileType:["GPSD"],pd:[{pdfile:c.sport,lookup:"GpsDetailPacket_t"}]}];t.findFileMeta=function(e){var t,n,r=e.fileType,i=e.pbPacket;try{for(var o=a(u),c=o.next();!c.done;c=o.next()){var s=c.value;if(s.fileType.some((function(e){return r.startsWith(e)}))){var l=s.pd.find((function(e){return!("pbPacketType"in e)||e.pbPacketType===i.type}));if(l)return l}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}},5883:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(5755),o=n(2252),a=r(n(8093)),c=r(n(4349)),u=function(){function e(e,t,n,r){var u=this;this.serviceId=(0,i.fill)("AC00"),this.characteristicId=(0,i.fill)("AC31"),this.await={eventName:"rsp",timeout:3e3,onDataChange:function(e,t){var n={};if(t.seq===u.aliceEncodeTag.seq){n.isConsumer=!0;var r=new a.default(e);r.isMatch(u.categoryId,u.commandId)?(u.responseData=r,n.isSucceed=!0):n.isSucceed=!1}else n.isConsumer=!1,(new Date).getTime()-u.requestTime>15e3&&(n.isConsumer=!0),n.isConsumer=!1;return n}},this.categoryId=e,this.commandId=t,this.appBuff=(0,o.formatApplicationPacket)(e,t,n),this.isReq=this.commandId<=128,this.aliceEncodeTag={},this.aliceEncodeTag.isReq=this.isReq,this.aliceEncodeTag.seq=r||(0,o.getAutoIncrementSeq)(),c.default.info("request: categoryId=".concat(this.categoryId,", commandId=").concat(this.commandId," seq=").concat(this.aliceEncodeTag.seq," pbBuff:").concat((0,i.ab2hexLimit)(n,20))),this.requestTime=(new Date).getTime(),this.isReq||(this.await=null)}return e.prototype.setTimeout=function(e){this.await&&(this.await.timeout=Math.max(3e3,e))},e.prototype.getCmd=function(){return this.categoryId+"/"+this.commandId},e.prototype.getBytes=function(){return this.encoder.encode(this.appBuff,this.aliceEncodeTag)},e.prototype.setEncoder=function(e){this.encoder=e},e}();t.default=u},8192:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AliceCategory=t.AliceErrorCode=t.AliceFileData=t.AliceSettingType=t.DataType_AliceFile=t.DataType_Alice=void 0,t.DataType_Alice="aliceData",t.DataType_AliceFile="aliceFile",t.AliceSettingType={};var n=function(){function e(e){this.fileInfo=e,this.dataType=t.DataType_AliceFile}return e.prototype.getData=function(){return this.fileInfo},e}();t.AliceFileData=n,t.AliceErrorCode={RET_GE_SUCCESS:1e6,RET_GE_UNKNOW:1000001,RET_GE_NO_MEM:1000002,RET_GE_INVALID_PARAM:1000003},t.AliceCategory={BasicType:{cmd:0,ConnectParm:1,queryBindState:3,bindReq:4,bindConfirm:5,bindResult:6,unbindReq:7},DeviceInfoType:{cmd:1,readTime:1,setTime:2,getVersion:3,getBattery:4,setLanguage:13},HealthType:{cmd:2,getHeartConfig:1,setHeartConfig:2,getSpo2Config:3,setSpo2Config:4,getSleepConfig:5,setSleepConfig:6,getUserInfo:7,set_userInfo:8,setSedentaryReminder:10,getSedentaryReminder:9,getRecordData:11,getSleepRecord:12},SportType:{cmd:3,getActiveGoal:1,setActiveGoal:2,getSportDetection:3,setSportDetection:4,getSportAutoPauseStop:5,setSportAutoPauseSto:6,getTodayActiveTotal:7,getSportDescription:8,getSportDetail:9,getGpsSwitch:12,sendGpsSwitchRsp:13,getActivityStrength:14},NotificationType:{cmd:4,getNotificationSwitch:1,setNotificationSwitch:2,sendTextNotification:3,sendPic:4,NotificationReply:5,NotificationRemoved:6,sendPhoneCallChange:7},WatchFaceType:{cmd:5},WeatherType:{cmd:6},AlarmType:{cmd:7,getAlarm:1,setAlarm:2,alarmUpdate:3},FileType:{cmd:8,getFileList:1,getFileByName:2,file_send_notify:3,file_send_block:4,file_send_finish:5,file_send_cancel:6},AuthenticationType:{cmd:9},DataCollectType:{cmd:10}}},1423:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolType=t.NoneReadDeviceInfo=t.NoneEncoder=t.NoneDecoder=void 0;var s=u(n(9638)),l=u(n(2409)),f=u(n(4564)),d=u(n(8784)),p=n(5901),h=u(n(4349)),v=n(9222),y=n(5755),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.decode=function(e){this.triggerListener("data",e.value)},t}(p.Decoder);t.NoneDecoder=g;var m=function(){function e(){}return e.prototype.crc=function(e){},e.prototype.encode=function(e,t){return[e]},e.prototype.setMtu=function(){},e}();t.NoneEncoder=m;var b,w=function(){function e(){}return e.prototype.readDeviceInfo=function(e,t){return o(this,void 0,void 0,(function(){var n,r,i,o,c,u,s;return a(this,(function(a){switch(a.label){case 0:if(n=null,e.services.forEach((function(e){e.uuid===p.DeviceInfoUUIDS.DeviceInfo&&(n=e)})),(r={}).deviceId=e.deviceId,!n)return[3,9];if(!(null==t?void 0:t.length))return[3,5];c=0,a.label=1;case 1:return c<t.length?"firmwareVersion"!==(s=t[c])?[3,3]:[4,e.read(n.uuid,p.DeviceInfoUUIDS.CharacteristicFirmware)]:[3,4];case 2:i=a.sent().value,r.firmwareVersion=(0,y.toUtf8String)(i),a.label=3;case 3:return c++,[3,1];case 4:return[3,9];case 5:o=n.characteristics,c=0,a.label=6;case 6:return c<o.length?(u=o[c],[4,e.read(n.uuid,u.uuid)]):[3,9];case 7:s=a.sent().value,u.uuid===p.DeviceInfoUUIDS.CharacteristicManufacture&&(r.manufacture=(0,y.toUtf8String)(s)),u.uuid===p.DeviceInfoUUIDS.CharacteristicModel&&(r.model=(0,y.toUtf8String)(s)),u.uuid===p.DeviceInfoUUIDS.CharacteristicSoftware&&(r.softwareVersion=(0,y.toUtf8String)(s)),u.uuid===p.DeviceInfoUUIDS.CharacteristicHardware&&(r.hardwareVersion=(0,y.toUtf8String)(s)),u.uuid===p.DeviceInfoUUIDS.CharacteristicFirmware&&(r.firmwareVersion=(0,y.toUtf8String)(s)),u.uuid===p.DeviceInfoUUIDS.CharacteristicSerialNumber&&(r.sn=(0,y.toUtf8String)(s)),a.label=8;case 8:return c++,[3,6];case 9:return[2,Promise.resolve(r)]}}))}))},e}();t.NoneReadDeviceInfo=w,function(e){e[e.Bind=0]="Bind",e[e.Sync=1]="Sync",e[e.Ota=2]="Ota"}(b=t.ProtocolType||(t.ProtocolType={}));var S=[],I=new function(e,t,n,r,i){this.uuid="AC00".toUpperCase().trim(),this.bind=t,this.sync=n,this.ota=null,this.readDeviceInfo=i}("AC00",{protocolType:b.Bind,actions:s.default,encoder:new d.default,get decoder(){return new f.default}},{protocolType:b.Sync,actions:l.default,get encoder(){return new d.default},get decoder(){return new f.default},get dataBuilder(){return new v.AliceDataBuilder}},null,new w);S.push(I),t.default={getProtocolByServices:function(e){var t,n;h.default.debug("registerProtocolList",S);try{for(var r=c(e),i=r.next();!i.done;i=r.next())for(var o=i.value.uuid.toUpperCase(),a=0;a<S.length;a++)if(o.indexOf(S[a].uuid)>-1)return S[a]}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}h.default.error("不支持的设备")}}},3737:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseAdvertisData=void 0;var r=n(5755);t.parseAdvertisData=function(e){if(e&&!(e.byteLength<6)){var t,n,i=e.byteLength;if(6===i)t="normal",n=e;else if(8===i)t="normal",n=e.slice(2);else if(12===i)t="PEclass",n=e.slice(0,6);else{if(14!==i)return;t="PEclass",n=e.slice(2,8)}return{mac:(0,r.ab2hex)(n).toUpperCase(),mode:t}}}},5901:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.AncsService=t.DeviceInfoUUIDS=t.BatteryState=t.Decoder=t.DataBuilder=void 0;var a=o(n(4349)),c=n(5755),u=function(){function e(){}return e.prototype.dataReport=function(e){e.deviceId=this.deviceId,this.onDataReport(e)},e}();t.DataBuilder=u;var s=function(){function e(){this.listenerMap=new Map}return e.prototype.addDataChangeListener=function(e,t){this.listenerMap.has(e)?this.listenerMap.get(e).push({callback:t}):this.listenerMap.set(e,[{callback:t}])},e.prototype.triggerListener=function(e,t,n){if(this.listenerMap.has(e)){var r=[],i=this.listenerMap.get(e)||[];0===i.length?a.default.error("数据未监听",e,(0,c.ab2hex)(t),n):"rsp"===e&&(0,a.isPrintValueChange)()&&a.default.info("receive: eventName=".concat(e,", tag=").concat(JSON.stringify(n),", hex=").concat((0,c.ab2hex)(t)));for(var o=0;o<i.length;o++){var u=i[o],s=u.callback;s&&(s(t,n)||r.push(u))}r.length&&i.length===r.length&&"data"!==e&&a.default.log("no listener remove  for event:",e,r.length,(0,c.ab2hexLimit)(t,20)),this.listenerMap.set(e,r)}else a.default.warn("no listener for event:",e,t)},e}();t.Decoder=s,function(e){e[e.None=0]="None",e[e.Charging=1]="Charging"}(t.BatteryState||(t.BatteryState={})),t.DeviceInfoUUIDS={DeviceInfo:"0000180A-0000-1000-8000-00805F9B34FB",CharacteristicManufacture:"00002A29-0000-1000-8000-00805F9B34FB",CharacteristicModel:"00002A24-0000-1000-8000-00805F9B34FB",CharacteristicSerialNumber:"00002A25-0000-1000-8000-00805F9B34FB",CharacteristicHardware:"00002A27-0000-1000-8000-00805F9B34FB",CharacteristicFirmware:"00002A26-0000-1000-8000-00805F9B34FB",CharacteristicSoftware:"00002A28-0000-1000-8000-00805F9B34FB",CharacteristicSystemId:"00002A23-0000-1000-8000-00805F9B34FB"},t.AncsService={UUID:"0000FCC0-0000-1000-8000-00805F9B34FB",CharacteriticMac:"0000FCC8-0000-1000-8000-00805F9B34FB"}},7807:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingResponse=t.BatteryState=t.DeviceInfoUUIDS=void 0,i(n(6779),t),i(n(8848),t);var o=n(5901);Object.defineProperty(t,"DeviceInfoUUIDS",{enumerable:!0,get:function(){return o.DeviceInfoUUIDS}}),Object.defineProperty(t,"BatteryState",{enumerable:!0,get:function(){return o.BatteryState}}),t.SettingResponse={no_sync:{code:-1,msg:"请完成连接后再进行设置"},invalid_parameter:{code:-2,msg:"参数有误"},no_unrealized:{code:-3,msg:"暂未实现该功能"},no_support:{code:-4,msg:"不支持的设置项"}}},1675:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(4349)),o=n(5755);function a(e,t,n){return e?(t.getUint8(n+2)<<16)+(t.getUint8(n+1)<<8)+t.getUint8(n):(t.getUint8(n)<<16)+(t.getUint8(n+1)<<8)+t.getUint8(n+2)}var c=function(){function e(e,t){void 0===t&&(t=0),this.size=0,this.values=[],this.originalBuffer=e,this.size=t}return e.prototype.build=function(e){var t=this;if(!this.originalBuffer||this.originalBuffer.byteLength<=0)return i.default.error("originalBuffer is null",this.originalBuffer),null;e||(e={});var n=new DataView(this.originalBuffer);return this.values.forEach((function(r){var c=r.byteOffset,u=r.method,s=r.key,l=r.size,f=r.littleEndian;try{if("getString"===u)e[s]=(0,o.toUtf8String)(t.originalBuffer.slice(c,c+l));else if("getBuffer"===u)e[s]=t.originalBuffer.slice(c,c+l);else if("getUint8"===u)e[s]=n.getUint8(c);else if("Uint24"===u)e[s]=a(f,n,c);else if("Uint8Array"===u)e[s]=[].slice.call(new Uint8Array(t.originalBuffer.slice(c,c+l)));else if("Uint16Array"===u)e[s]=[].slice.call(new Uint16Array(t.originalBuffer.slice(c,c+l)));else if("SFloat"===u){var d=((15&(h=n.getUint8(c)))<<8)+n.getUint8(c+1),p=Math.pow(10,((240&h)>>4)-16);e[s]=d*p}else if("Float"===u){var h=n.getUint8(c);d=a(f,n,c+1),p=Math.pow(10,(15&h)-16),e[s]=d*p}else e[s]=n[u](c,f)}catch(e){i.default.error("reader err:"+e),i.default.error(c,u,s,l,f)}})),e},e.prototype.getUint24=function(e,t){return void 0===t&&(t=!1),this.values.push({byteOffset:this.size,method:"Uint24",key:e,littleEndian:t}),this.size+=3,this},e.prototype.getSFloat=function(e){return this.values.push({byteOffset:this.size,method:"SFloat",key:e}),this.size+=2,this},e.prototype.getFloat=function(e,t){return void 0===t&&(t=!1),this.values.push({byteOffset:this.size,method:"Float",key:e,littleEndian:t}),this.size+=4,this},e.prototype.getUint8Array=function(e,t){return this.values.push({byteOffset:this.size,size:t,method:"Uint8Array",key:e}),this.size+=t,this},e.prototype.getUint16Array=function(e,t){return this.values.push({byteOffset:this.size,size:t,method:"Uint16Array",key:e}),this.size+=t,this},e.prototype.getUint8=function(e){return this.values.push({byteOffset:this.size,method:"getUint8",key:e}),this.size++,this},e.prototype.getUint16=function(e,t){return void 0===t&&(t=!1),this.values.push({byteOffset:this.size,method:"getUint16",key:e,littleEndian:t}),this.size+=2,this},e.prototype.getUint32=function(e,t){return void 0===t&&(t=!1),this.values.push({byteOffset:this.size,method:"getUint32",key:e,littleEndian:t}),this.size+=4,this},e.prototype.getBuffer=function(e,t){this.values.push({byteOffset:this.size,size:t,method:"getBuffer",key:e}),this.size+=t},e.prototype.getByteOffset=function(){return this.size},e.prototype.getString=function(e,t){this.values.push({byteOffset:this.size,size:t,method:"getString",key:e}),this.size+=t},e}();t.default=c},5755:function(e,t){"use strict";function n(e){var t=0,n=e.length;if(n%2!=0)return null;n/=2;for(var r=[],i=0;i<n;i++){var o=e.substr(t,2),a=parseInt(o,16);r.push(a),t+=2}return r}function r(e,t){if(!e)return"";for(var n="",r=0;r<t-e.length;r++)n+="0";return n+e}Object.defineProperty(t,"__esModule",{value:!0}),t.getCRC32=t.toArrayWithSize=t.toUtf8String=t.subUUID=t.getBitValue=t.getCRCResult=t.getCRC32ForAlice=t.fill=t.mergeBuffer=t.appendBuffer=t.formatWithZero=t.str2Bytes=t.hex2ArrayBuffer=t.ab2hex=t.ab2hexLimit=void 0,t.ab2hexLimit=function(e,t){return e?"string"==typeof e?e:Array.prototype.map.call(new Uint8Array(e.slice(0,t)),(function(e){return("00"+e.toString(16)).slice(-2)})).join(""):""},t.ab2hex=function(e,t){if(!e)return"";if("string"==typeof e)return e;var n=Array.prototype.map.call(new Uint8Array(e),(function(e){return("00"+e.toString(16)).slice(-2)}));if(t){for(var r=[],i=0;i<n.length;i++)r.push(n[n.length-1-i]);return r.join("")}return n.join("")},t.hex2ArrayBuffer=function(e){var t=n(e);if(!t)throw new Error("hex2ArrayBuffer error");for(var r=new ArrayBuffer(t.length),i=new DataView(r),o=0;o<t.length;o++)i.setUint8(o,t[o]);return r},t.str2Bytes=n,t.formatWithZero=r,t.appendBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},t.mergeBuffer=function(e,t){var n=new ArrayBuffer(t),r=new DataView(n),i=0;return e.forEach((function(e){for(var n=new DataView(e),o=0;o<e.byteLength&&i<t;o++)r.setUint8(i,n.getUint8(o)),i++})),n},t.fill=function(e){return"0000".concat(e,"-0000-1000-8000-00805F9B34FB")},t.getCRC32ForAlice=function(e){var t=4294967295;0===i.length&&o();for(var n=e.byteLength,r=new DataView(e),a=0;a<n;a++){var c=Math.floor((t^r.getUint8(a))>>>0&255),u=t>>>8;t=(i[c]^u)>>>0}return~t>>>0},t.getCRCResult=function(e){var t=n(e.replace(/ /g,""));if(!t)throw new Error("getCRCResult error");var i=c(t).toString(16);return r(i,8)};var i=[];function o(){var e,t,n;for(t=0;t<256;t++){for(e=t,n=0;n<8;n++)1==(1&e)?e=3988292384^e>>>1:e>>>=1;i.push(e>>>0)}}function a(e,t){if(!e)return null;var n=[],r=e.byteLength;if(r>t){for(var i=0;i<r-t;){var o=e.slice(i,i+t);n.push(o),i+=t}var a=e.slice(i,i+t);n.push(a)}else n.push(e);return n}function c(e){var t=0;0===i.length&&o();for(var n=e.length,r=0;r<n;r++){var a=parseInt((t^e[r])>>>0&255,10),c=t>>>8;t=(i[a]^c)>>>0}return t}t.getBitValue=function(e,t){return 1==(1&e>>t)},t.subUUID=function(e){return e&&e.length>8?e.toString().substring(4,8):e},t.toUtf8String=function e(t){try{if(t.byteLength>4096){var n=a(t,4096);if(!n)throw new Error("toUtf8String error");for(var r=[],i=0;i<n.length;i++)r.push(e(n[i]));return r.join("")}return String.fromCharCode.apply(null,Array.from(new Uint8Array(t)))}catch(e){return console.error("字符串转换失败"+e,e),""}},t.toArrayWithSize=a,t.getCRC32=c},4349:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.setLogger=t.setPrintWrite=t.isPrintWrite=t.setPrintValueChange=t.isPrintValueChange=t.Logger=void 0;var i=function(){function e(){}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift(u()),console.debug.apply(console,r([],n(e),!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift(u()),console.info.apply(console,r([],n(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift(u()),console.warn.apply(console,r([],n(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift(u()),console.error.apply(console,r([],n(e),!1))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift(u()),console.info.apply(console,r([],n(e),!1))},e}();t.Logger=i;var o={printValueChange:!0,printWrite:!0},a=new i;function c(e){var t=e.toString();return t[1]?t:"0"+t}function u(){var e=new Date;return"["+[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()].map(c).join(":")+"]"}t.isPrintValueChange=function(){return o.printValueChange},t.setPrintValueChange=function(e){o.printValueChange=e},t.isPrintWrite=function(){return o.printWrite},t.setPrintWrite=function(e){o.printWrite=e},t.setLogger=function(e){a=e},t.default=new Proxy({},{get:function(e,t){return a[t]}})},6493:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.getMethod=void 0,t.getMethod=function(e,t){return function(){for(var i,o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return(i=e())[t].apply(i,r([],n(o),!1))}}},1297:function(e){e.exports={nested:{AlarmMessage_t:{fields:{AlarmEnable:{type:"uint32",id:1},AlarmId:{type:"uint32",id:2},AlarmState:{type:"uint32",id:3},AlarmName:{type:"string",id:4},AlarmTime:{type:"uint32",id:5},AlarmLaterEnable:{type:"uint32",id:6},AlarmLaterTime:{type:"uint32",id:7},AlarmCycleMaskFlag:{type:"uint32",id:8},AlarmShakeDuration:{type:"uint32",id:9},AlarmSmartWakeup:{type:"uint32",id:10}}},AlarmMessageCacheData_t:{fields:{Data:{rule:"repeated",type:"AlarmMessage_t",id:1}}}}}},608:function(e){e.exports={nested:{bindInfo_t:{fields:{isBond:{type:"bool",id:1},timestamp:{type:"uint32",id:2},account:{type:"string",id:3},mac:{type:"bytes",id:4},masterMac:{type:"bytes",id:5}}},bindReq_t:{fields:{account:{type:"string",id:1},masterMac:{type:"bytes",id:2}}},bindReqAck_t:{fields:{BindReqAck:{type:"uint32",id:1}}},bindConfirm_t:{fields:{bindConfirm:{type:"uint32",id:1}}},bindResult_t:{fields:{bindResult:{type:"bool",id:1},errorMsg:{type:"string",id:2}}},unbindReq_t:{fields:{account:{type:"string",id:1}}}}}},2587:function(e){e.exports={nested:{connectNegotiationParm_t:{fields:{maxTransimissionUnit:{type:"uint32",id:1}}},time_t:{fields:{timestamp:{type:"uint32",id:1},timezone:{type:"int32",id:2},timezoneCity:{type:"string",id:3},timeFormat:{type:"uint32",id:4},dateFormat:{type:"uint32",id:5}}},DeviceLanguageSet_t:{fields:{local:{type:"string",id:1},language:{type:"string",id:2}}},device_info_t:{fields:{deviceType:{type:"uint32",id:1},deviceHardVersion:{type:"string",id:2},deviceSoftVersion:{type:"string",id:3},deviceSn:{type:"string",id:4},deviceModel:{type:"string",id:5},deviceName:{type:"string",id:6},sku:{type:"string",id:7}}},battery_info_t:{fields:{batteryPercent:{type:"uint32",id:1}}},AutoLightScreenAndHandGet_t:{fields:{HandSet:{type:"uint32",id:1},AutoLightScreenSw:{type:"uint32",id:2},AutoLightScreenTime:{rule:"repeated",type:"TimeRange_t",id:3}}},TimeRange_t:{fields:{StartTime:{type:"uint32",id:1},EndTime:{type:"uint32",id:2}}},NightModeGet_t:{fields:{NightModeSw:{type:"uint32",id:1},TimeSets:{rule:"repeated",type:"TimeRange_t",id:2}}},NightModeSet_t:{fields:{NightModeSw:{type:"uint32",id:1},TimeSets:{rule:"repeated",type:"TimeRange_t",id:2}}},UeStateRequireSet_t:{fields:{UeState:{type:"uint32",id:1}}},MenuShow_t:{fields:{AllMenuList:{type:"bytes",id:1},ShowMenuList:{type:"bytes",id:2}}},EventDisc_t:{fields:{EventID:{type:"uint32",id:1},EventTime:{type:"uint32",id:2},EventParaStr:{rule:"optional",type:"string",id:3},EventParaUint:{rule:"optional",type:"uint32",id:4}}},findPhone_t:{fields:{status:{type:"uint32",id:1}}}}}},6538:function(e){e.exports={nested:{ErrorCode_t:{fields:{ErrorCode:{type:"uint32",id:1}}}}}},7107:function(e){e.exports={nested:{FileSendRequest_t:{fields:{taskId:{type:"uint32",id:1},fileType:{type:"uint32",id:2},fileName:{type:"string",id:3},fileSize:{type:"uint32",id:6},md5:{type:"bytes",id:7}}},FileSendResponse:{fields:{taskId:{type:"uint32",id:1},errorCode:{type:"uint32",id:2},recievedSize:{type:"uint32",id:3}}},fileChunkSendRequest:{fields:{taskId:{type:"uint32",id:1},index:{type:"uint32",id:2},content:{type:"bytes",id:3}}},fileChunkSendResponse:{fields:{taskId:{type:"uint32",id:1},errorCode:{type:"uint32",id:2}}},fileSendComplete_t:{fields:{taskId:{type:"uint32",id:1},errorCode:{type:"uint32",id:2}}},fileSendCancel_t:{fields:{taskId:{type:"uint32",id:1},errorCode:{type:"uint32",id:2}}},getFlieRequest_t:{fields:{filename:{type:"string",id:1},fileType:{type:"uint32",id:2}}},getFlieListReqRsp_t:{fields:{fileType:{type:"uint32",id:1},fileList:{rule:"repeated",type:"string",id:2},errorCode:{type:"uint32",id:3}}}}}},5719:function(e){e.exports={nested:{HrData_t:{options:{"(nanopb_msgopt).max_size":60},fields:{HrValue:{type:"bytes",id:1},Reliability:{type:"bytes",id:2},Type:{type:"bytes",id:3}}},HrDataPacket_t:{fields:{StartTime:{type:"uint32",id:1},TimeInterval:{type:"uint32",id:2},HrData:{type:"HrData_t",id:3}}},Spo2Data_t:{options:{"(nanopb_msgopt).max_size":60},fields:{Spo2Value1:{type:"bytes",id:1},Reliability1:{type:"bytes",id:2},Spo2Value2:{type:"bytes",id:3},Reliability2:{type:"bytes",id:4}}},Spo2DataPacket_t:{fields:{StartTime:{type:"uint32",id:1},TimeInterval:{type:"uint32",id:2},Spo2Data:{type:"Spo2Data_t",id:3}}},SleepData_t:{options:{"(nanopb_msgopt).max_size":60},fields:{SleepStatus:{type:"bytes",id:1}}},SleepDataPacket_t:{fields:{StartTime:{type:"uint32",id:1},TimeInterval:{type:"uint32",id:2},SleepData:{type:"SleepData_t",id:3}}},SleepReport_t:{options:{"(nanopb_msgopt).max_size":1470},fields:{valid:{type:"bool",id:1},fallSleep:{type:"uint32",id:2},sleepOut:{type:"uint32",id:3},REM:{type:"uint32",id:4},lightSleep:{type:"uint32",id:5},deepSleep:{type:"uint32",id:6},sleepScore:{type:"int32",id:7},sleepGrade:{type:"uint32",id:8},fallSleepSpend:{type:"uint32",id:9},exceptionHrs:{rule:"repeated",type:"exceptionHr_t",id:10,options:{"(nanopb).max_count":10}},hourApneas:{rule:"repeated",type:"apnea_t",id:11,options:{"(nanopb).max_count":24}},sleepDetail:{type:"bytes",id:12}}},apnea_t:{fields:{hour:{type:"uint32",id:1},times:{type:"uint32",id:2}}},exceptionHr_t:{fields:{timestamp:{type:"uint32",id:1},duration:{type:"uint32",id:2}}},DayActiveData_t:{fields:{DayUtc:{type:"uint32",id:1},DayCalorie:{type:"uint32",id:2},DayStep:{type:"uint32",id:3},DayDistance:{type:"uint32",id:4}}},ActiveData_t:{fields:{Utc:{type:"uint32",id:1},Calorie:{type:"uint32",id:2},Step:{type:"uint32",id:3},Distance:{type:"uint32",id:4},ExerciseTime:{type:"uint32",id:5},HighStrengthDuration:{type:"uint32",id:6},MiddleStrengthDuration:{type:"uint32",id:7},StandState:{type:"bool",id:8},WearState:{type:"bool",id:9},EffectiveActivityTime:{type:"uint32",id:10}}},ActiveDataPacket_t:{fields:{Interval:{type:"uint32",id:1},ActiveData:{rule:"repeated",type:"ActiveData_t",id:2,options:{"(nanopb).max_count":60}}}},History7DayData_t:{fields:{DayUtc:{type:"uint32",id:1},DayCalorie:{type:"uint32",id:2},DayStep:{type:"uint32",id:3},DayDistance:{type:"uint32",id:4},DayStandDetail:{type:"uint32",id:5},DayWakeupHr:{type:"uint32",id:6},DayExerciseTime:{type:"uint32",id:7}}},RESTING_HR_DATA_t:{fields:{RestingUtc:{type:"uint32",id:1},RestingSpo2:{type:"uint32",id:2},RestingHr:{type:"uint32",id:3}}}}}},4288:function(e){e.exports={nested:{HrSwitch_t:{fields:{HrSwitch:{type:"uint32",id:1},HrInterval:{type:"uint32",id:2},HrDailyWarnEn:{type:"uint32",id:3},HrDailyWarnVal:{type:"uint32",id:4},HrSportWarnEn:{type:"uint32",id:5},HrSportWarnVal:{type:"uint32",id:6}}},Spo2Switch_t:{fields:{Spo2Type:{type:"uint32",id:1},Spo2Switch:{type:"uint32",id:2},Spo2Interval:{type:"uint32",id:3}}},FallAsleepRemindSet_t:{fields:{RemindSwitch:{type:"uint32",id:1},RemindTime:{type:"uint32",id:2},RemindCycleMaskFlag:{type:"uint32",id:3}}},SleepSchedule_t:{fields:{SleepDuration:{type:"uint32",id:1},SleepStartTime:{type:"uint32",id:2},SleepEndTime:{type:"uint32",id:3},FallAsleepRemindSet:{type:"FallAsleepRemindSet_t",id:4},SleepReportSwitch:{type:"uint32",id:5}}},SleepSwitch_t:{fields:{SleepSwitch:{type:"uint32",id:1},SleepScheduleEn:{type:"bool",id:2},SleepSchedule:{type:"SleepSchedule_t",id:3}}},SedentaryReminder_t:{fields:{Enable:{type:"uint32",id:1},ThresholdValue:{type:"ThresholdValue_t",id:2},TimeSets:{rule:"repeated",type:"TimeRange_t",id:3}}},ThresholdValue_t:{fields:{Duration:{type:"uint32",id:1},Step:{type:"uint32",id:2}}},TimeRange_t:{fields:{StartTime:{type:"uint32",id:1},EndTime:{type:"uint32",id:2}}},RecordData_t:{fields:{DataType:{type:"uint32",id:1},RecordType:{type:"uint32",id:2}}},sleepReport_t:{options:{"(nanopb_msgopt).max_size":1470},fields:{valid:{type:"bool",id:1},fallSleep:{type:"uint32",id:2},sleepOut:{type:"uint32",id:3},REM:{type:"uint32",id:4},lightSleep:{type:"uint32",id:5},deepSleep:{type:"uint32",id:6},sleepScore:{type:"int32",id:7},sleepGrade:{type:"uint32",id:8},fallSleepSpend:{type:"uint32",id:9},exceptionHrs:{rule:"repeated",type:"exceptionHr_t",id:10,options:{"(nanopb).max_count":10}},hourApneas:{rule:"repeated",type:"apnea_t",id:11,options:{"(nanopb).max_count":24}},sleepDetail:{type:"bytes",id:12}}},apnea_t:{fields:{hour:{type:"uint32",id:1},times:{type:"uint32",id:2}}},exceptionHr_t:{fields:{timestamp:{type:"uint32",id:1},duration:{type:"uint32",id:2}}},SleepModeConfig_t:{fields:{isSet:{type:"bool",id:1},autoEnable:{type:"bool",id:2}}},WomenHealthConf_t:{fields:{mIsSet:{type:"bool",id:1},startTime:{type:"uint32",id:2},period:{type:"uint32",id:3},cycle:{type:"uint32",id:4}}},WomenHealthNotifySw_t:{fields:{isSet:{type:"bool",id:1},mensRemind:{type:"bool",id:2},ovulationRemind:{type:"bool",id:3}}},sportHrSectionCfg_t:{fields:{isSet:{type:"bool",id:1},hrSections:{rule:"repeated",type:"hrSection_t",id:2}}},hrSection_t:{fields:{min:{type:"uint32",id:1},max:{type:"uint32",id:2}}},pressureStatusReport_t:{fields:{status:{type:"uint32",id:1},pressureList:{rule:"repeated",type:"pressureStatus_t",id:2}}},pressureStatus_t:{fields:{timestamp:{type:"uint32",id:1},pressure:{type:"uint32",id:2}}},pressureStatusReq_t:{fields:{status:{type:"uint32",id:1}}}}}},7250:function(e,t,n){"use strict";n.r(t),n.d(t,{alarm:function(){return r},bind:function(){return i},deviceinfo:function(){return o},error:function(){return a},file:function(){return c},filerecard:function(){return u},health:function(){return s},music:function(){return l},notification:function(){return f},setting:function(){return d},sport:function(){return p},userinfo:function(){return h},watchface:function(){return v},weather:function(){return y}});var r=n(1297),i=n(608),o=n(2587),a=n(6538),c=n(7107),u=n(5719),s=n(4288),l=n(2406),f=n(389),d=n(8087),p=n(3701),h=n(3986),v=n(2339),y=n(7149)},2406:function(e){e.exports={nested:{MusicControlAction:{fields:{musicControlActionType:{type:"int32",id:1}}},TotalInfo:{fields:{playInfo:{type:"PlayInfo",id:1},playState:{type:"PlayState",id:2},volumeInfo:{type:"VolumeInfo",id:3},timeInfo:{type:"TimeInfo",id:4}}},PlayInfo:{fields:{musicTitle:{type:"string",id:1},musicArtist:{type:"string",id:2},musicAlbum:{type:"string",id:3},musicPackageName:{type:"string",id:4},musicAppName:{type:"string",id:5}}},PlayState:{fields:{playStateType:{type:"int32",id:1}}},VolumeInfo:{fields:{currentVolume:{type:"int32",id:1},maxVolume:{type:"int32",id:2}}},TimeInfo:{fields:{currentTime:{type:"uint32",id:1},totleTime:{type:"uint32",id:2}}},ControlSwitchInfo:{fields:{controlSwitch:{type:"uint32",id:1}}}}}},389:function(e){e.exports={nested:{NotificationSwitch_t:{fields:{MsgTotalSwitch:{type:"uint32",id:1},MsgSubSwitch:{rule:"repeated",type:"NotificationSubSwitch_t",id:2}}},NotificationSubSwitch_t:{fields:{MsgType:{type:"uint32",id:1},MsgSwitch:{type:"uint32",id:2}}},NotificationPostedText_t:{fields:{MsgId:{type:"uint32",id:1},MsgType:{type:"uint32",id:2},MsgPkgName:{type:"string",id:3},MsgUserDefined:{type:"string",id:4},MsgTitle:{type:"string",id:5},MsgContent:{type:"string",id:6},PostTime:{type:"uint32",id:7},MsgAppName:{type:"string",id:8},PhoneState:{type:"uint32",id:9},HasRemoteInput:{type:"bool",id:10}}},NotificationPostedPic_t:{fields:{CmdId:{type:"uint32",id:1},MsgId:{type:"uint32",id:2},MsgtType:{type:"uint32",id:3},MsgPkgName:{type:"string",id:4},MsgTag:{type:"string",id:5},CompressType:{type:"uint32",id:6},PicPixelH:{type:"uint32",id:7},PicPixelV:{type:"uint32",id:8},PicSize:{type:"uint32",id:9},PicType:{type:"uint32",id:10},PostTime:{type:"uint32",id:11},MsgAppName:{type:"string",id:12},PhoneState:{type:"uint32",id:13},HasRemoteInput:{type:"bool",id:14}}},NotificationReply_t:{fields:{MsgId:{type:"uint32",id:1},MsgType:{type:"uint32",id:2},MsgPkgName:{type:"string",id:3},MsgTag:{type:"string",id:4},ReplyText:{type:"string",id:5}}},NotificationRemoved_t:{fields:{MsgId:{type:"uint32",id:1},MsgType:{type:"uint32",id:2},MsgPkgName:{type:"string",id:3},MsgTag:{type:"string",id:4},RemoveAll:{type:"uint32",id:5}}},PhoneCallChange_t:{fields:{ChangeStatus:{type:"int32",id:1},CallRemoteNumber:{type:"string",id:2},DisconnectCause:{type:"int32",id:3},IsContactCall:{type:"bool",id:4},DisplayName:{type:"string",id:5}}}}}},8087:function(e){e.exports={nested:{AutoLightScreenAndHandGet_t:{fields:{HandSet:{type:"uint32",id:0},AutoLightScreenSw:{type:"uint32",id:1},AutoLightScreenTime:{rule:"repeated",type:"TimeRange_t",id:2}}},TimeRange_t:{fields:{StartTime:{type:"uint32",id:1},EndTime:{type:"uint32",id:2}}},NightModeGet_t:{fields:{NightModeSw:{type:"uint32",id:1},TimeSets:{rule:"repeated",type:"TimeRange_t",id:2}}},UeStateRequireGet_t:{fields:{UeState:{type:"uint32",id:1}}},MenuShow_t:{fields:{AllMenuList:{type:"bytes",id:1},ShowMenuList:{type:"bytes",id:2}}}}}},3701:function(e){e.exports={nested:{TodayActiveGoalGet_t:{fields:{GoalSw:{type:"uint32",id:1},GoalItem:{rule:"repeated",type:"GoalContent_t",id:2}}},GoalContent_t:{fields:{SubType:{type:"uint32",id:1},SubSw:{type:"uint32",id:2},SubValue:{type:"uint32",id:3}}},SportDetectionGet_t:{fields:{Sw:{type:"uint32",id:1},Item:{type:"ItemContent_t",id:2}}},ItemContent_t:{fields:{SubType:{type:"uint32",id:1},SubSw:{type:"uint32",id:2}}},SportAutoPauseStopGet_t:{fields:{AutoPauseSw:{type:"uint32",id:1},AutoPauseTimeSet:{type:"uint32",id:2},AutoStopTimeSet:{type:"uint32",id:3}}},TodayActiveTotalGet_t:{fields:{DayUtc:{type:"uint32",id:1},DayCalorie:{type:"uint32",id:2},DayStep:{type:"uint32",id:3},DayDistance:{type:"uint32",id:4},DayExercise:{type:"uint32",id:5},DayActivityCount:{type:"uint32",id:6},HighStrengthDuration:{type:"uint32",id:7},MiddleStrengthDuration:{type:"uint32",id:8},DayStandDetail:{type:"uint32",id:9},WakeupHr:{type:"uint32",id:10},DayWearDetail:{type:"uint32",id:11},WeekHighStrength:{type:"uint32",id:12},WeekMiddleStrength:{type:"uint32",id:13},HourActiveData:{type:"HourActiveData_t",id:14},DayExerciseTime:{type:"uint32",id:15}}},HourActiveData_t:{fields:{Calorie:{type:"uint32",id:1},Step:{type:"uint32",id:2},Distance:{type:"uint32",id:3},ExerciseTime:{type:"uint32",id:4},HighStrengthDuration:{type:"uint32",id:5},MiddleStrengthDuration:{type:"uint32",id:6},StandState:{type:"bool",id:7},WearState:{type:"bool",id:8}}},SportDescription_t:{fields:{StartTime:{type:"uint32",id:1},EndTime:{type:"uint32",id:2},SportIds:{rule:"repeated",type:"string",id:3}}},SportDetail_t:{fields:{SportIds:{type:"string",id:1}}},GpsSwitch_t:{fields:{GpsEnable:{type:"uint32",id:1},TimeOut:{type:"uint32",id:2},Interval:{type:"uint32",id:3},trackID:{type:"string",id:4}}},GpsLocationRsp_t:{fields:{StateCode:{type:"uint32",id:1},TimesTamp:{type:"uint32",id:2},Speed:{type:"double",id:3},InvertSpeed:{type:"double",id:4},Altitude:{type:"int32",id:5},Distance:{type:"float",id:6},Longitude:{type:"uint32",id:7},Latitude:{type:"uint32",id:8},Precision:{type:"uint32",id:9}}},activityStrength_t:{fields:{sportType:{type:"uint32",id:1},midActivityTime:{type:"uint32",id:2},highActivityTime:{type:"uint32",id:3}}},activityStrengthDetail_t:{fields:{activityStrengths:{rule:"repeated",type:"activityStrength_t",id:1}}},SportDetailPacket_t:{fields:{StartTime:{type:"uint32",id:1},TimeInterval:{type:"uint32",id:2},SportDetailData:{rule:"repeated",type:"DetailData_t",id:3}}},DetailData_t:{fields:{Pace:{type:"unit16",id:1},Hr:{type:"unit16",id:2},Frequency:{type:"unit16",id:3},Step:{type:"unit16",id:4},Distance:{type:"unit16",id:5},Cal:{type:"unit8",id:6},State:{type:"unit8",id:7}}},GpsLocation_t:{fields:{StateCode:{type:"uint32",id:1},TimesTamp:{type:"uint32",id:2},Speed:{type:"double",id:3},InvertSpeed:{type:"double",id:4},Altitude:{type:"int32",id:5},Distance:{type:"float",id:6},Longitude:{type:"uint32",id:7},latitude:{type:"uint32",id:8},precision:{type:"uint32",id:9}}},GpsDetailPacket_t:{fields:{GpsDetailData:{rule:"repeated",type:"DetailGps_t",id:1}}},DetailGps_t:{fields:{utc:{type:"uint32",id:1},longitude:{type:"uint32",id:2},latitude:{type:"uint32",id:3},state:{type:"uint8",id:4}}}}}},3986:function(e){e.exports={nested:{UserInfo_t:{fields:{Weight:{type:"uint32",id:1},Height:{type:"uint32",id:2},Birthday:{type:"uint32",id:3},Age:{type:"uint32",id:4},Gender:{type:"uint32",id:5},NickName:{type:"string",id:6}}}}}},2339:function(e){e.exports={nested:{pushWatchface_t:{fields:{watchface:{type:"watchface_t",id:1},index:{type:"uint32",id:2}}},pushStatus_t:{fields:{watchfaceId:{type:"string",id:1},status:{type:"uint32",id:2},errorCode:{type:"uint32",id:3}}},deleteWatchface_t:{fields:{watchfaceIds:{rule:"repeated",type:"string",id:1}}},watchfaceCapacity_t:{fields:{supportVersion:{type:"uint32",id:1},capacity:{type:"uint32",id:2},resolution:{type:"resolution_t",id:3},maxFilesize:{type:"uint32",id:4}}},resolution_t:{fields:{width:{type:"uint32",id:1},height:{type:"uint32",id:2}}},watchface_summary_t:{fields:{watchfaceIds:{rule:"repeated",type:"string",id:3},choosed:{type:"string",id:4}}},watchface_req_t:{fields:{watchfaceId:{type:"string",id:1}}},watchface_t:{fields:{watchfaceId:{type:"string",id:1},type:{type:"uint32",id:2},fileName:{type:"string",id:3},fileSize:{type:"uint32",id:4},version:{type:"uint32",id:5},formatVersion:{type:"uint32",id:6},visual:{type:"visual_t",id:7},city:{type:"city_t",id:8}}},visual_t:{fields:{backgrounds:{rule:"repeated",type:"string",id:1},styleId:{type:"uint32",id:2}}},city_t:{fields:{timezone:{type:"int32",id:1},name:{type:"string",id:2}}},sortWatchface_t:{fields:{watchfaceIds:{rule:"repeated",type:"string",id:1},choosed:{type:"string",id:2}}},syncChoosedWatchface_t:{fields:{choosedIdx:{type:"uint32",id:1},choosedID:{type:"string",id:2}}}}}},7149:function(e){e.exports={nested:{WeatherPush_t:{fields:{weatherInfo:{rule:"repeated",type:"WeatherInfo_t",id:1}}},WeatherInfo_t:{fields:{cityName:{type:"string",id:1},weatherType:{type:"uint32",id:2},temp:{type:"uint32",id:3},realFeelTemp:{type:"uint32",id:4},windPower:{type:"uint32",id:5},windDegrees:{type:"uint32",id:6},uvClass:{type:"uint32",id:7},uvIndex:{type:"uint32",id:8},humidity:{type:"uint32",id:9},visibility:{type:"uint32",id:10},pressure:{type:"uint32",id:11},rainProbability:{type:"uint32",id:12},sunriseTime:{type:"uint32",id:13},sunsetTime:{type:"uint32",id:14},avgPm25:{type:"uint32",id:15},avgAqi:{type:"uint32",id:16},hourlyWeather:{rule:"repeated",type:"HourlyWeather_t",id:17},dailyWeather:{rule:"repeated",type:"DailyWeather_t",id:18},updatedUTC:{type:"uint32",id:19},weatherTypeDefine:{type:"uint32",id:20}}},HourlyWeather_t:{fields:{hour:{type:"uint32",id:1},temp:{type:"int32",id:2},weatherType:{type:"uint32",id:3}}},DailyWeather_t:{fields:{weatherType:{type:"uint32",id:1},highTemp:{type:"int32",id:2},lowTemp:{type:"int32",id:3},sunriseTime:{type:"uint32",id:4},sunsetTime:{type:"uint32",id:5}}}}}},1795:function(e,t,n){"use strict";n.r(t);var r=n(7934),i=n.n(r);t.default={decodePb:function(e,t,n){return i().Root.fromJSON(e).lookupType(t).decode(n)},encodePb:function(e,t,n){t=t.trim();let r=i().Root.fromJSON(e).lookupType(t),o=r.create(n);return r.encode(o).finish()}}},7934:function(e,t,n){e.exports=function(){function e(){t.converter._configure(),t.decoder._configure(),t.encoder._configure(),t.Field._configure(),t.MapField._configure(),t.Message._configure(),t.Namespace._configure(),t.Method._configure(),t.ReflectionObject._configure(),t.OneOf._configure(),t.parse._configure(),t.Reader._configure(),t.Root._configure(),t.Service._configure(),t.verifier._configure(),t.Type._configure(),t.types._configure(),t.wrappers._configure(),t.Writer._configure()}var t={build:"minimal"};if(t.Writer=n(372),t.encoder=n(9909),t.Reader=n(9384),t.util=n(3472),t.rpc=n(6427),t.roots=n(789),t.verifier=n(4235),t.tokenize=n(6448),t.parse=n(7965),t.common=n(9290),t.ReflectionObject=n(5988),t.Namespace=n(8909),t.Root=n(4902),t.Enum=n(343),t.Type=n(8529),t.Field=n(7255),t.OneOf=n(4543),t.MapField=n(4357),t.Service=n(6007),t.Method=n(5467),t.converter=n(9904),t.decoder=n(7285),t.Message=n(1912),t.wrappers=n(5785),t.types=n(5360),t.util=n(3472),t.configure=e,t.load=function(e,n,r){return"function"==typeof n?(r=n,n=new t.Root):!n&&(n=new t.Root),n.load(e,r)},t.loadSync=function(e,n){return n||(n=new t.Root),n.loadSync(e)},t.parseFromPbString=function(e,n,r){return"function"==typeof n?(r=n,n=new t.Root):!n&&(n=new t.Root),n.parseFromPbString(e,r)},e(),arguments&&arguments.length)for(var r,i=0;i<arguments.length;i++)if((r=arguments[i]).hasOwnProperty("exports"))return void(r.exports=t);return t}()},4344:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},9535:function(e){"use strict";e.exports=function(e,t){for(var n=Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}},5599:function(e){"use strict";var t=e.exports;t.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;1<--t%4&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var n=Array(64),r=Array(123),i=0;64>i;)r[n[i]=26>i?i+65:52>i?i+71:62>i?i-4:43|i-59]=i++;t.encode=function(e,t,r){for(var i,o,a=String.fromCharCode,c=null,u=[],s=0,l=0;t<r;)o=e[t++],0===l?(u[s++]=n[o>>2],i=(3&o)<<4,l=1):1===l?(u[s++]=n[i|o>>4],i=(15&o)<<2,l=2):2===l&&(u[s++]=n[i|o>>6],u[s++]=n[63&o],l=0),8191<s&&((c||(c=[])).push(a.apply(String,u)),s=0);return l&&(u[s++]=n[i],u[s++]=61,1===l&&(u[s++]=61)),c?(s&&c.push(a.apply(String,u.slice(0,s))),c.join("")):a.apply(String,u.slice(0,s))};var o="invalid encoding";t.decode=function(e,t,n){for(var i,a,c=n,u=0,s=0;s<e.length&&!(61===(a=e.charCodeAt(s++))&&1<u);){if(void 0===(a=r[a]))throw Error(o);0===u?(i=a,u=1):1===u?(t[n++]=i<<2|(48&a)>>4,i=a,u=2):2===u?(t[n++]=(15&i)<<4|(60&a)>>2,i=a,u=3):3===u&&(t[n++]=(3&i)<<6|a,u=0)}if(1===u)throw Error(o);return n-c},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},9290:function(e){e.exports=r;var t,n=/\/|\./;function r(e,t){n.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),r[e]=t}r("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),r("duration",{Duration:t={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),r("timestamp",{Timestamp:t}),r("empty",{Empty:{fields:{}}}),r("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),r("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),r("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),r.get=function(e){return r[e]||null}},9904:function(e,t,n){var r,i,o=e.exports;function a(e,t,n,o){var a=o.m,c=o.d,u=o.types,s=o.ksi,l=void 0!==s;if(e.resolvedType)if(e.resolvedType instanceof r){for(var f=l?c[n][s]:c[n],d=e.resolvedType.values,p=Object.keys(d),h=0;h<p.length;h++)if(!(e.repeated&&d[p[h]]===e.typeDefault||p[h]!=f&&d[p[h]]!=f)){l?a[n][s]=d[p[h]]:a[n]=d[p[h]];break}}else{if("object"!=typeof(l?c[n][s]:c[n]))throw TypeError(e.fullName+": object expected");l?a[n][s]=u[t].fromObject(c[n][s]):a[n]=u[t].fromObject(c[n])}else{var v=!1;switch(e.type){case"double":case"float":l?a[n][s]=+c[n][s]:a[n]=+c[n];break;case"uint32":case"fixed32":l?a[n][s]=c[n][s]>>>0:a[n]=c[n]>>>0;break;case"int32":case"sint32":case"sfixed32":l?a[n][s]=0|c[n][s]:a[n]=0|c[n];break;case"uint64":v=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":i.Long?l?a[n][s]=i.Long.fromValue(c[n][s]).unsigned=v:a[n]=i.Long.fromValue(c[n]).unsigned=v:"string"==typeof(l?c[n][s]:c[n])?l?a[n][s]=parseInt(c[n][s],10):a[n]=parseInt(c[n],10):"number"==typeof(l?c[n][s]:c[n])?l?a[n][s]=c[n][s]:a[n]=c[n]:"object"==typeof(l?c[n][s]:c[n])&&(l?a[n][s]=new i.LongBits(c[n][s].low>>>0,c[n][s].high>>>0).toNumber(v):a[n]=new i.LongBits(c[n].low>>>0,c[n].high>>>0).toNumber(v));break;case"bytes":"string"==typeof(l?c[n][s]:c[n])?l?i.base64.decode(c[n][s],a[n][s]=i.newBuffer(i.base64.length(c[n][s])),0):i.base64.decode(c[n],a[n]=i.newBuffer(i.base64.length(c[n])),0):(l?c[n][s]:c[n]).length&&(l?a[n][s]=c[n][s]:a[n]=c[n]);break;case"string":l?a[n][s]=c[n][s]+"":a[n]=c[n]+"";break;case"bool":l?a[n][s]=!!c[n][s]:a[n]=!!c[n]}}}function c(e,t,n,o){var a=o.m,c=o.d,u=o.types,s=o.ksi,l=o.o,f=void 0!==s;if(e.resolvedType)e.resolvedType instanceof r?f?c[n][s]=l.enums===String?u[t].values[a[n][s]]:a[n][s]:c[n]=l.enums===String?u[t].values[a[n]]:a[n]:f?c[n][s]=u[t].toObject(a[n][s],l):c[n]=u[t].toObject(a[n],l);else{var d=!1;switch(e.type){case"double":case"float":f?c[n][s]=l.json&&!isFinite(a[n][s])?a[n][s]+"":a[n][s]:c[n]=l.json&&!isFinite(a[n])?a[n]+"":a[n];break;case"uint64":d=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":"number"==typeof a[n][s]?f?c[n][s]=l.longs===String?a[n][s]+"":a[n][s]:c[n]=l.longs===String?a[n]+"":a[n]:f?c[n][s]=l.longs===String?i.Long.prototype.toString.call(a[n][s]):l.longs===Number?new i.LongBits(a[n][s].low>>>0,a[n][s].high>>>0).toNumber(d):a[n][s]:c[n]=l.longs===String?i.Long.prototype.toString.call(a[n]):l.longs===Number?new i.LongBits(a[n].low>>>0,a[n].high>>>0).toNumber(d):a[n];break;case"bytes":f?c[n][s]=l.bytes===String?i.base64.encode(a[n][s],0,a[n][s].length):l.bytes===Array?Array.prototype.slice.call(a[n][s]):a[n][s]:c[n]=l.bytes===String?i.base64.encode(a[n],0,a[n].length):l.bytes===Array?Array.prototype.slice.call(a[n]):a[n];break;default:f?c[n][s]=a[n][s]:c[n]=a[n]}}}o._configure=function(){r=n(343),i=n(3472)},o.fromObject=function(e){var t=e.fieldsArray;return function(e){return function(n){if(n instanceof this.ctor)return n;if(!t.length)return new this.ctor;for(var o=new this.ctor,c=0;c<t.length;++c){var u,s=t[c].resolve(),l=s.name;if(s.map){if(n[l]){if("object"!=typeof n[l])throw TypeError(s.fullName+": object expected");o[l]={}}var f=Object.keys(n[l]);for(u=0;u<f.length;++u)a(s,c,l,i.merge(i.copy(e),{m:o,d:n,ksi:f[u]}))}else if(s.repeated){if(n[l]){if(!Array.isArray(n[l]))throw TypeError(s.fullName+": array expected");for(o[l]=[],u=0;u<n[l].length;++u)a(s,c,l,i.merge(i.copy(e),{m:o,d:n,ksi:u}))}}else(s.resolvedType instanceof r||null!=n[l])&&a(s,c,l,i.merge(i.copy(e),{m:o,d:n}))}return o}}},o.toObject=function(e){var t=e.fieldsArray.slice().sort(i.compareFieldsById);return function(n){return t.length?function(o,a){var u=String.fromCharCode;a=a||{};for(var s,l,f={},d=[],p=[],h=[],v=0;v<t.length;++v)t[v].partOf||(t[v].resolve().repeated?d:t[v].map?p:h).push(t[v]);if(d.length&&(a.arrays||a.defaults))for(v=0;v<d.length;++v)f[d[v].name]=[];if(p.length&&(a.objects||a.defaults))for(v=0;v<p.length;++v)f[p[v].name]={};if(h.length&&a.defaults)for(v=0;v<h.length;++v)if(l=(s=h[v]).name,s.resolvedType instanceof r)f[l]=a.enums=String?s.resolvedType.valuesById[s.typeDefault]:s.typeDefault;else if(s.long)if(i.Long){var y=new i.Long(s.typeDefault.low,s.typeDefault.high,s.typeDefault.unsigned);f[l]=a.longs===String?y.toString():a.longs===Number?y.toNumber():y}else f[l]=a.longs===String?s.typeDefault.toString():s.typeDefault.toNumber();else f[l]=s.bytes?a.bytes===String?u.apply(String,s.typeDefault):Array.prototype.slice.call(s.typeDefault).join("*..*").split("*..*"):s.typeDefault;var g=!1;for(v=0;v<t.length;++v){l=(s=t[v]).name;var m,b,w=e._fieldsArray.indexOf(s);if(s.map){if(g||(g=!0),o[l]&&(m=Object.keys(o[l]).length))for(f[l]={},b=0;b<m.length;++b)c(s,w,l,i.merge(i.copy(n),{m:o,d:f,ksi:m[b],o:a}))}else if(s.repeated){if(o[l]&&o[l].length)for(f[l]=[],b=0;b<o[l].length;++b)c(s,w,l,i.merge(i.copy(n),{m:o,d:f,ksi:b,o:a}))}else null!=o[l]&&o.hasOwnProperty(l)&&c(s,w,l,i.merge(i.copy(n),{m:o,d:f,o:a})),s.partOf&&a.oneofs&&(f[s.partOf.name]=l)}return f}:function(){return{}}}}},7285:function(e,t,n){var r,i,o;function a(e){return"missing required '"+e.name+"'"}function c(e){return function(t){var n=t.Reader,c=t.types,u=t.util;return function(t,s){t instanceof n||(t=n.create(t));for(var l,f=void 0===s?t.len:t.pos+s,d=new this.ctor;t.pos<f;){var p=t.uint32();if(e.group&&4==(7&p))break;for(var h=0,v=!1;h<e.fieldsArray.length;++h){var y=e._fieldsArray[h].resolve(),g=y.name,m=y.resolvedType instanceof r?"int32":y.type;if(p>>>3==y.id){if(v=!0,y.map)t.skip().pos++,d[g]===u.emptyObject&&(d[g]={}),l=t[y.keyType](),t.pos++,null==i.long[y.keyType]?null==i.basic[m]?d[g]=c[h].decode(t,t.uint32()):d[g]=t[m]():null==i.basic[m]?d[g]["object"==typeof l?u.longToHash(l):l]=c[h].decode(t,t.uint32()):d[g]["object"==typeof l?u.longToHash(l):l]=t[m]();else if(y.repeated)if(d[g]&&d[g].length||(d[g]=[]),null!=i.packed[m]&&2==(7&p))for(var b=t.uint32()+t.pos;t.pos<b;)d[g].push(t[m]());else null==i.basic[m]?y.resolvedType.group?d[g].push(c[h].decode(t)):d[g].push(c[h].decode(t,t.uint32())):d[g].push(t[m]());else d[g]=null==i.basic[m]?y.resolvedType.group?c[h].decode(t):c[h].decode(t,t.uint32()):t[m]();break}}v||t.skipType(7&p)}for(h=0;h<e._fieldsArray.length;++h){var w=e._fieldsArray[h];if(w.required&&!d.hasOwnProperty(w.name))throw o.ProtocolError(a(w),{instance:d})}return d}}}e.exports=c,c._configure=function(){r=n(343),i=n(5360),o=n(3472)}},9909:function(e,t,n){var r,i;function o(e){return function(t){var n=t.Writer,o=t.types,a=t.util;return function(t,c){c=c||n.create();for(var u=e.fieldsArray.slice().sort(a.compareFieldsById),s=0;s<u.length;s++){var l=u[s],f=e._fieldsArray.indexOf(l),d=l.resolvedType instanceof r?"uint32":l.type,p=i.basic[d],h=t[l.name];if(l.resolvedType instanceof r&&"string"==typeof h&&(h=o[f].values[h]),l.map){if(null!=h&&t.hasOwnProperty(l.name))for(var v=Object.keys(h),y=0;y<v.length;++y)c.uint32((2|l.id<<3)>>>0).fork().uint32(8|i.mapKey[l.keyType])[l.keyType](v[y]),void 0===p?o[f].encode(h[v[y]],c.uint32(18).fork()).ldelim().ldelim():c.uint32(16|p)[d](h[v[y]]).ldelim()}else if(l.repeated){if(h&&h.length)if(l.packed&&void 0!==i.packed[d]){c.uint32((2|l.id<<3)>>>0).fork();for(var g=0;g<h.length;g++)c[d](h[g]);c.ldelim()}else for(var m=0;m<h.length;m++)void 0===p?l.resolvedType.group?o[f].encode(h[m],c.uint32((3|l.id<<3)>>>0)).uint32((4|l.id<<3)>>>0):o[f].encode(h[m],c.uint32((2|l.id<<3)>>>0).fork()).ldelim():c.uint32((l.id<<3|p)>>>0)[d](h[m])}else(!l.optional||null!=h&&t.hasOwnProperty(l.name))&&(!l.optional&&(null==h||!t.hasOwnProperty(l.name))&&console.warn("注意啦!!!很大概率会报错 类型:",t.$type?t.$type.name:"不晓得","没有设置对应的属性:",l.name,"检查是不是proto文件属性设置为了required"),void 0===p?l.resolvedType.group?o[f].encode(h,c.uint32((3|l.id<<3)>>>0)).uint32((4|l.id<<3)>>>0):o[f].encode(h,c.uint32((2|l.id<<3)>>>0).fork()).ldelim():c.uint32((l.id<<3|p)>>>0)[d](h))}return c}}}e.exports=o,o._configure=function(){r=n(343),i=n(5360)}},343:function(e,t,n){e.exports=o;var r=n(5988);((o.prototype=Object.create(r.prototype)).constructor=o).className="Enum";var i=n(8909);function o(e,t,n,i,o){if(r.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=o||{},this.reserved=void 0,t)for(var a=Object.keys(t),c=0;c<a.length;++c)"number"==typeof t[a[c]]&&(this.valuesById[this.values[a[c]]=t[a[c]]]=a[c])}o.fromJSON=function(e,t){var n=new o(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},o.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return util.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},o.prototype.add=function(e,t,n){if(!util.isString(e))throw TypeError("name must be a string");if(!util.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=n||null,this},o.prototype.remove=function(e){if(!util.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},o.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},o.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},7255:function(e,t,n){e.exports=s;var r=n(5988);((s.prototype=Object.create(r.prototype)).constructor=s).className="Field";var i,o,a,c,u=/^required|optional|repeated$/;function s(e,t,n,i,c,s,l){if(a.isObject(i)?(l=c,s=i,i=c=void 0):a.isObject(c)&&(l=s,s=c,c=void 0),r.call(this,e,s),!a.isInteger(t)||0>t)throw TypeError("id must be a non-negative integer");if(!a.isString(n))throw TypeError("type must be a string");if(void 0!==i&&!u.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==c&&!a.isString(c))throw TypeError("extend must be a string");this.rule=i&&"optional"!==i?i:void 0,this.type=n,this.id=t,this.extend=c||void 0,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&void 0!==o.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=l}s.fromJSON=function(e,t){return new s(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(s.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),s.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),r.prototype.setOption.call(this,e,t,n)},s.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return a.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},s.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=o.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.typeDefault=this.resolvedType instanceof c?null:this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof i&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((!0===this.options.packed||void 0!==this.options.packed&&this.resolvedType&&!(this.resolvedType instanceof i))&&delete this.options.packed,!Object.keys(this.options).length&&(this.options=void 0)),this.long)this.typeDefault=a.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.defaultValue=this.map?a.emptyObject:this.repeated?a.emptyArray:this.typeDefault,this.parent instanceof c&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},s.d=function(e,t,n,r){return"function"==typeof t?t=a.decorateType(t).name:t&&"object"==typeof t&&(t=a.decorateEnum(t).name),function(i,o){a.decorateType(i.constructor).add(new s(o,e,t,n,{default:r}))}},s._configure=function(){c=n(8529),i=n(343),o=n(5360),a=n(3472)}},2333:function(e){function t(e){var t=Math.pow,a=Math.floor,c=Math.LN2,u=Math.log;return"undefined"==typeof Float32Array?function(){function s(e,n,r,i){var o=Math.round,s=0>n?1:0;if(s&&(n=-n),0===n)e(0<1/n?0:2147483648,r,i);else if(isNaN(n))e(2143289344,r,i);else if(34028234663852886e22<n)e((2139095040|s<<31)>>>0,r,i);else if(11754943508222875e-54>n)e((s<<31|o(n/1401298464324817e-60))>>>0,r,i);else{var l=a(u(n)/c);e((s<<31|l+127<<23|8388607&o(n*t(2,-l)*8388608))>>>0,r,i)}}function l(e,n,r){var i=e(n,r),o=2*(i>>31)+1,a=255&i>>>23,c=8388607&i;return 255==a?c?NaN:o*(1/0):0===a?1401298464324817e-60*o*c:o*t(2,a-150)*(c+8388608)}e.writeFloatLE=s.bind(null,n),e.writeFloatBE=s.bind(null,r),e.readFloatLE=l.bind(null,i),e.readFloatBE=l.bind(null,o)}():function(){function t(e,t,n){o[0]=e,t[n]=a[0],t[n+1]=a[1],t[n+2]=a[2],t[n+3]=a[3]}function n(e,t,n){o[0]=e,t[n]=a[3],t[n+1]=a[2],t[n+2]=a[1],t[n+3]=a[0]}function r(e,t){return a[0]=e[t],a[1]=e[t+1],a[2]=e[t+2],a[3]=e[t+3],o[0]}function i(e,t){return a[3]=e[t],a[2]=e[t+1],a[1]=e[t+2],a[0]=e[t+3],o[0]}var o=new Float32Array([-0]),a=new Uint8Array(o.buffer),c=128===a[3];e.writeFloatLE=c?t:n,e.writeFloatBE=c?n:t,e.readFloatLE=c?r:i,e.readFloatBE=c?i:r}(),"undefined"==typeof Float64Array?function(){function s(e,n,r,i,o,s){var l=0>i?1:0;if(l&&(i=-i),0===i)e(0,o,s+n),e(0<1/i?0:2147483648,o,s+r);else if(isNaN(i))e(0,o,s+n),e(2146959360,o,s+r);else if(17976931348623157e292<i)e(0,o,s+n),e((2146435072|l<<31)>>>0,o,s+r);else{var f;if(22250738585072014e-324>i)e((f=i/5e-324)>>>0,o,s+n),e((l<<31|f/4294967296)>>>0,o,s+r);else{var d=a(u(i)/c);1024===d&&(d=1023),e(4503599627370496*(f=i*t(2,-d))>>>0,o,s+n),e((l<<31|d+1023<<20|1048575&1048576*f)>>>0,o,s+r)}}}function l(e,n,r,i,o){var a=e(i,o+n),c=e(i,o+r),u=2*(c>>31)+1,s=2047&c>>>20,l=4294967296*(1048575&c)+a;return 2047===s?l?NaN:u*(1/0):0===s?5e-324*u*l:u*t(2,s-1075)*(l+4503599627370496)}e.writeDoubleLE=s.bind(null,n,0,4),e.writeDoubleBE=s.bind(null,r,4,0),e.readDoubleLE=l.bind(null,i,0,4),e.readDoubleBE=l.bind(null,o,4,0)}():function(){function t(e,t,n){o[0]=e,t[n]=a[0],t[n+1]=a[1],t[n+2]=a[2],t[n+3]=a[3],t[n+4]=a[4],t[n+5]=a[5],t[n+6]=a[6],t[n+7]=a[7]}function n(e,t,n){o[0]=e,t[n]=a[7],t[n+1]=a[6],t[n+2]=a[5],t[n+3]=a[4],t[n+4]=a[3],t[n+5]=a[2],t[n+6]=a[1],t[n+7]=a[0]}function r(e,t){return a[0]=e[t],a[1]=e[t+1],a[2]=e[t+2],a[3]=e[t+3],a[4]=e[t+4],a[5]=e[t+5],a[6]=e[t+6],a[7]=e[t+7],o[0]}function i(e,t){return a[7]=e[t],a[6]=e[t+1],a[5]=e[t+2],a[4]=e[t+3],a[3]=e[t+4],a[2]=e[t+5],a[1]=e[t+6],a[0]=e[t+7],o[0]}var o=new Float64Array([-0]),a=new Uint8Array(o.buffer),c=128===a[7];e.writeDoubleLE=c?t:n,e.writeDoubleBE=c?n:t,e.readDoubleLE=c?r:i,e.readDoubleBE=c?i:r}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=255&e>>>8,t[n+2]=255&e>>>16,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=255&e>>>16,t[n+2]=255&e>>>8,t[n+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},2282:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},o={};function a(e,t){var n,r,a;return t?(a=0<=(e>>>=0)&&256>e)&&(r=o[e])?r:(n=u(e,0>(0|e)?-1:0,!0),a&&(o[e]=n),n):(a=-128<=(e|=0)&&128>e)&&(r=i[e])?r:(n=u(e,0>e?-1:0,!1),a&&(i[e]=n),n)}function c(e,t){if(isNaN(e))return t?g:y;if(t){if(0>e)return g;if(e>=p)return I}else{if(e<=-h)return C;if(e+1>=h)return S}return 0>e?c(-e,t).neg():u(0|e%d,0|e/d,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=a,n.fromNumber=c,n.fromBits=u;var s=Math.pow;function l(e,t,n){var r,i=Math.min;if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,2>(n=n||10)||36<n)throw RangeError("radix");if(0<(r=e.indexOf("-")))throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var o=c(s(n,8)),a=y,u=0;u<e.length;u+=8){var f=i(8,e.length-u),d=parseInt(e.substring(u,u+f),n);if(8>f){var p=c(s(n,f));a=a.mul(p).add(c(d))}else a=(a=a.mul(o)).add(c(d))}return a.unsigned=t,a}function f(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?l(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=f;var d=4294967296,p=d*d,h=p/2,v=a(16777216),y=a(0);n.ZERO=y;var g=a(0,!0);n.UZERO=g;var m=a(1);n.ONE=m;var b=a(1,!0);n.UONE=b;var w=a(-1);n.NEG_ONE=w;var S=u(-1,2147483647,!1);n.MAX_VALUE=S;var I=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=I;var C=u(0,-2147483648,!1);n.MIN_VALUE=C;var _=n.prototype;_.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},_.toString=function(e){if(2>(e=e||10)||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(C)){var t=c(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=c(s(e,6),this.unsigned),o=this,a="";;){var u=o.div(i),l=(o.sub(u.mul(i)).toInt()>>>0).toString(e);if((o=u).isZero())return l+a;for(;6>l.length;)l="0"+l;a=""+l+a}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0==this.high?this.low:this.high,t=31;0<t&&0==(e&1<<t);t--);return 0==this.high?t+1:t+33},_.isZero=function(){return 0===this.high&&0===this.low},_.eqz=_.isZero,_.isNegative=function(){return!this.unsigned&&0>this.high},_.isPositive=function(){return this.unsigned||0<=this.high},_.isOdd=function(){return 1==(1&this.low)},_.isEven=function(){return 0==(1&this.low)},_.equals=function(e){return r(e)||(e=f(e)),(this.unsigned===e.unsigned||1!=this.high>>>31||1!=e.high>>>31)&&this.high===e.high&&this.low===e.low},_.eq=_.equals,_.notEquals=function(e){return!this.eq(e)},_.neq=_.notEquals,_.ne=_.notEquals,_.lessThan=function(e){return 0>this.comp(e)},_.lt=_.lessThan,_.lessThanOrEqual=function(e){return 0>=this.comp(e)},_.lte=_.lessThanOrEqual,_.le=_.lessThanOrEqual,_.greaterThan=function(e){return 0<this.comp(e)},_.gt=_.greaterThan,_.greaterThanOrEqual=function(e){return 0<=this.comp(e)},_.gte=_.greaterThanOrEqual,_.ge=_.greaterThanOrEqual,_.compare=function(e){if(r(e)||(e=f(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(m)},_.neg=_.negate,_.add=function(e){r(e)||(e=f(e));var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,a=e.high>>>16,c=65535&e.high,s=e.low>>>16,l=0,d=0,p=0,h=0;return p+=(h+=o+(65535&e.low))>>>16,d+=(p+=i+s)>>>16,l+=(d+=n+c)>>>16,l+=t+a,u((p&=65535)<<16|(h&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},_.subtract=function(e){return r(e)||(e=f(e)),this.add(e.neg())},_.sub=_.subtract,_.multiply=function(e){if(this.isZero())return y;if(r(e)||(e=f(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(C))return e.isOdd()?C:y;if(e.eq(C))return this.isOdd()?C:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(v)&&e.lt(v))return c(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,o=this.low>>>16,a=65535&this.low,s=e.high>>>16,l=65535&e.high,d=e.low>>>16,p=65535&e.low,h=0,g=0,m=0,b=0;return m+=(b+=a*p)>>>16,g+=(m+=o*p)>>>16,m&=65535,g+=(m+=a*d)>>>16,h+=(g+=i*p)>>>16,g&=65535,h+=(g+=o*d)>>>16,g&=65535,h+=(g+=a*l)>>>16,h+=n*p+i*d+o*l+a*s,u((m&=65535)<<16|(b&=65535),(h&=65535)<<16|(g&=65535),this.unsigned)},_.mul=_.multiply,_.divide=function(e){var n,i,o,a=Math.ceil,l=Math.LN2,d=Math.log,p=Math.max,h=Math.floor;if(r(e)||(e=f(e)),e.isZero())throw Error("division by zero");if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return b;o=g}else{if(this.eq(C))return e.eq(m)||e.eq(w)?C:e.eq(C)?m:(n=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?m:w:(i=this.sub(e.mul(n)),o=n.add(i.div(e)));if(e.eq(C))return this.unsigned?g:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=y}for(i=this;i.gte(e);){for(var v=a(d(n=p(1,h(i.toNumber()/e.toNumber())))/l),S=48>=v?1:s(2,v-48),I=c(n),_=I.mul(e);_.isNegative()||_.gt(i);)_=(I=c(n-=S,this.unsigned)).mul(e);I.isZero()&&(I=m),o=o.add(I),i=i.sub(_)}return o},_.div=_.divide,_.modulo=function(e){return r(e)||(e=f(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},_.mod=_.modulo,_.rem=_.modulo,_.not=function(){return u(~this.low,~this.high,this.unsigned)},_.and=function(e){return r(e)||(e=f(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},_.or=function(e){return r(e)||(e=f(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},_.xor=function(e){return r(e)||(e=f(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},_.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:32>e?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:32>e?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return 32>e?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.shr_u=_.shiftRightUnsigned,_.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},_.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,255&t>>>8,255&t>>>16,t>>>24,255&e,255&e>>>8,255&e>>>16,e>>>24]},_.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,255&e>>>16,255&e>>>8,255&e,t>>>24,255&t>>>16,255&t>>>8,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},2223:function(e){function t(e,t){this.lo=e>>>0,this.hi=t>>>0}e.exports=t;var n=t.zero=new t(0,0);n.toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1};var r=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(e){if(0===e)return n;var r=0>e;r&&(e=-e);var i=e>>>0,o=(e-i)/4294967296>>>0;return r&&(o=~o>>>0,i=~i>>>0,4294967295<++i&&(i=0,4294967295<++o&&(o=0))),new t(i,o)},t.from=function(e){return"number"==typeof e?t.fromNumber(e):"string"==typeof e||e instanceof String?t.fromNumber(parseInt(e,10)):e.low||e.high?new t(e.low>>>0,e.high>>>0):n},t.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},t.prototype.toLong=function(e){return{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var i=String.prototype.charCodeAt;t.fromHash=function(e){return e===r?n:new t((i.call(e,0)|i.call(e,1)<<8|i.call(e,2)<<16|i.call(e,3)<<24)>>>0,(i.call(e,4)|i.call(e,5)<<8|i.call(e,6)<<16|i.call(e,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(255&this.lo,255&this.lo>>>8,255&this.lo>>>16,this.lo>>>24,255&this.hi,255&this.hi>>>8,255&this.hi>>>16,this.hi>>>24)},t.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},t.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},t.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0==n?0===t?16384>e?128>e?1:2:2097152>e?3:4:16384>t?128>t?5:6:2097152>t?7:8:128>n?9:10}},4357:function(e,t,n){e.exports=a;var r,i,o=n(7255);function a(e,t,n,r,a,c){if(o.call(this,e,t,r,void 0,void 0,a,c),!i.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}((a.prototype=Object.create(o.prototype)).constructor=a).className="MapField",a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return i.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===r.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return o.prototype.resolve.call(this)},a.d=function(e,t,n){return"function"==typeof n?n=i.decorateType(n).name:n&&"object"==typeof n&&(n=i.decorateEnum(n).name),function(r,o){i.decorateType(r.constructor).add(new a(o,e,t,n))}},a._configure=function(){r=n(5360),i=n(3472)}},1912:function(e,t,n){"use strict";var r;function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}e.exports=i,i.create=function(e){return this.$type.create(e)},i.encode=function(){return arguments.length?1==arguments.length?this.$type.encode(arguments[0]):this.$type.encode(arguments[0],arguments[1]):this.$type.encode(this)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return e=e||this,this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)},i.set=function(e,t){i[e]=t},i.get=function(e){return i[e]},i._configure=function(){r=n(3472)}},5467:function(e,t,n){"use strict";e.exports=o;var r,i=n(5988);function o(e,t,n,o,a,c,u,s){if(r.isObject(a)?(u=a,a=c=void 0):r.isObject(c)&&(u=c,c=void 0),void 0!==t&&!r.isString(t))throw TypeError("type must be a string");if(!r.isString(n))throw TypeError("requestType must be a string");if(!r.isString(o))throw TypeError("responseType must be a string");i.call(this,e,u),this.type=t||"rpc",this.requestType=n,this.requestStream=!!a||void 0,this.responseType=o,this.responseStream=!!c||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=s}((o.prototype=Object.create(i.prototype)).constructor=o).className="Method",o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return r.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),i.prototype.resolve.call(this))},o._configure=function(){r=n(3472)}},8909:function(e,t,n){e.exports=l;var r,i,o,a,c,u=n(5988);function s(e,t){if(e&&e.length){for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}}function l(e,t){u.call(this,e,t),this.nested=void 0,this._nestedArray=null}function f(e){return e._nestedArray=null,e}((l.prototype=Object.create(u.prototype)).constructor=l).className="Namespace",l.fromJSON=function(e,t){return new l(e,t.options).addJSON(t.nested)},l.arrayToJSON=s,l.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>=t)return!0;return!1},l.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(l.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=o.toArray(this.nested))}}),l.prototype.toJSON=function(e){return o.toObject(["options",this.options,"nested",s(this.nestedArray,e)])},l.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),o=0;o<n.length;++o)t=e[n[o]],this.add((void 0===t.fields?void 0===t.values?void 0===t.methods?void 0===t.id?l.fromJSON:i.fromJSON:c.fromJSON:r.fromJSON:a.fromJSON)(n[o],t));return this},l.prototype.get=function(e){return this.nested&&this.nested[e]||null},l.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof r)return this.nested[e].values;throw Error("no such enum: "+e)},l.prototype.add=function(e){if(!(e instanceof i&&void 0!==e.extend||e instanceof a||e instanceof r||e instanceof c||e instanceof l))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof l&&e instanceof l)||t instanceof a||t instanceof c)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,o=0;o<n.length;++o)e.add(n[o]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),f(this)},l.prototype.remove=function(e){if(!(e instanceof u))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),f(this)},l.prototype.define=function(e,t){if(o.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n,r=this;0<e.length;)if(n=e.shift(),r.nested&&r.nested[n]){if(!((r=r.nested[n])instanceof l))throw Error("path conflicts with non-namespace objects")}else r.add(r=new l(n));return t&&r.addJSON(t),r},l.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof l?e[t++].resolveAll():e[t++].resolve();return this.resolve()},l.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),o.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||-1<t.indexOf(r.constructor))return r}else if(r instanceof l&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof l&&(r=this._nestedArray[i].lookup(e,t,!0)))return r;return null===this.parent||n?null:this.parent.lookup(e,t)},l.prototype.lookupType=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such type: "+e);return t},l.prototype.lookupEnum=function(e){var t=this.lookup(e,[r]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},l.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[a,r]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},l.prototype.lookupService=function(e){var t=this.lookup(e,[c]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},l._configure=function(){r=n(343),i=n(7255),o=n(3472),a=n(8529),c=n(6007)}},5988:function(e,t,n){"use strict";var r,i;function o(e,t){if(!r.isString(e))throw TypeError("name must be a string");if(t&&!r.isObject(t))throw TypeError("options must be an object");this.options=t,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}e.exports=o,o.className="ReflectionObject",Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof i&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof i&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved||this.root instanceof i&&(this.resolved=!0),this},o.prototype.getOption=function(e){return this.options?this.options[e]:void 0},o.prototype.setOption=function(e,t,n){return n&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},o.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(){i=n(4902),r=n(3472)}},4543:function(e,t,n){e.exports=a;var r,i,o=n(5988);function a(e,t,n,r){if(Array.isArray(t)||(n=t,t=void 0),o.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=r}function c(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}((a.prototype=Object.create(o.prototype)).constructor=a).className="OneOf",a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return i.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof r))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,c(this),this},a.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(0>t)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),-1<(t=this.oneof.indexOf(e.name))&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){o.prototype.onAdd.call(this,e);for(var t,n=0;n<this.oneof.length;++n)(t=e.get(this.oneof[n]))&&!t.partOf&&(t.partOf=this,this.fieldsArray.push(t));c(this)},a.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);o.prototype.onRemove.call(this,e)},a.d=function(){for(var e=Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){i.decorateType(t.constructor).add(new a(n,e)),Object.defineProperty(t,n,{get:i.oneOfGetter(e),set:i.oneOfSetter(e)})}},a._configure=function(){r=n(7255),i=n(3472)}},7965:function(e,t,n){"use strict";e.exports=_,_.filename=null,_.defaults={keepCase:!1};var r,i,o,a,c,u,s,l,f,d,p,h=/^[1-9][0-9]*$/,v=/^-?[1-9][0-9]*$/,y=/^0[x][0-9a-fA-F]+$/,g=/^-?0[x][0-9a-fA-F]+$/,m=/^0[0-7]+$/,b=/^-?0[0-7]+$/,w=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,S=/^[a-zA-Z_][a-zA-Z_0-9]*$/,I=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,C=/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/;function _(e,t,n){function D(e,t,n){var r=_.filename;return n||(_.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(r?r+", ":"")+"line "+z.line+")")}function T(){var e,t=[];do{if('"'!==(e=H())&&"'"!==e)throw D(e);t.push(H()),Z(e),e=J()}while('"'===e||"'"===e);return t.join("")}function E(e){var t=H();switch(t){case"'":case'"':return W(t),T();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e,t){var n=1;switch("-"===e.charAt(0)&&(n=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return n*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(h.test(e))return n*parseInt(e,10);if(y.test(e))return n*parseInt(e,16);if(m.test(e))return n*parseInt(e,8);if(w.test(e))return n*parseFloat(e);throw D(e,"number",!0)}(t)}catch(n){if(e&&I.test(t))return t;throw D(t,"value")}}function A(e,t){var n,r;do{!t||'"'!==(n=J())&&"'"!==n?e.push([r=x(H()),Z("to",!0)?x(H()):r]):e.push(T())}while(Z(",",!0));Z(";")}function x(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw D(e,"id");if(v.test(e))return parseInt(e,10);if(g.test(e))return parseInt(e,16);if(b.test(e))return parseInt(e,8);throw D(e,"id")}function O(){if(void 0!==F)throw D("package");if(F=H(),!I.test(F))throw D(F,"name");X=X.define(F),Z(";")}function k(){var e,t=J();switch(t){case"weak":e=q||(q=[]),H();break;case"public":H();default:e=$||($=[])}t=T(),Z(";"),e.push(t)}function B(){if(Z("="),V=T(),!(Y="proto3"===V)&&"proto2"!==V)throw D(V,"syntax");Z(";")}function L(e,t){return"option"===t?(M(e,t),Z(";"),!0):"message"===t?(function(e,t){if(!S.test(t=H()))throw D(t,"type name");var n=new o(t);P(n,(function(e){if(!L(n,e))switch(e){case"map":!function(e){Z("<");var t=H();if(void 0===d.mapKey[t])throw D(t,"type");Z(",");var n=H();if(!I.test(n))throw D(n,"type");Z(">");var r=H();if(!S.test(r))throw D(r,"name");Z("=");var i=new c(ee(r),x(H()),t,n);P(i,(function(e){if("option"!==e)throw D(e);M(i,e),Z(";")}),(function(){U(i)})),e.add(i)}(n);break;case"required":case"optional":case"repeated":N(n,e);break;case"oneof":!function(e,t){if(!S.test(t=H()))throw D(t,"name");var n=new u(ee(t));P(n,(function(e){"option"===e?(M(n,e),Z(";")):(W(e),N(n,"optional"))})),e.add(n)}(n,e);break;case"extensions":A(n.extensions||(n.extensions=[]));break;case"reserved":A(n.reserved||(n.reserved=[]),!0);break;default:if(!Y||!I.test(e))throw D(e);W(e),N(n,"optional")}})),e.add(n)}(e,t),!0):"enum"===t?(function(e,t){if(!S.test(t=H()))throw D(t,"name");var n=new s(t);P(n,(function(e){"option"===e?(M(n,e),Z(";")):"reserved"===e?A(n.reserved||(n.reserved=[]),!0):function(e,t){if(!S.test(t))throw D(t,"name");Z("=");var n=x(H(),!0),r={};P(r,(function(e){if("option"!==e)throw D(e);M(r,e),Z(";")}),(function(){U(r)})),e.add(t,n,r.comment)}(n,e)})),e.add(n)}(e,t),!0):"service"===t?(function(e,t){if(!S.test(t=H()))throw D(t,"service name");var n=new l(t);P(n,(function(e){if(!L(n,e)){if("rpc"!==e)throw D(e);!function(e,t){var n=t;if(!S.test(t=H()))throw D(t,"name");var r,i,o,a,c=t;if(Z("("),Z("stream",!0)&&(i=!0),!I.test(t=H()))throw D(t);if(r=t,Z(")"),Z("returns"),Z("("),Z("stream",!0)&&(a=!0),!I.test(t=H()))throw D(t);o=t,Z(")");var u=new f(c,n,r,o,i,a);P(u,(function(e){if("option"!==e)throw D(e);M(u,e),Z(";")})),e.add(u)}(n,e)}})),e.add(n)}(e,t),!0):"extend"==t&&(function(e,t){if(!I.test(t=H()))throw D(t,"reference");var n=t;P(null,(function(t){switch(t){case"required":case"repeated":case"optional":N(e,t,n);break;default:if(!Y||!I.test(t))throw D(t);W(t),N(e,"optional",n)}}))}(e,t),!0)}function P(e,t,n){var r=z.line;if(e&&(e.comment=K(),e.filename=_.filename),Z("{",!0)){for(var i;"}"!==(i=H());)t(i);Z(";",!0)}else n&&n(),Z(";"),e&&"string"!=typeof e.comment&&(e.comment=K(r))}function N(e,t,n){var r=H();if("group"!==r){if(!I.test(r))throw D(r,"type");var i=H();if(!S.test(i))throw D(i,"name");i=ee(i),Z("=");var c=new a(i,x(H()),r,t,n);P(c,(function(e){if("option"!==e)throw D(e);M(c,e),Z(";")}),(function(){U(c)})),e.add(c),!Y&&c.repeated&&(void 0!==d.packed[r]||void 0===d.basic[r])&&c.setOption("packed",!1,!0)}else!function(e,t){var n=H();if(!S.test(n))throw D(n,"name");var r=p.lcFirst(n);n===r&&(n=p.ucFirst(n)),Z("=");var i=x(H()),c=new o(n);c.group=!0;var u=new a(r,i,n,t);u.filename=_.filename,P(c,(function(e){switch(e){case"option":M(c,e),Z(";");break;case"required":case"optional":case"repeated":N(c,e);break;default:throw D(e)}})),e.add(c).add(u)}(e,t)}function M(e,t){var n=Z("(",!0);if(!I.test(t=H()))throw D(t,"name");var r=t;n&&(Z(")"),r="("+r+")",t=J(),C.test(t)&&(r+=t,H())),Z("="),j(e,r)}function j(e,t){if(Z("{",!0))do{if(!S.test(G=H()))throw D(G,"name");"{"===J()?j(e,t+"."+G):(Z(":"),"{"===J()?j(e,t+"."+G):R(e,t+"."+G,E(!0)))}while(!Z("}",!0));else R(e,t,E(!0))}function R(e,t,n){e.setOption&&e.setOption(t,n)}function U(e){if(Z("[",!0)){do{M(e,"option")}while(Z(",",!0));Z("]")}return e}t instanceof i||(n=t,t=new i),n||(n=_.defaults);for(var F,$,q,V,G,z=r(e,n.alternateCommentMode||!1),H=z.next,W=z.push,J=z.peek,Z=z.skip,K=z.cmnt,Q=!0,Y=!1,X=t,ee=n.keepCase?function(e){return e}:p.camelCase;null!==(G=H());)switch(G){case"package":if(!Q)throw D(G);O();break;case"import":if(!Q)throw D(G);k();break;case"syntax":if(!Q)throw D(G);B();break;case"option":if(!Q)throw D(G);M(X,G),Z(";");break;default:if(L(X,G)){Q=!1;continue}throw D(G)}return _.filename=null,{package:F,imports:$,weakImports:q,syntax:V,root:t}}_._configure=function(){r=n(6448),i=n(4902),o=n(8529),a=n(7255),c=n(4357),u=n(4543),s=n(343),l=n(6007),f=n(5467),d=n(5360),p=n(3472)}},2651:function(e){var t=e.exports,n=t.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},r=t.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),r=n(e),i="";r&&(i=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?0<o&&".."!==t[o-1]?t.splice(--o,2):r?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return i+t.join("/")};t.resolve=function(e,t,i){return i||(t=r(t)),n(t)?t:(i||(e=r(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?r(e+"/"+t):t)}},9650:function(e){e.exports=function(e,t,n){var r=n||8192,i=null,o=r;return function(n){if(1>n||n>r>>>1)return e(n);o+n>r&&(i=e(r),o=0);var a=t.call(i,o,o+=n);return 7&o&&(o=1+(7|o)),a}}},9384:function(e,t,n){e.exports=c;var r,i,o=n(3472);function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,s="undefined"==typeof Uint8Array?function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return new c(new Uint8Array(e));throw Error("illegal buffer")};function l(){var e=new r(0,0),t=0;if(!(4<this.len-this.pos)){for(;3>t;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,128>this.buf[this.pos++])return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;4>t;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,128>this.buf[this.pos++])return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return e;if(t=0,4<this.len-this.pos){for(;5>t;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,128>this.buf[this.pos++])return e}else for(;5>t;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,128>this.buf[this.pos++])return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw a(this,8);return new r(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=o.Buffer?function(e){return(c.create=function(e){return o.Buffer.isBuffer(e)?new(void 0)(e):s(e)})(e)}:s,c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++])return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++])return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return 0|e>>>1^-(1&e)},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return i.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(){r=n(2223),i=n(7927);var e=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return l.call(this)[e](!1)},uint64:function(){return l.call(this)[e](!0)},sint64:function(){return l.call(this).zzDecode()[e](!1)},fixed64:function(){return d.call(this)[e](!0)},sfixed64:function(){return d.call(this)[e](!1)}})}},4902:function(e,t,n){e.exports=f;var r=n(8909);((f.prototype=Object.create(r.prototype)).constructor=f).className="Root";var i,o,a,c=n(7255),u=n(343),s=n(4543),l=n(3472);function f(e){r.call(this,"",e),this.deferred=[],this.files=[],this.names=[]}function d(){}f.fromJSON=function(e,t){return e="string"==typeof e?JSON.parse(e):e,t||(t=new f),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},f.prototype.resolvePath=l.path.resolve,f.prototype.parseFromPbString=function e(t,n,r){function i(e,t){if(r){var n=r;r=null,n(e,t)}}function c(e,t){try{if(l.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),l.isString(t)){o.filename=e;var r,a=o(t,s,n),c=0;if(a.imports)for(;c<a.imports.length;++c)u(r=a.imports[c]);if(a.weakImports){for(c=0;c<a.weakImports.length;++c)r=a.weakImports[c];u(r)}}else s.setOptions(t.options).addJSON(t.nested)}catch(e){i(e)}i(null,s)}function u(e){-1<s.names.indexOf(e)||(s.names.push(e),e in a&&c(e,a[e]))}"function"==typeof n&&(r=n,n=void 0);var s=this;if(!r)return l.asPromise(e,s,t,n);var f=null;if("string"==typeof t)f=JSON.parse(t);else{if("object"!=typeof t)return void console.log("pb格式转化失败");f=t}c(f.name,f.pbJsonStr)},f.prototype.load=function e(t,n,r){function i(e,t){if(r){var n=r;if(r=null,f)throw e;n(e,t)}}function c(e,t){try{if(l.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),l.isString(t)){o.filename=e;var r,a=o(t,s,n),c=0;if(a.imports)for(;c<a.imports.length;++c)(r=s.resolvePath(e,a.imports[c]))&&u(r);if(a.weakImports)for(c=0;c<a.weakImports.length;++c)(r=s.resolvePath(e,a.weakImports[c]))&&u(r,!0)}else s.setOptions(t.options).addJSON(t.nested)}catch(e){i(e)}f||p||i(null,s)}function u(e,t){var n=e.lastIndexOf("google/protobuf/");if(-1<n){var o=e.substring(n);o in a&&(e=o)}if(!(-1<s.files.indexOf(e))){if(s.files.push(e),e in a)return void(f?c(e,a[e]):(++p,setTimeout((function(){--p,c(e,a[e])}))));if(f){var u;try{u=l.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||i(e))}c(e,u)}else++p,l.fetch(e,(function(n,o){return--p,r?n?void(t?!p&&i(null,s):i(n)):void c(e,o):void 0}))}}"function"==typeof n&&(r=n,n=void 0);var s=this;if(!r)return l.asPromise(e,s,t,n);var f=r===d,p=0;l.isString(t)&&(t=[t]);for(var h,v=0;v<t.length;++v)(h=s.resolvePath("",t[v]))&&u(h);return f?s:void(p||i(null,s))},f.prototype.loadSync=function(e,t){if(!l.isNode)throw Error("not supported");return this.load(e,t,d)},f.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var p=/^[A-Z]/;function h(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new c(t.fullName,t.id,t.type,t.rule,void 0,t.options);return r.declaringField=t,t.extensionField=r,n.add(r),!0}return!1}f.prototype._handleAdd=function(e){if(e instanceof c)void 0===e.extend||e.extensionField||h(0,e)||this.deferred.push(e);else if(e instanceof u)p.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof s)){if(e instanceof i)for(var t=0;t<this.deferred.length;)h(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);p.test(e.name)&&(e.parent[e.name]=e)}},f.prototype._handleRemove=function(e){if(e instanceof c){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);-1<t&&this.deferred.splice(t,1)}}else if(e instanceof u)p.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);p.test(e.name)&&delete e.parent[e.name]}},f._configure=function(){i=n(8529),o=n(7965),a=n(9290),c=n(7255),u=n(343),s=n(4543),l=n(3472)}},789:function(e){e.exports={}},6427:function(e,t,n){"use strict";e.exports=i;var r=n(3472);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!n}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var c=this;if(!a)return r.asPromise(e,c,t,n,i,o);if(c.rpcImpl)try{return c.rpcImpl(t,n[c.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return c.emit("error",e,t),a(e);if(null!==n){if(!(n instanceof i))try{n=i[c.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return c.emit("error",e,t),a(e)}return c.emit("data",n,t),a(null,n)}c.end(!0)}))}catch(n){return c.emit("error",n,t),void setTimeout((function(){a(n)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(!e&&this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},6007:function(e,t,n){"use strict";e.exports=c;var r,i,o,a=n(8909);function c(e,t){a.call(this,e,t),this.methods={},this._methodsArray=null}function u(e){return e._methodsArray=null,e}((c.prototype=Object.create(a.prototype)).constructor=c).className="Service",c.fromJSON=function(e,t){var n=new c(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),o=0;o<i.length;++o)n.add(r.fromJSON(i[o],t.methods[i[o]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},c.prototype.toJSON=function(e){var t=a.prototype.toJSON.call(this,e),n=!!e&&!!e.keepComments;return i.toObject(["options",t&&t.options||void 0,"methods",a.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(c.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=i.toArray(this.methods))}}),c.prototype.get=function(e){return this.methods[e]||a.prototype.get.call(this,e)},c.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return a.prototype.resolve.call(this)},c.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof r?(this.methods[e.name]=e,e.parent=this,u(this)):a.prototype.add.call(this,e)},c.prototype.remove=function(e){if(e instanceof r){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,u(this)}return a.prototype.remove.call(this,e)},c.prototype.create=function(e,t,n){for(var r,a,c=new o.Service(e,t,n),u=0;u<this.methodsArray.length;++u)c[a=i.lcFirst((r=this._methodsArray[u]).resolve().name).replace(/[^$\w_]/g,"")]=i.codegen(["r","c"],i.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor});return c},c._configure=function(){r=n(5467),i=n(3472),o=n(6427)}},6448:function(e){e.exports=f;var t=/[\s{}=;:[\],'"()<>]/g,n=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,r=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,i=/^ *[*/]+ */,o=/^\s*\*?\/*/,a=/\n/g,c=/\s/,u=/\\(.?)/g,s={0:"\0",r:"\r",n:"\n",t:"\t"};function l(e){return e.replace(u,(function(e,t){return"\\"===t||""===t?t:s[t]||""}))}function f(e,u){function s(e){return Error("illegal "+e+" (line "+w+")")}function f(t){return e.charAt(t)}function d(t,n){S=e.charAt(t++),C=w,_=!1;var r,c=t-(u?2:3);do{if(0>--c||"\n"===(r=e.charAt(c))){_=!0;break}}while(" "===r||"\t"===r);for(var s=e.substring(t,n).split(a),l=0;l<s.length;++l)s[l]=s[l].replace(u?o:i,"").trim();I=s.join("\n").trim()}function p(t){var n=h(t),r=e.substring(t,n);return/^\s*\/{1,2}/.test(r)}function h(e){for(var t=e;t<b&&"\n"!==f(t);)t++;return t}function v(){var i,o,a,v,g,S=Math.min;if(0<D.length)return D.shift();if(T)return function(){var t="'"===T?r:n;t.lastIndex=m-1;var i=t.exec(e);if(!i)throw s("string");return m=t.lastIndex,y(T),T=null,l(i[1])}();do{if(m===b)return null;for(i=!1;c.test(a=f(m));)if("\n"===a&&++w,++m===b)return null;if("/"===f(m)){if(++m===b)throw s("comment");if("/"===f(m))if(u){if(v=m,g=!1,p(m)){g=!0;do{if((m=h(m))===b)break;m++}while(p(m))}else m=S(b,h(m)+1);g&&d(v,m),w++,i=!0}else{for(g="/"===f(v=m+1);"\n"!==f(++m);)if(m===b)return null;++m,g&&d(v,m-1),++w,i=!0}else{if("*"!==(a=f(m)))return"/";v=m+1,g=u||"*"===f(v);do{if("\n"===a&&++w,++m===b)throw s("comment");o=a,a=f(m)}while("*"!==o||"/"!==a);++m,g&&d(v,m-2),i=!0}}}while(i);var I=m;if(t.lastIndex=0,!t.test(f(I++)))for(;I<b&&!t.test(f(I));)++I;var C=e.substring(m,m=I);return('"'===C||"'"===C)&&(T=C),C}function y(e){D.push(e)}function g(){if(!D.length){var e=v();if(null===e)return null;y(e)}return D[0]}e=e.toString();var m=0,b=e.length,w=1,S=null,I=null,C=0,_=!1,D=[],T=null;return Object.defineProperty({next:v,peek:g,push:y,skip:function(e,t){var n=g();if(n===e)return v(),!0;if(!t)throw s("token '"+n+"', '"+e+"' expected");return!1},cmnt:function(e){var t=null;return void 0===e?C===w-1&&(u||"*"===S||_)&&(t=I):(C<e&&g(),C===e&&!_&&(u||"/"===S)&&(t=I)),t}},"line",{get:function(){return w}})}f.unescape=l},8529:function(e,t,n){e.exports=m;var r,i,o,a,c,u,s,l,f,d,p,h,v,y,g=n(8909);function m(e,t){g.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function b(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}((m.prototype=Object.create(g.prototype)).constructor=m).className="Type",Object.defineProperties(m.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=s.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=s.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=m.generateConstructor(this))},set:function(e){var t=e.prototype;t instanceof o||((e.prototype=new o).constructor=e,s.merge(e.prototype,t)),e.$type=e.prototype.$type=this,s.merge(e,o,!0),s.merge(e.prototype,o,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n){var i=this._oneofsArray[n].resolve().name,a=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=0;return{setter:function(n){if(!(0>e.indexOf(n))){t[n]=1;for(var r=0;r<e.length;++r)e[r]!==n&&delete this[e[r]]}},getter:function(){for(var e=Object.keys(this),n=e.length-1;-1<n;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}}}(this._oneofsArray[n].oneof);r[i]={get:a.getter,set:a.setter}}n&&Object.defineProperties(e.prototype,r)}}}),m.generateConstructor=function(e){return function(t){for(var n,r=0;r<e.fieldsArray.length;r++)(n=e._fieldsArray[r]).map?this[n.name]={}:n.repeated&&(this[n.name]=[]);if(t)for(var i=Object.keys(t),o=0;o<i.length;++o)null!=t[i[o]]&&(this[i[o]]=t[i[o]])}},m.fromJSON=function(e,t){var n=new m(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var o=Object.keys(t.fields),c=0;c<o.length;++c)n.add((void 0===t.fields[o[c]].keyType?i.fromJSON:y.fromJSON)(o[c],t.fields[o[c]]));if(t.oneofs)for(o=Object.keys(t.oneofs),c=0;c<o.length;++c)n.add(a.fromJSON(o[c],t.oneofs[o[c]]));if(t.nested)for(o=Object.keys(t.nested),c=0;c<o.length;++c){var u=t.nested[o[c]];n.add((void 0===u.id?void 0===u.fields?void 0===u.values?void 0===u.methods?g.fromJSON:p.fromJSON:r.fromJSON:m.fromJSON:i.fromJSON)(o[c],u))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},m.prototype.toJSON=function(e){var t=g.prototype.toJSON.call(this,e),n=!!e&&!!e.keepComments;return{options:t&&t.options||void 0,oneofs:g.arrayToJSON(this.oneofsArray,e),fields:g.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},extensions:this.extensions&&this.extensions.length?this.extensions:void 0,reserved:this.reserved&&this.reserved.length?this.reserved:void 0,group:this.group||void 0,nested:t&&t.nested||void 0,comment:n?this.comment:void 0}},m.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return g.prototype.resolveAll.call(this)},m.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},m.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof i&&void 0===e.extend){if(this._fieldsById&&this._fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),b(this)}return e instanceof a?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),b(this)):g.prototype.add.call(this,e)},m.prototype.remove=function(e){if(e instanceof i&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),b(this)}if(e instanceof a){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),b(this)}return g.prototype.remove.call(this,e)},m.prototype.isReservedId=function(e){return g.isReservedId(this.reserved,e)},m.prototype.isReservedName=function(e){return g.isReservedName(this.reserved,e)},m.prototype.create=function(e){return new this.ctor(e)},m.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=f(this)({Writer:c,types:t,util:s}),this.decode=d(this)({Reader:u,types:t,util:s}),this.verify=l(this)({types:t,util:s}),this.fromObject=v.fromObject(this)({types:t,util:s}),this.toObject=v.toObject(this)({types:t,util:s});var r=h[e];if(r){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(i),i.toObject=this.toObject,this.toObject=r.toObject.bind(i)}return this},m.prototype.encode=function(e,t){return this.setup().encode(e,t)},m.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},m.prototype.decode=function(e,t){return this.setup().decode(e,t)},m.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},m.prototype.verify=function(e){return this.setup().verify(e)},m.prototype.fromObject=function(e){return this.setup().fromObject(e)},m.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},m.d=function(e){return function(t){s.decorateType(t,e)}},m._configure=function(){r=n(343),i=n(7255),o=n(1912),a=n(4543),c=n(372),u=n(9384),s=n(3472),l=n(4235),f=n(9909),d=n(7285),p=n(6007),h=n(5785),v=n(9904),y=n(4357)}},5360:function(e,t,n){"use strict";var r=e.exports,i=n(3472),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var n=0,r={};for(t|=0;n<e.length;)r[o[n+t]]=e[n++];return r}r.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),r.long=a([0,0,0,1,1],7),r.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0]),r._configure=function(){i=n(3472)}},7927:function(e){"use strict";var t=e.exports;t.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)128>(n=e.charCodeAt(r))?t+=1:2048>n?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},t.read=function(e,t,n){var r=String.fromCharCode;if(1>n-t)return"";for(var i,o=null,a=[],c=0;t<n;)128>(i=e[t++])?a[c++]=i:191<i&&224>i?a[c++]=(31&i)<<6|63&e[t++]:239<i&&365>i?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,a[c++]=55296+(i>>10),a[c++]=56320+(1023&i)):a[c++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],8191<c&&((o||(o=[])).push(r.apply(String,a)),c=0);return o?(c&&o.push(r.apply(String,a.slice(0,c))),o.join("")):r.apply(String,a.slice(0,c))},t.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)128>(r=e.charCodeAt(a))?t[n++]=r:2048>r?(t[n++]=192|r>>6,t[n++]=128|63&r):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=240|r>>18,t[n++]=128|63&r>>12,t[n++]=128|63&r>>6,t[n++]=128|63&r):(t[n++]=224|r>>12,t[n++]=128|63&r>>6,t[n++]=128|63&r);return n-o}},3472:function(e,t,n){var r=e.exports,i=n(789);r.LongBits=n(2223),r.Long=n(2282),r.pool=n(9650),r.float=n(2333),r.asPromise=n(9535),r.EventEmitter=n(4344),r.path=n(2651),r.base64=n(5599),r.utf8=n(7927),r.compareFieldsById=function(e,t){return e.id-t.id},r.toArray=function(e){if(e){for(var t=Object.keys(e),n=Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},r.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],i=e[n++];void 0!==i&&(t[r]=i)}return t},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},r.isObject=function(e){return e&&"object"==typeof e},r.Array="undefined"==typeof Uint8Array?Array:Uint8Array,r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;-1<n;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.merge=function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e},r.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(r.decorateRoot.remove(e.$type),e.$type.name=t,r.decorateRoot.add(e.$type)),e.$type;Type||(Type=n(8529));var i=new Type(t||e.name);return r.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i},r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.copy=function(e){if("object"!=typeof e)return e;var t={};for(var n in e)t[n]=e[n];return t},r.deepCopy=function e(t){if("object"!=typeof t)return t;var n={};for(var r in t)n[r]=e(t[r]);return n},r.ProtocolError=function(e){function t(e,n){return this instanceof t?(Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),void(n&&merge(this,n))):new t(e,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r.Buffer=null,r.newBuffer=function(e){return"number"==typeof e?new r.Array(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.stringToBytes=function(e){var t,n,r=[];t=e.length;for(var i=0;i<t;i++)65536<=(n=e.charCodeAt(i))&&1114111>=n?(r.push(240|7&n>>18),r.push(128|63&n>>12),r.push(128|63&n>>6),r.push(128|63&n)):2048<=n&&65535>=n?(r.push(224|15&n>>12),r.push(128|63&n>>6),r.push(128|63&n)):128<=n&&2047>=n?(r.push(192|31&n>>6),r.push(128|63&n)):r.push(255&n);return r},r.byteToString=function(e){var t=String.fromCharCode;if("string"==typeof e)return e;for(var n="",r=e,i=0;i<r.length;i++){var o=r[i].toString(2),a=o.match(/^1+?(?=0)/);if(a&&8==o.length){for(var c=a[0].length,u=r[i].toString(2).slice(7-c),s=1;s<c;s++)u+=r[s+i].toString(2).slice(2);n+=t(parseInt(u,2)),i+=c-1}else n+=t(r[i])}return n},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Object.defineProperty(r,"decorateRoot",{get:function(){return i.decorated||(i.decorated=new(n(4902)))}})},4235:function(e,t,n){var r,i;function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,n,a){var c=a.types;if(e.resolvedType)if(e.resolvedType instanceof r){if(0>Object.keys(e.resolvedType.values).indexOf(n))return o(e,"enum value")}else{var u=c[t].verify(n);if(u)return e.name+"."+u}else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":if(!i.isInteger(n))return o(e,"integer");break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":if(!(i.isInteger(n)||n&&i.isInteger(n.low)&&i.isInteger(n.high)))return o(e,"integer|Long");break;case"float":case"double":if("number"!=typeof n)return o(e,"number");break;case"bool":if("boolean"!=typeof n)return o(e,"boolean");break;case"string":if(!i.isString(n))return o(e,"string");break;case"bytes":if(!(n&&"number"==typeof n.length||i.isString(n)))return o(e,"buffer")}}function c(e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":if(!i.key32Re.test(t))return o(e,"integer key");break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":if(!i.key64Re.test(t))return o(e,"integer|Long key");break;case"bool":if(!i.key2Re.test(t))return o(e,"boolean key")}}function u(e){return function(t){return function(n){var r;if("object"!=typeof n||null===n)return"object expected";var u,s={};e.oneofsArray.length&&(u={});for(var l=0;l<e.fieldsArray.length;++l){var f,d=e._fieldsArray[l].resolve(),p=n[d.name];if(!d.optional||null!=p&&n.hasOwnProperty(d.name))if(d.map){if(!i.isObject(p))return o(d,"object");var h=Object.keys(p);for(f=0;f<h.length;++f){if(r=c(d,h[f]))return r;if(r=a(d,l,p[h[f]],t))return r}}else if(d.repeated){if(!Array.isArray(p))return o(d,"array");for(f=0;f<p.length;++f)if(r=a(d,l,p[f],t))return r}else{if(d.partOf){var v=d.partOf.name;if(1===s[d.partOf.name]&&1===u[v])return d.partOf.name+": multiple values";u[v]=1}if(r=a(d,l,p,t))return r}}}}}e.exports=u,u._configure=function(){r=n(343),i=n(3472)}},5785:function(e,t,n){var r,i=t;i[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=this.lookup(e["@type"]);if(t){var n="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return this.create({type_url:"/"+n,value:t.encode(t.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){if(t&&t.json&&e.type_url&&e.value){var n=e.type_url.substring(e.type_url.lastIndexOf("/")+1),i=this.lookup(n);i&&(e=i.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof r){var o=e.$type.toObject(e,t);return o["@type"]=e.$type.fullName,o}return this.toObject(e,t)}},i._configure=function(){r=n(1912)}},372:function(e,t,n){e.exports=s;var r,i=n(3472),o=n(7927);function a(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function c(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function s(){this.len=0,this.head=new a(c,0,0),this.tail=this.head,this.states=null}function l(e,t,n){t[n]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function d(e,t,n){for(;e.hi;)t[n++]=128|127&e.lo,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)t[n++]=128|127&e.lo,e.lo>>>=7;t[n++]=e.lo}function p(e,t,n){t[n]=255&e,t[n+1]=255&e>>>8,t[n+2]=255&e>>>16,t[n+3]=e>>>24}s.create=i.Buffer?function(){return(s.create=function(){return new(void 0)})()}:function(){return new s},s.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(s.alloc=i.pool(s.alloc,i.Array.prototype.subarray)),s.prototype._push=function(e,t,n){return this.tail=this.tail.next=new a(e,t,n),this.len+=t,this},f.prototype=Object.create(a.prototype),f.prototype.fn=function(e,t,n){for(;127<e;)t[n++]=128|127&e,e>>>=7;t[n]=e},s.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f(128>(e>>>=0)?1:16384>e?2:2097152>e?3:268435456>e?4:5,e)).len,this},s.prototype.int32=function(e){return 0>e?this._push(d,10,r.fromNumber(e)):this.uint32(e)},s.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},s.prototype.uint64=function(e){var t=r.from(e);return this._push(d,t.length(),t)},s.prototype.int64=s.prototype.uint64,s.prototype.sint64=function(e){var t=r.from(e).zzEncode();return this._push(d,t.length(),t)},s.prototype.bool=function(e){return this._push(l,1,e?1:0)},s.prototype.fixed32=function(e){return this._push(p,4,e>>>0)},s.prototype.sfixed32=s.prototype.fixed32,s.prototype.fixed64=function(e){var t=r.from(e);return this._push(p,4,t.lo)._push(p,4,t.hi)},s.prototype.sfixed64=s.prototype.fixed64,s.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},s.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var h=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};s.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(l,1,0);if(i.isString(e)){var n=s.alloc(t=o.length(e));o.write(e,n,0),e=n}return this.uint32(t)._push(h,t,e)},s.prototype.string=function(e){var t=o.length(e);return t?this.uint32(t)._push(o.write,t,e):this._push(l,1,0)},s.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new a(c,0,0),this.len=0,this},s.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new a(c,0,0),this.len=0),this},s.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},s.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},s._configure=function(){r=n(2223),n(5599),o=n(7927)}}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={exports:{}};return e[t].call(o.exports,o,o.exports,r),o.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i=r(4240),o=t;for(var a in i)o[a]=i[a];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};!function(){"use strict";n.r(r),n.d(r,{BindDevice:function(){return Ku},BindDeviceErrorCode:function(){return s},CommonErrorCode:function(){return a},ConnectAndBindDevice:function(){return Qu},ConnectionErrorCode:function(){return u},Event:function(){return _u},GpsStatus:function(){return xi.GpsStatus},Init:function(){return Vu},InitErrorCode:function(){return c},OtaErrorCode:function(){return l},SERVICES:function(){return f},StartDataSync:function(){return kc},bindDevice:function(){return as},bindDeviceObservable:function(){return os},clearDeviceStorage:function(){return es},connectAndBindDevice:function(){return us},connectDevice:function(){return na},dataHelper:function(){return i},disconnectDevice:function(){return ia},getAllDeviceStorage:function(){return ao},getConnectedDevices:function(){return la},getConnectionState:function(){return oa},getDeviceMacInfo:function(){return vo},getDeviceMacInfoList:function(){return ho},getMobileDeviceMac:function(){return Ro},getScanDevices:function(){return So},init:function(){return Ju},isSupportFileUpdateEvent:function(){return Tl},onConnectionConnectedChange:function(){return ua},onConnectionConnectedChangeObservalbe:function(){return sa},onConnectionStateChange:function(){return aa},onConnectionStateChangeObservable:function(){return ca},onEvent:function(){return Mu},onEventObservable:function(){return ju},onGpsStartRequest:function(){return Rc},onGpsStopRequest:function(){return Fc},onInitialized:function(){return Zu},onUploadData:function(){return Lc},parseAdvertisData:function(){return xi.parseAdvertisData},parseQrcode:function(){return Xu},requestDevice:function(){return Iu},requestDeviceGetFile:function(){return xu},scanDevice:function(){return wo},scanDeviceObservable:function(){return bo},startDataSync:function(){return Nc},startUpgrade:function(){return Dl},unbindDevice:function(){return fs},updateGpsStatus:function(){return Jc},updateLocationInfo:function(){return Zc}});var e={};n.r(e),n.d(e,{closeBLEConnection:function(){return At},closeBluetoothAdapter:function(){return Tt},createBLEConnection:function(){return Et},getBLEDeviceCharacteristics:function(){return Bt},getBLEDeviceServices:function(){return Lt},getBluetoothAdapterState:function(){return _t},getConnectedBluetoothDevices:function(){return xt},getStorage:function(){return Ut},getSystemInfoSync:function(){return $t},notifyBLECharacteristicValueChange:function(){return Nt},offBLECharacteristicValueChange:function(){return Zt},offBLEConnectionStateChange:function(){return Wt},offBluetoothAdapterStateChange:function(){return Vt},offBluetoothDeviceFound:function(){return zt},onBLECharacteristicValueChange:function(){return Jt},onBLEConnectionStateChange:function(){return Ht},onBluetoothAdapterStateChange:function(){return qt},onBluetoothDeviceFound:function(){return Gt},openBluetoothAdapter:function(){return Dt},readBLECharacteristicValue:function(){return Mt},removeStorage:function(){return Ft},setBLEMTU:function(){return jt},setStorage:function(){return Rt},startBluetoothDevicesDiscovery:function(){return Ot},stopBluetoothDevicesDiscovery:function(){return kt},writeBLECharacteristicValue:function(){return Pt}});var t={};n.r(t),n.d(t,{closeBLEConnection:function(){return vn},closeBluetoothAdapter:function(){return rn},createBLEConnection:function(){return hn},getBLEDeviceCharacteristics:function(){return bn},getBLEDeviceServices:function(){return wn},getBluetoothAdapterState:function(){return on},getConnectedBluetoothDevices:function(){return yn},getStorage:function(){return Tn},getSystemInfoSync:function(){return Dn},notifyBLECharacteristicValueChange:function(){return In},offBLECharacteristicValueChange:function(){return cn},offBLEConnectionStateChange:function(){return pn},offBluetoothAdapterStateChange:function(){return sn},offBluetoothDeviceFound:function(){return fn},onBLECharacteristicValueChange:function(){return an},onBLEConnectionStateChange:function(){return dn},onBluetoothAdapterStateChange:function(){return un},onBluetoothDeviceFound:function(){return ln},openBluetoothAdapter:function(){return nn},readBLECharacteristicValue:function(){return Cn},removeStorage:function(){return An},setBLEMTU:function(){return _n},setStorage:function(){return En},startBluetoothDevicesDiscovery:function(){return gn},stopBluetoothDevicesDiscovery:function(){return mn},writeBLECharacteristicValue:function(){return Sn}});var i={};function o(e){return"0000".concat(e,"-0000-1000-8000-00805F9B34FB")}n.r(i),n.d(i,{BloodOxygenSettingType:function(){return Ko},DataType:function(){return Xo},FileType:function(){return Qo},Gender:function(){return La},GpsLocation:function(){return ka},HrSettingSwitch:function(){return ta},PressureStatusType:function(){return ea},RecordType:function(){return Yo},SleepReportSwitch:function(){return Ba},TodayActiveGoalType:function(){return Pa},formatBatteryInfo:function(){return ya},formatDeviceInfo:function(){return va},formatDeviceLanguageSet:function(){return ga},formatDeviceTime:function(){return ha},formatGetFileList:function(){return Sa},formatGetPressureStatus:function(){return Da},formatGetSportRecordList:function(){return Aa},formatHrSwitch:function(){return Oa},formatSedentaryReminder:function(){return qa},formatSleepReport:function(){return Ma},formatSleepSwitch:function(){return Ga},formatSpo2Switch:function(){return fa},formatSportHrSectionCfg:function(){return Ha},formatTodayActiveGoalGet:function(){return ec},formatUserInfo:function(){return Za},formatactivityStrengthDetail:function(){return Ia},getAge:function(){return Ya},parseBloodOxygenSetting:function(){return da},parseDeviceLanguageSetting:function(){return ma},parseDeviceTime:function(){return pa},parseGetDailyRecordData:function(){return Ca},parseGetFileList:function(){return wa},parseGetFileRequest:function(){return ba},parseGetPressureStatus:function(){return _a},parseGetSportRecordFile:function(){return Ta},parseGetSportRecordList:function(){return Ea},parseGpsLocation:function(){return Va},parseHrSwitch:function(){return xa},parseSedentaryReminder:function(){return $a},parseSleepSwitch:function(){return za},parseSportHrSectionSetting:function(){return Wa},parseTodayActiveGoalGet:function(){return Xa},parseUserInfo:function(){return Ja}});var a,c,u,s,l,f=["A500","AC00"].map((function(e){return o(e)})),d=["LS Band 6","Mio Band","Mio BJ"];!function(e){e[e.Unknow=10001]="Unknow",e[e.BadParams=10002]="BadParams",e[e.OpenBluetoothAdapterError=10003]="OpenBluetoothAdapterError"}(a||(a={})),function(e){e[e.Initializing=20002]="Initializing",e[e.InitBluetoothError=20003]="InitBluetoothError",e[e.Initialized=20004]="Initialized"}(c||(c={})),function(e){e[e.Timeout=30002]="Timeout",e[e.AlreadyConnecting=30003]="AlreadyConnecting",e[e.AlreadyConnected=30004]="AlreadyConnected",e[e.NotConnected=30005]="NotConnected",e[e.NotFoundDevice=30006]="NotFoundDevice"}(u||(u={})),function(e){e[e.NotFoundDevice=40002]="NotFoundDevice",e[e.NotConnected=40003]="NotConnected",e[e.UserDeny=40004]="UserDeny",e[e.DeviceCharging=40005]="DeviceCharging",e[e.DeviceAlreadyBind=40006]="DeviceAlreadyBind",e[e.OnConfirmBindError=40007]="OnConfirmBindError",e[e.OnConfirmBindResultNotSuccess=40008]="OnConfirmBindResultNotSuccess"}(s||(s={})),function(e){e[e.NotFoundDevice=50001]="NotFoundDevice",e[e.Success=0]="Success",e[e.ErrVerify=50011]="ErrVerify",e[e.ErrVersion=50002]="ErrVersion",e[e.ErrStorage=50003]="ErrStorage",e[e.ErrNoMem=50004]="ErrNoMem",e[e.ErrDecompress=50005]="ErrDecompress",e[e.ErrBattery=50006]="ErrBattery",e[e.ErrStatus=50007]="ErrStatus",e[e.Send0x02Fail=50008]="Send0x02Fail",e[e.SendA703Fail=50009]="SendA703Fail",e[e.Timeout=50010]="Timeout"}(l||(l={}));var p=function(e,t){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},p(e,t)};function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function v(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))}function y(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}Object.create;function g(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function b(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function S(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||c(e,t)}))})}function c(e,t){try{(n=i[e](t)).value instanceof w?Promise.resolve(n.value.v).then(u,s):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function u(e){c("next",e)}function s(e){c("throw",e)}function l(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}}function I(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=g(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}Object.create;function C(e){return"function"==typeof e}function _(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var D=_((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function T(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var E=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=g(o),c=a.next();!c.done;c=a.next()){c.value.remove(this)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(C(u))try{u()}catch(e){i=e instanceof D?e.errors:[e]}var s=this._finalizers;if(s){this._finalizers=null;try{for(var l=g(s),f=l.next();!f.done;f=l.next()){var d=f.value;try{O(d)}catch(e){i=null!=i?i:[],e instanceof D?i=b(b([],m(i)),m(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(i)throw new D(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)O(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&T(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&T(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),A=E.EMPTY;function x(e){return e instanceof E||e&&"closed"in e&&C(e.remove)&&C(e.add)&&C(e.unsubscribe)}function O(e){C(e)?e():e.unsubscribe()}var k={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},B={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=B.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,b([e,t],m(n))):setTimeout.apply(void 0,b([e,t],m(n)))},clearTimeout:function(e){var t=B.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function L(e){B.setTimeout((function(){var t=k.onUnhandledError;if(!t)throw e;t(e)}))}function P(){}var N=M("C",void 0,void 0);function M(e,t,n){return{kind:e,value:t,error:n}}var j=null;function R(e){if(k.useDeprecatedSynchronousErrorHandling){var t=!j;if(t&&(j={errorThrown:!1,error:null}),e(),t){var n=j,r=n.errorThrown,i=n.error;if(j=null,r)throw i}}else e()}var U=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,x(t)&&t.add(n)):n.destination=H,n}return h(t,e),t.create=function(e,t,n){return new V(e,t,n)},t.prototype.next=function(e){this.isStopped?z(function(e){return M("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?z(M("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?z(N,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(E),F=Function.prototype.bind;function $(e,t){return F.call(e,t)}var q=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){G(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){G(e)}else G(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){G(e)}},e}(),V=function(e){function t(t,n,r){var i,o,a=e.call(this)||this;C(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:a&&k.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},i={next:t.next&&$(t.next,o),error:t.error&&$(t.error,o),complete:t.complete&&$(t.complete,o)}):i=t;return a.destination=new q(i),a}return h(t,e),t}(U);function G(e){var t;k.useDeprecatedSynchronousErrorHandling?(t=e,k.useDeprecatedSynchronousErrorHandling&&j&&(j.errorThrown=!0,j.error=t)):L(e)}function z(e,t){var n=k.onStoppedNotification;n&&B.setTimeout((function(){return n(e,t)}))}var H={closed:!0,next:P,error:function(e){throw e},complete:P},W="function"==typeof Symbol&&Symbol.observable||"@@observable";function J(e){return e}function Z(e){return 0===e.length?J:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var K=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof U||function(e){return e&&C(e.next)&&C(e.error)&&C(e.complete)}(r)&&x(r)?e:new V(e,t,n);return R((function(){var e=i,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Q(t))((function(t,r){var i=new V({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[W]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Z(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Q(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Q(e){var t;return null!==(t=null!=e?e:k.Promise)&&void 0!==t?t:Promise}var Y=_((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),X=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return h(t,e),t.prototype.lift=function(e){var t=new ee(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Y},t.prototype.next=function(e){var t=this;R((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=g(t.currentObservers),o=i.next();!o.done;o=i.next()){o.value.next(e)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;R((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;R((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?A:(this.currentObservers=null,o.push(e),new E((function(){t.currentObservers=null,T(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new K;return e.source=this,e},t.create=function(e,t){return new ee(e,t)},t}(K),ee=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return h(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:A},t}(X),te=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return h(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(X);function ne(e){return function(t){if(function(e){return C(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function re(e,t,n,r,i){return new ie(e,t,n,r,i)}var ie=function(e){function t(t,n,r,i,o,a){var c=e.call(this,t)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,c._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,c}return h(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(U);function oe(e,t){return ne((function(n,r){var i=0;n.subscribe(re(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}var ae=_((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),ce=new K((function(e){return e.complete()}));function ue(e){return e<=0?function(){return ce}:ne((function(t,n){var r=0;t.subscribe(re(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}function se(e){return ne((function(t,n){var r=!1;t.subscribe(re(n,(function(e){r=!0,n.next(e)}),(function(){r||n.next(e),n.complete()})))}))}function le(e){return void 0===e&&(e=fe),ne((function(t,n){var r=!1;t.subscribe(re(n,(function(e){r=!0,n.next(e)}),(function(){return r?n.complete():n.error(e())})))}))}function fe(){return new ae}function de(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?oe((function(t,n){return e(t,n,r)})):J,ue(1),n?se(t):le((function(){return new ae})))}}var pe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),he=function(e){function t(n,r,i){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.code=null!=r?r:-1,o.data=i,o}return pe(t,e),t}(Error);function ve(){return function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return Object.setPrototypeOf(o,t.prototype),o}return pe(t,e),t}(he)}var ye=n(125),ge=n.n(ye),me=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function be(e){for(var t=e.methodName,n=e.loggerName,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o,a,c=r[0],u=r.slice(1);return["string","number","bigint","boolean"].includes(typeof c)?(o=" ".concat(c),a=u):(o="",a=me([c],u,!0)),me(["[".concat(t,"][").concat(n,"]").concat(o)],a,!0)}function we(e){var t=ge().methodFactory,n=ge().getLogger(e);return n.methodFactory=function(e,n,r){var i=t(e,n,r);return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i.apply(void 0,be.apply(void 0,me([{methodName:e,loggerName:r}],t,!1)))}},n}function Se(e,t){return ne((function(n,r){var i=0;n.subscribe(re(r,(function(n){r.next(e.call(t,n,i++))})))}))}var Ie=Array.isArray;function Ce(e){return Se((function(t){return function(e,t){return Ie(t)?e.apply(void 0,b([],m(t))):e(t)}(e,t)}))}function _e(e,t,n){return n?_e(e,t).pipe(Ce(n)):new K((function(n){var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.next(1===e.length?e[0]:e)},i=e(r);return C(t)?function(){return t(r,i)}:void 0}))}var De=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Te(e){return C(null==e?void 0:e.then)}function Ee(e){return C(e[W])}function Ae(e){return Symbol.asyncIterator&&C(null==e?void 0:e[Symbol.asyncIterator])}function xe(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Oe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function ke(e){return C(null==e?void 0:e[Oe])}function Be(e){return S(this,arguments,(function(){var t,n,r;return y(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,w(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,w(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,w(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Le(e){return C(null==e?void 0:e.getReader)}function Pe(e){if(e instanceof K)return e;if(null!=e){if(Ee(e))return i=e,new K((function(e){var t=i[W]();if(C(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(De(e))return r=e,new K((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(Te(e))return n=e,new K((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,L)}));if(Ae(e))return Ne(e);if(ke(e))return t=e,new K((function(e){var n,r;try{for(var i=g(t),o=i.next();!o.done;o=i.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(Le(e))return Ne(Be(e))}var t,n,r,i;throw xe(e)}function Ne(e){return new K((function(t){(function(e,t){var n,r,i,o;return v(this,void 0,void 0,(function(){var a,c;return y(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=I(e),u.label=1;case 1:return[4,n.next()];case 2:if((r=u.sent()).done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=u.sent(),i={error:c},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function Me(e,t){return ne((function(n,r){var i=null,o=0,a=!1,c=function(){return a&&!i&&r.complete()};n.subscribe(re(r,(function(n){null==i||i.unsubscribe();var a=0,u=o++;Pe(e(n,u)).subscribe(i=re(r,(function(e){return r.next(t?t(n,e,u,a++):e)}),(function(){i=null,c()})))}),(function(){a=!0,c()})))}))}var je=new K(P);function Re(e,t,n){var r=C(e)||t||n?{next:e,error:t,complete:n}:e;return r?ne((function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(re(t,(function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)}),(function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()}),(function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)}),(function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)})))})):J}function Ue(e){return e&&C(e.schedule)}function Fe(e){return e[e.length-1]}function $e(e){return C(Fe(e))?e.pop():void 0}function qe(e){return Ue(Fe(e))?e.pop():void 0}function Ve(e,t){return"number"==typeof Fe(e)?e.pop():t}function Ge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=$e(e);return ne((function(t,r){for(var i=e.length,o=new Array(i),a=e.map((function(){return!1})),c=!1,u=function(t){Pe(e[t]).subscribe(re(r,(function(e){o[t]=e,c||a[t]||(a[t]=!0,(c=a.every(J))&&(a=null))}),P))},s=0;s<i;s++)u(s);t.subscribe(re(r,(function(e){if(c){var t=b([e],m(o));r.next(n?n.apply(void 0,b([],m(t))):t)}})))}))}function ze(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}function He(e,t,n){return void 0===n&&(n=1/0),C(t)?He((function(n,r){return Se((function(e,i){return t(n,e,r,i)}))(Pe(e(n,r)))}),n):("number"==typeof t&&(n=t),ne((function(t,r){return function(e,t,n,r,i,o,a,c){var u=[],s=0,l=0,f=!1,d=function(){!f||u.length||s||t.complete()},p=function(e){return s<r?h(e):u.push(e)},h=function(e){o&&t.next(e),s++;var c=!1;Pe(n(e,l++)).subscribe(re(t,(function(e){null==i||i(e),o?p(e):t.next(e)}),(function(){c=!0}),void 0,(function(){if(c)try{s--;for(var e=function(){var e=u.shift();a?ze(t,a,(function(){return h(e)})):h(e)};u.length&&s<r;)e();d()}catch(e){t.error(e)}})))};return e.subscribe(re(t,p,(function(){f=!0,d()}))),function(){null==c||c()}}(t,r,e,n)})))}function We(e){return void 0===e&&(e=1/0),He(J,e)}function Je(){return We(1)}function Ze(e,t){return void 0===t&&(t=0),ne((function(n,r){n.subscribe(re(r,(function(n){return ze(r,e,(function(){return r.next(n)}),t)}),(function(){return ze(r,e,(function(){return r.complete()}),t)}),(function(n){return ze(r,e,(function(){return r.error(n)}),t)})))}))}function Ke(e,t){return void 0===t&&(t=0),ne((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function Qe(e,t){if(!e)throw new Error("Iterable cannot be null");return new K((function(n){ze(n,t,(function(){var r=e[Symbol.asyncIterator]();ze(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function Ye(e,t){if(null!=e){if(Ee(e))return function(e,t){return Pe(e).pipe(Ke(t),Ze(t))}(e,t);if(De(e))return function(e,t){return new K((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(Te(e))return function(e,t){return Pe(e).pipe(Ke(t),Ze(t))}(e,t);if(Ae(e))return Qe(e,t);if(ke(e))return function(e,t){return new K((function(n){var r;return ze(n,t,(function(){r=e[Oe](),ze(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return C(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(Le(e))return function(e,t){return Qe(Be(e),t)}(e,t)}throw xe(e)}function Xe(e,t){return t?Ye(e,t):Pe(e)}function et(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Je()(Xe(e,qe(e)))}function tt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qe(e);return ne((function(t,r){(n?et(e,t,n):et(e,t)).subscribe(r)}))}function nt(){return ne((function(e,t){var n,r=!1;e.subscribe(re(t,(function(e){var i=n;n=e,r&&t.next([i,e]),r=!0})))}))}var rt=function(e){function t(t,n){return e.call(this)||this}return h(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(E),it={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=it.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,b([e,t],m(n))):setInterval.apply(void 0,b([e,t],m(n)))},clearInterval:function(e){var t=it.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},ot=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return h(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),it.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&it.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,T(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(rt),at={now:function(){return(at.delegate||Date).now()},delegate:void 0},ct=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=at.now,e}(),ut=new(function(e){function t(t,n){void 0===n&&(n=ct.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return h(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(ct))(ot),st=ut;function lt(e,t){return void 0===t&&(t=ut),ne((function(n,r){var i=null,o=null,a=null,c=function(){if(i){i.unsubscribe(),i=null;var e=o;o=null,r.next(e)}};function u(){var n=a+e,o=t.now();if(o<n)return i=this.schedule(void 0,n-o),void r.add(i);c()}n.subscribe(re(r,(function(n){o=n,a=t.now(),i||(i=t.schedule(u,e),r.add(i))}),(function(){c(),r.complete()}),void 0,(function(){o=i=null})))}))}function ft(e,t){return C(t)?He(e,t,1):He(e,1)}function dt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qe(e);return Xe(e,n)}function pt(e,t){return t?function(n){return et(t.pipe(ue(1),ne((function(e,t){e.subscribe(re(t,P))}))),n.pipe(pt(e)))}:He((function(t,n){return e(t,n).pipe(ue(1),function(e){return Se((function(){return e}))}(t))}))}function ht(e){return e instanceof Date&&!isNaN(e)}function vt(e,t,n){void 0===e&&(e=0),void 0===n&&(n=st);var r=-1;return null!=t&&(Ue(t)?n=t:r=t),new K((function(t){var i=ht(e)?+e-n.now():e;i<0&&(i=0);var o=0;return n.schedule((function(){t.closed||(t.next(o++),0<=r?this.schedule(void 0,r):t.complete())}),i)}))}function yt(e,t){void 0===t&&(t=ut);var n=vt(e,t);return pt((function(){return n}))}var gt=_((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function mt(e,t){var n=ht(e)?{first:e}:"number"==typeof e?{each:e}:e,r=n.first,i=n.each,o=n.with,a=void 0===o?bt:o,c=n.scheduler,u=void 0===c?null!=t?t:ut:c,s=n.meta,l=void 0===s?null:s;if(null==r&&null==i)throw new TypeError("No timeout provided.");return ne((function(e,t){var n,o,c=null,s=0,f=function(e){o=ze(t,u,(function(){try{n.unsubscribe(),Pe(a({meta:l,lastValue:c,seen:s})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe(re(t,(function(e){null==o||o.unsubscribe(),s++,t.next(c=e),i>0&&f(i)}),void 0,void 0,(function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),c=null}))),!s&&f(null!=r?"number"==typeof r?r:+r-u.now():i)}))}function bt(e){throw new gt(e)}function wt(e){return ne((function(t,n){var r,i=null,o=!1;i=t.subscribe(re(n,void 0,void 0,(function(a){r=Pe(e(a,wt(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):o=!0}))),o&&(i.unsubscribe(),i=null,r.subscribe(n))}))}function St(e){return function(t){return new Promise((function(n){e(Object.assign(null!=t?t:{},{success:function(e){n({success:e,error:void 0})},fail:function(e){n({error:e||{}})}}))}))}}var It={},Ct={},_t=tn((function(){return wx}),"getBluetoothAdapterState"),Dt=tn((function(){return wx}),"openBluetoothAdapter"),Tt=tn((function(){return wx}),"closeBluetoothAdapter"),Et=tn((function(){return wx}),"createBLEConnection"),At=tn((function(){return wx}),"closeBLEConnection"),xt=tn((function(){return wx}),"getConnectedBluetoothDevices"),Ot=tn((function(){return wx}),"startBluetoothDevicesDiscovery"),kt=tn((function(){return wx}),"stopBluetoothDevicesDiscovery"),Bt=tn((function(){return wx}),"getBLEDeviceCharacteristics"),Lt=tn((function(){return wx}),"getBLEDeviceServices"),Pt=tn((function(){return wx}),"writeBLECharacteristicValue"),Nt=tn((function(){return wx}),"notifyBLECharacteristicValueChange"),Mt=tn((function(){return wx}),"readBLECharacteristicValue"),jt=tn((function(){return wx}),"setBLEMTU"),Rt=tn((function(){return wx}),"setStorage"),Ut=tn((function(){return wx}),"getStorage"),Ft=tn((function(){return wx}),"removeStorage"),$t=tn((function(){return wx}),"getSystemInfoSync"),qt=Kt("onBluetoothAdapterStateChange"),Vt=Qt("offBluetoothAdapterStateChange"),Gt=Kt("onBluetoothDeviceFound"),zt=Qt("offBluetoothDeviceFound"),Ht=Kt("onBLEConnectionStateChange"),Wt=Qt("offBLEConnectionStateChange"),Jt=Kt("onBLECharacteristicValueChange"),Zt=Qt("offBLECharacteristicValueChange");function Kt(e){return function(t){var n=Ct[e]=Ct[e]||[];if(n.push(t),!It[e]){var r=It[e]=new X;wx[e]((function(e){return r.next(e)})),r.subscribe((function(e){n.forEach((function(t){return t(e)}))}))}}}function Qt(e){return function(t){Ct[e]&&(Ct[e]=Ct[e].filter((function(e){return e!==t})))}}var Yt,Xt=e;function en(){return Xt}function tn(e,t){return function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return(n=e())[t].apply(n,r)}}!function(e){e.Ios="ios",e.Android="android"}(Yt||(Yt={}));var nn=tn(en,"openBluetoothAdapter"),rn=tn(en,"closeBluetoothAdapter"),on=tn(en,"getBluetoothAdapterState"),an=tn(en,"onBLECharacteristicValueChange"),cn=tn(en,"offBLECharacteristicValueChange"),un=tn(en,"onBluetoothAdapterStateChange"),sn=tn(en,"offBluetoothAdapterStateChange"),ln=tn(en,"onBluetoothDeviceFound"),fn=tn(en,"offBluetoothDeviceFound"),dn=tn(en,"onBLEConnectionStateChange"),pn=tn(en,"offBLEConnectionStateChange"),hn=tn(en,"createBLEConnection"),vn=tn(en,"closeBLEConnection"),yn=tn(en,"getConnectedBluetoothDevices"),gn=tn(en,"startBluetoothDevicesDiscovery"),mn=tn(en,"stopBluetoothDevicesDiscovery"),bn=tn(en,"getBLEDeviceCharacteristics"),wn=tn(en,"getBLEDeviceServices"),Sn=tn(en,"writeBLECharacteristicValue"),In=tn(en,"notifyBLECharacteristicValueChange"),Cn=tn(en,"readBLECharacteristicValue"),_n=tn(en,"setBLEMTU"),Dn=tn(en,"getSystemInfoSync"),Tn=tn(en,"getStorage"),En=tn(en,"setStorage"),An=tn(en,"removeStorage");function xn(e,t){return void 0===t&&(t=J),e=null!=e?e:On,ne((function(n,r){var i,o=!0;n.subscribe(re(r,(function(n){var a=t(n);!o&&e(i,a)||(o=!1,i=a,r.next(n))})))}))}function On(e,t){return e===t}function kn(e){return oe((function(t,n){return e<=n}))}function Bn(e){return new K((function(t){Pe(e()).subscribe(t)}))}function Ln(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qe(e),r=Ve(e,1/0),i=e;return i.length?1===i.length?Pe(i[0]):We(r)(Xe(i,n)):ce}var Pn=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=at);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return h(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,o=n._infiniteTimeWindow,a=n._timestampProvider,c=n._windowTime;r||(i.push(t),!o&&i.push(a.now()+c)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var a=n.now(),c=0,u=1;u<r.length&&r[u]<=a;u+=2)c=u;c&&r.splice(0,c+1)}},t}(X);function Nn(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new X}:t,r=e.resetOnError,i=void 0===r||r,o=e.resetOnComplete,a=void 0===o||o,c=e.resetOnRefCountZero,u=void 0===c||c;return function(e){var t,r,o,c=0,s=!1,l=!1,f=function(){null==r||r.unsubscribe(),r=void 0},d=function(){f(),t=o=void 0,s=l=!1},p=function(){var e=t;d(),null==e||e.unsubscribe()};return ne((function(e,h){c++,l||s||f();var v=o=null!=o?o:n();h.add((function(){0!==--c||l||s||(r=Mn(p,u))})),v.subscribe(h),!t&&c>0&&(t=new V({next:function(e){return v.next(e)},error:function(e){l=!0,f(),r=Mn(d,i,e),v.error(e)},complete:function(){s=!0,f(),r=Mn(d,a),v.complete()}}),Pe(e).subscribe(t))}))(e)}}function Mn(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!0!==t){if(!1!==t){var i=new V({next:function(){i.unsubscribe(),e()}});return t.apply(void 0,b([],m(n))).subscribe(i)}}else e()}function jn(e,t,n){var r,i,o,a,c=!1;return e&&"object"==typeof e?(r=e.bufferSize,a=void 0===r?1/0:r,i=e.windowTime,t=void 0===i?1/0:i,c=void 0!==(o=e.refCount)&&o,n=e.scheduler):a=null!=e?e:1/0,Nn({connector:function(){return new Pn(a,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}var Rn=Array.isArray,Un=Object.getPrototypeOf,Fn=Object.prototype,$n=Object.keys;function qn(e){if(1===e.length){var t=e[0];if(Rn(t))return{args:t,keys:null};if((r=t)&&"object"==typeof r&&Un(r)===Fn){var n=$n(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var r;return{args:e,keys:null}}function Vn(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}function Gn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qe(e),r=$e(e),i=qn(e),o=i.args,a=i.keys;if(0===o.length)return Xe([],n);var c=new K(zn(o,n,a?function(e){return Vn(a,e)}:J));return r?c.pipe(Ce(r)):c}function zn(e,t,n){return void 0===n&&(n=J),function(r){Hn(t,(function(){for(var i=e.length,o=new Array(i),a=i,c=i,u=function(i){Hn(t,(function(){var u=Xe(e[i],t),s=!1;u.subscribe(re(r,(function(e){o[i]=e,s||(s=!0,c--),c||r.next(n(o.slice()))}),(function(){--a||r.complete()})))}),r)},s=0;s<i;s++)u(s)}),r)}}function Hn(e,t,n){e?ze(n,e,t):t()}function Wn(e,t){return t?function(n){return n.pipe(Wn((function(n,r){return Pe(e(n,r)).pipe(Se((function(e,i){return t(n,e,r,i)})))})))}:ne((function(t,n){var r=0,i=null,o=!1;t.subscribe(re(n,(function(t){i||(i=re(n,void 0,(function(){i=null,o&&n.complete()})),Pe(e(t,r++)).subscribe(i))}),(function(){o=!0,!i&&n.complete()})))}))}function Jn(e,t){var n="object"==typeof t;return new Promise((function(r,i){var o=new V({next:function(e){r(e),o.unsubscribe()},error:i,complete:function(){n?r(t.defaultValue):i(new ae)}});e.subscribe(o)}))}function Zn(e,t){return void 0===e&&(e=0),void 0===t&&(t=ut),e<0&&(e=0),vt(e,e,t)}var Kn,Qn,Yn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},er=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},tr=we("wxapp-bluetooth-helper/bluetoothAdapter");!function(e){e.closed="closed",e.opened="opened"}(Kn||(Kn={})),function(e){e.openning="openning",e.opened="opened",e.cancel="cancel"}(Qn||(Qn={}));var nr,rr=function(e){function t(t){var n=e.call(this,t)||this;return n.code=t,n}return Yn(t,e),t}(Error),ir=function(){function e(){var e=this;this.state$=new te("closed"),this.open$=new X,this.close$=new X,this.apiOpenSuccess$=new X,this.apiCloseSuccess$=new X,this.check$=new X,this.expectOpen$=Ln(this.open$.pipe(Se((function(){return!0}))),this.close$.pipe(Se((function(){return!1})))).pipe(tt(!1),xn(),jn());var t={state$:this.state$}.state$.pipe(Me((function(e){return"opened"!==e?je:Zn(5e3).pipe(He((function(){return ar()})),Re((function(e){return tr.debug("health check state",e)})),Se((function(e){var t;return!!(null===(t=e.success)||void 0===t?void 0:t.available)})))})));this.realState$=Ln(this.apiOpenSuccess$.pipe(Se((function(){return Kn.opened}))),this.apiCloseSuccess$.pipe(Se((function(){return Kn.closed}))),t.pipe(oe((function(e){return!e})),Se((function(){return Kn.closed})))).pipe(tt(Kn.closed),xn(),jn());var n=Gn([this.expectOpen$,this.realState$],(function(e,t){return{expectOpen:e,realState:t}})).pipe(Re((function(e){var t=e.expectOpen,n=e.realState;return tr.debug("".concat((new Date).getTime()," expectOpen=").concat(t,", realState=").concat(n))})),Nn());Ln(n.pipe(Se((function(e){var t=e.expectOpen,n=e.realState;return t?n===Kn.opened?"opened":"opening":n===Kn.closed?"closed":"closing"})),xn())).subscribe(this.state$),Ln(this.expectOpen$.pipe(kn(1)),this.realState$.pipe(kn(1))).pipe(Se((function(){}))).subscribe(this.check$),this.checkResult$=this.check$.pipe(Wn((function(){return e.doCheck().pipe(yt(200))})),Nn()),this.checkResult$.pipe(oe((function(e){return"openSuccess"===(null==e?void 0:e.code)})),Se((function(){}))).subscribe(this.apiOpenSuccess$);var r=this.checkResult$.pipe(oe((function(e){return"openError"===(null==e?void 0:e.code)})),Se((function(){})));this.checkResult$.pipe(oe((function(e){return"closeSuccess"===(null==e?void 0:e.code)})),Se((function(){}))).subscribe(this.apiCloseSuccess$),Ln(r.pipe(Se((function(){return{check:!0,delay:2e3}}))),this.check$.pipe(Se((function(){return{check:!1}})))).pipe(xn(),Me((function(e){return e.check?vt(e.delay):je}))).pipe(Se((function(){}))).subscribe(this.check$),Gn([this.state$,this.realState$],(function(e,t){return{state:e,realState:t}})).pipe(Re((function(e){var t=e.state,n=e.realState;tr.debug("".concat((new Date).getTime()," state=").concat(t,", realState=").concat(n))}))).subscribe()}return e.prototype.open=function(){return Xn(this,void 0,void 0,(function(){var e,t;return er(this,(function(n){return this.open$.next(),e=this.state$.pipe(oe((function(e){return"opened"===e})),Se((function(){return{error:void 0}}))),t=this.close$.pipe(Se((function(){return{error:new rr(Qn.cancel)}}))),[2,Jn(Ln(e,t))]}))}))},e.prototype.close=function(){throw new Error("未测试过，暂不可关闭")},e.prototype.check=function(){var e=this;return Jn(Ln(this.checkResult$,Bn((function(){return e.check$.next(),je}))).pipe(de()).pipe(He((function(){return e.state$})),Se((function(e){return{state:e}}))))},e.prototype.getState=function(){return this.state$.getValue()},e.prototype.onStateChange=function(e,t){var n=(void 0===t?{}:t).immediate,r=this.state$.pipe(kn(n?0:1)).subscribe((function(t){return e(t)}));return function(){return r.unsubscribe()}},e.prototype.onOpenedChangeObservable=function(e){var t=(void 0===e?{}:e).immediate;return this.state$.pipe(Se((function(e){return"opened"===e})),xn(),kn(t?0:1))},e.prototype.onOpenedChange=function(e,t){void 0===t&&(t={});var n=this.onOpenedChangeObservable(t).subscribe((function(t){return e(t)}));return function(){return n.unsubscribe()}},e.prototype.doCheck=function(){var e=this;return dt(null).pipe(Ge(this.expectOpen$,this.state$,this.realState$,(function(e,t,n,r){return{expectOpen:t,state:n,realState:r}})),He((function(t){var n=t.expectOpen,r=t.realState;return tr.debug("check expectOpen=".concat(n,", realState=").concat(r)),n&&[Kn.closed].includes(r)?e.doOpenObservable().pipe(Se((function(){return{code:"openSuccess"}})),wt((function(){return dt({code:"openError"})}))):!n&&[Kn.opened].includes(r)?Bn((function(){return or()})).pipe(Se((function(){return{code:"closeSuccess"}}))):dt({code:"none"})})))},e.prototype.doOpenObservable=function(){return Bn((function(){return function(){return Xn(this,void 0,void 0,(function(){var e;return er(this,(function(t){switch(t.label){case 0:return tr.debug("doOpen start"),[4,St(nn)({})];case 1:return(e=t.sent()).error&&10001===e.error.errCode&&(e={success:e.error,error:void 0}),e.error?tr.debug("doOpen error",e.error):tr.debug("doOpen success",e.success),[2,e]}}))}))}()})).pipe(mt(3e3)).pipe(He((function(e){return e.error?Xe(or()).pipe(Re((function(){throw e.error}))):dt(e)}))).pipe(He((function(){return ar()})),He((function(e){return tr.debug("getBluetoothAdapterState",e),e.error?Xe(or()).pipe(Se((function(){throw e.error}))):dt(e.success)})))},e}();function or(){return Xn(this,void 0,void 0,(function(){var e;return er(this,(function(t){switch(t.label){case 0:return tr.debug("doClose start"),rn?[4,St(rn)({})]:[3,2];case 1:return(e=t.sent()).error?tr.debug("doClose error",e.error):tr.debug("doClose success",e.success),[2,e];case 2:return[2]}}))}))}function ar(){return Bn((function(){return St(on)({})}))}function cr(){return nr||(nr=new ir),nr}var ur,sr=tn(cr,"open"),lr=(tn(cr,"close"),tn(cr,"getState"),tn(cr,"onStateChange"),tn(cr,"onOpenedChange"),tn(cr,"onOpenedChangeObservable")),fr=(tn(cr,"check"),function(){return fr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fr.apply(this,arguments)}),dr=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},pr=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},hr=we("wxapp-bluetooth-helper/adapterState"),vr=function(){function e(){var e,t;this.state$=new te({available:!1,discovering:!1}),this.discovering$=this.state$.pipe(Se((function(e){return e.discovering})),xn()),(e=_e((function(e){return un(e)}),(function(e){return sn(e)})).pipe(Se((function(e){return{state:e,updateTime:(new Date).getTime()}}))),t=Bn((function(){return function(){return dr(this,void 0,void 0,(function(){var e,t;return pr(this,(function(n){switch(n.label){case 0:return e=(new Date).getTime(),hr.debug("getBluetoothAdapterStateByApi"),[4,St(on)({})];case 1:if((t=n.sent()).error)throw hr.error("getBluetoothAdapterStateByApi error",t.error),new he(t.error.errMsg,t.error.errCode);return hr.debug("getBluetoothAdapterStateByApi success",t.success),[2,{state:t.success,updateTime:e}]}}))}))}()})).pipe(wt((function(e){return hr.error("getBluetoothAdapterStateByApi error",e),ce}))),lr({immediate:!0}).pipe(Me((function(n){return hr.debug("adapter opened change:",n),n?Ln(e,t):dt({state:{available:!1,discovering:!1},updateTime:(new Date).getTime()})}))).pipe(Re((function(e){return hr.debug("adapter state change:",e)})),xn((function(e,t){return t.updateTime<=e.updateTime})),Se((function(e){return e.state})),Se((function(e){return e.available?e:fr(fr({},e),{discovering:!1})}))).pipe(xn((function(e,t){return e.available===t.available&&e.discovering===t.discovering}))).pipe(Re((function(e){return hr.debug("adapter state changed:",e)})))).subscribe(this.state$),this.onBluetoothAdapterStateChange$=this.state$.pipe(nt(),Se((function(e){var t=e[0];return{state:e[1],prevState:t}})))}return e.prototype.getBluetoothAdapterState=function(){return this.state$.getValue()},e.prototype.getBluetoothAdapterAvailable=function(){return this.getBluetoothAdapterState().available},e.prototype.onBluetoothAdapterStateChange=function(e){var t=e.onChange;e.immediate&&t(this.getBluetoothAdapterState());var n=this.onBluetoothAdapterStateChange$.subscribe({next:function(e){var n=e.state,r=e.prevState;return t(n,r)}});return function(){n.unsubscribe()}},e.prototype.onBluetoothAdapterAvailableChange=function(e){var t=e.onChange,n=e.immediate,r=this.onBluetoothAdapterAvailableChangeObservable({immediate:n}).subscribe((function(e){return t(e)}));return function(){r.unsubscribe()}},e.prototype.onBluetoothAdapterAvailableChangeObservable=function(e){var t=(void 0===e?{}:e).immediate,n=this.state$.pipe(Se((function(e){return e.available})),xn());return t||(n=n.pipe(kn(1))),n.pipe(Re((function(e){hr.debug("onBluetoothAdapterAvailableChange",e)})))},e}();function yr(){return ur||(ur=new vr),ur}tn(yr,"getBluetoothAdapterState"),tn(yr,"getBluetoothAdapterAvailable");var gr,mr=tn(yr,"onBluetoothAdapterStateChange"),br=tn(yr,"onBluetoothAdapterAvailableChange"),wr=(tn(yr,"onBluetoothAdapterAvailableChangeObservable"),function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}),Sr=we("wxapp-bluetooth-helper/DevicesScanner"),Ir=function(){function e(){var e=this;this.onBluetoothDeviceFound$=new X,this.scanDevices$=new X,this.stopScanDevices$=new X,this.onDeviceFound$=new X,this.scanDevicesDataList$=new te([]),this.state={available:!1,discovering:!1};var t=_e((function(e){return ln(e)}),(function(e){return fn(e)}));lr({immediate:!0}).pipe(Me((function(e){return e?t:je}))).subscribe(this.onBluetoothDeviceFound$),mr({immediate:!0,onChange:function(t){Sr.debug("onBluetoothAdapterStateChange",t),e.state=t}}),this.scanDevices$.pipe(Re((function(e){return Sr.debug("scanDevices:",e)})),Ge(this.scanDevicesDataList$,(function(e,t){return{option:e,options:t}})),Se((function(e){var t=e.option,n=e.options;return wr(wr([],n,!0),[t],!1)}))).subscribe(this.scanDevicesDataList$),this.stopScanDevices$.pipe(Re((function(e){return Sr.debug("stopScanDevices id=".concat(e))})),Ge(this.scanDevicesDataList$,(function(e,t){return{id:e,dataList:t}})),Se((function(e){var t=e.id;return e.dataList.filter((function(e){return e.id!==t}))}))).subscribe(this.scanDevicesDataList$);var n=this.scanDevicesDataList$.pipe(Re((function(e){return Sr.debug("scanDevicesDataList",e)})),Se((function(e){if(!(e.length<=0)){var t=e.map((function(e){return e.option})),n=function(e){var t=[],n=e.some((function(e){return!e.services||!e.services.length||(t=wr(wr([],t,!0),e.services,!0),!1)}));return n?void 0:Array.from(new Set(t))}(t),r=function(e){return e.some((function(e){return e.allowDuplicatesKey}))}(t),i=function(e){var t=e.map((function(e){return e.interval})).filter((function(e){return void 0!==e}));return t.length<=0?void 0:Math.min.apply(Math,t)}(t),o=function(e){var t=e.map((function(e){return e.powerLevel})).filter((function(e){return void 0!==e}));if(t.length<=0)return;var n=Math.max.apply(Math,t.map((function(e){return Er.find((function(t){return e===t.level})).value})));return Er.find((function(e){return e.value===n})).level}(t);return{services:n,allowDuplicatesKey:r,interval:i,powerLevel:o}}})),tt(void 0),nt(),Se((function(e){return{previous:e[0],current:e[1]}})),oe((function(e){var t=e.previous,n=e.current;return(void 0!==t||t!==n)&&(!t||!n||(!function(e,t){var n=null!=e?e:[],r=null!=t?t:[];return n.length===r.length&&n.every((function(e){return r.includes(e)}))}(t.services,n.services)||(t.allowDuplicatesKey!==n.allowDuplicatesKey||(t.interval!==n.interval||t.powerLevel!==n.powerLevel))))})),Se((function(e){return e.current})));n.pipe(Re((function(e){return Sr.debug("新的扫描参数",e)})),oe((function(){return e.state.available})),lt(200),ft((function(t){return t?e.state.discovering?Dr().pipe(yt(100),He((function(){return _r(t)}))):_r(t):e.state.discovering?Dr():dt("done")})),Re((function(){return Sr.debug("执行完成")}))).subscribe(),this.onBluetoothDeviceFound$.pipe(Ge(this.scanDevicesDataList$,(function(e,t){return{devices:e.devices,scanDevicesDataList:t}})),He((function(e){var t=e.devices,n=e.scanDevicesDataList;return Xe(t.map((function(e){return{device:e,scanDevicesDataList:n}})))})),He((function(e){var t=e.device;return Xe(e.scanDevicesDataList.map((function(e){return{device:t,scanDevicesData:e}})))})),oe((function(e){var t=e.device,n=e.scanDevicesData;if(!n.option.allowDuplicatesKey){if(n.scanDeviceIdMap[t.deviceId])return!1;n.scanDeviceIdMap[t.deviceId]=!0}return!0})),oe((function(e){var t,n=e.device,r=e.scanDevicesData.option;return!(null===(t=r.services)||void 0===t?void 0:t.length)||r.services.some((function(e){var t;return null===(t=n.advertisServiceUUIDs)||void 0===t?void 0:t.includes(e)}))})),Re((function(e){var t=e.device,n=e.scanDevicesData;Sr.debug("onBluetoothDeviceFound",t,n)})),Se((function(e){var t=e.device;return{id:e.scanDevicesData.id,device:t}}))).subscribe(this.onDeviceFound$)}return e.prototype.scanDevicesObservable=function(e){var t=this,n=new K((function(n){var r=Cr();Sr.debug("scanDevices id=".concat(r));var i={id:r,option:e,scanDeviceIdMap:{}};t.scanDevices$.next(i);var o=t.onDeviceFound$.pipe(oe((function(e){return e.id===r})),Se((function(e){return{device:e.device}}))).subscribe((function(e){return n.next(e)}));return function(){Sr.debug("stopScanDevices id=".concat(r)),o.unsubscribe(),t.stopScanDevices$.next(r)}}));return e.deviceId&&(n=n.pipe(oe((function(t){return t.device.deviceId===e.deviceId})))),e.timeout&&(n=n.pipe(mt(e.timeout))),e.findOne&&(n=n.pipe(de())),n},e.prototype.scanDevices=function(e){var t=this.scanDevicesObservable(e).subscribe((function(t){var n;null===(n=e.onDeviceFound)||void 0===n||n.call(e,t)}));return function(){return t.unsubscribe()}},e}(),Cr=(gr=0,function(){return++gr});function _r(e){return dt(1).pipe(Re((function(){return Sr.info("开启扫描设备",e)})),He((function(){return Xe(St(gn)(e)).pipe(Re((function(e){e.error?Sr.error("开启扫描设备 失败",e.error):Sr.debug("开启扫描设备 成功")})))})))}function Dr(){return dt(1).pipe(Re((function(){return Sr.info("停止扫描设备")})),He((function(){return Xe(St(mn)()).pipe(wt((function(e){return Sr.warn("stopBluetoothDevicesDiscovery error"),dt(e)})))})))}var Tr,Er=[{level:"low",value:0},{level:"medium",value:1},{level:"high",value:2}];function Ar(){if(!Tr)throw new Error("getDevicesScanner: 请先调用 initDevicesScanner");return Tr}function xr(e,t,n,r){return ne((function(i,o){var a;t&&"function"!=typeof t?(n=t.duration,a=t.element,r=t.connector):a=t;var c=new Map,u=function(e){c.forEach(e),e(o)},s=function(e){return u((function(t){return t.error(e)}))},l=0,f=!1,d=new ie(o,(function(t){try{var i=e(t),u=c.get(i);if(!u){c.set(i,u=r?r():new X);var p=(v=i,y=u,(g=new K((function(e){l++;var t=y.subscribe(e);return function(){t.unsubscribe(),0==--l&&f&&d.unsubscribe()}}))).key=v,g);if(o.next(p),n){var h=re(u,(function(){u.complete(),null==h||h.unsubscribe()}),void 0,void 0,(function(){return c.delete(i)}));d.add(Pe(n(p)).subscribe(h))}}u.next(a?a(t):t)}catch(e){s(e)}var v,y,g}),(function(){return u((function(e){return e.complete()}))}),s,(function(){return c.clear()}),(function(){return f=!0,0===l}));i.subscribe(d)}))}function Or(e){var t;void 0===e&&(e=1/0);var n=(t=e&&"object"==typeof e?e:{count:e}).count,r=void 0===n?1/0:n,i=t.delay,o=t.resetOnSuccess,a=void 0!==o&&o;return r<=0?J:ne((function(e,t){var n,o=0,c=function(){var u=!1;n=e.subscribe(re(t,(function(e){a&&(o=0),t.next(e)}),void 0,(function(e){if(o++<r){var a=function(){n?(n.unsubscribe(),n=null,c()):u=!0};if(null!=i){var s="number"==typeof i?vt(i):Pe(i(e,o)),l=re(t,(function(){l.unsubscribe(),a()}),(function(){t.complete()}));s.subscribe(l)}else a()}else t.error(e)}))),u&&(n.unsubscribe(),n=null,c())};c()}))}function kr(e,t){var n=void 0===t?{}:t,r=n.reversal,i=n.limit;if(!e)return"";if("string"==typeof e)return e;var o=Array.prototype.map.call(new Uint8Array(e.slice(0,i)),(function(e){return("00"+e.toString(16)).slice(-2)}));return r?o.reverse().join(""):o.join("")}var Br,Lr=we("wxapp-bluetooth-helper/writeCharacteristicValue"),Pr=function(){function e(){var e=this;this.write$=new X,this.writeComplete$=new X,this.seq=0,this.write$.pipe(xr((function(e){return e.option.deviceId})),He((function(e){return e.pipe(ft((function(e){return(t=e.option,r=null!==(n=t.retry)&&void 0!==n?n:0,i=dt(1).pipe(He((function(){var e={deviceId:t.deviceId,serviceId:t.serviceId,characteristicId:t.characteristicId,value:t.value};return Bn((function(){var t=(new Date).getTime();return Lr.debug("writeBLECharacteristicValue ".concat(t),e,kr(e.value)),St(Sn)(e).catch((function(e){return Lr.debug("writeBLECharacteristicValue error ".concat((new Date).getTime()-t),e),e})).then((function(e){return Lr.debug("writeBLECharacteristicValue result ".concat((new Date).getTime()-t),e),e}))})).pipe(mt({each:2e3,with:function(e){return Lr.debug("writeBLECharacteristicValue timeout ".concat((new Date).getTime()),e),dt({error:e,success:void 0})}}))})),oe((function(e){if(e.error)throw e.error;return!0})),Or({delay:function(e,t){return dt(1).pipe(Re((function(){if(t>r)throw Lr.error("writeBLECharacteristicValue error",e),e;Lr.debug("writeBLECharacteristicValue error retry ".concat(t),e)})),yt(100))}}),wt((function(e){return dt({error:e,success:void 0})}))),i).pipe(Se((function(t){return{seq:e.seq,apiResult:t}})),Re((function(e){return Lr.debug("write result",e)})));var t,n,r,i}))).pipe(wt((function(e){return Lr.error("Writer 发生未知异常",e),ce})))}))).subscribe((function(t){return e.writeComplete$.next(t)}))}return e.prototype.writeCharacteristicValue=function(e){var t=this.seq++;return this.write$.next({seq:t,option:e}),Jn(this.writeComplete$.pipe(oe((function(e){return e.seq===t})),Se((function(e){if(e.apiResult.error)throw e.apiResult.error;return e.apiResult.success})),mt(3e3)))},e}();function Nr(e){return function(){if(!Br)throw new Error("请先调用 initWriteCharacteristicValue");return Br}().writeCharacteristicValue(e)}var Mr=we("wxapp-bluetooth-helper/services/getCharacteristics");we("wxapp-bluetooth-helper/services/getServices");var jr,Rr,Ur,Fr,$r=we("wxapp-bluetooth-helper/services/notifyCharacteristicValueChange");function qr(){Br=new Pr}!function(e){e[e.Unknow=10001]="Unknow",e[e.BadParams=10002]="BadParams",e[e.OpenBluetoothAdapterError=10003]="OpenBluetoothAdapterError"}(jr||(jr={})),function(e){e[e.AlreadyConnected=20001]="AlreadyConnected",e[e.AlreadyConnecting=20002]="AlreadyConnecting",e[e.ConnectError=20003]="ConnectError",e[e.DisconnectError=20004]="DisconnectError",e[e.NotConnected=20005]="NotConnected",e[e.Timeout=20006]="Timeout",e[e.CancelConnect=20007]="CancelConnect"}(Rr||(Rr={})),function(e){e[e.WriteError=30001]="WriteError"}(Ur||(Ur={})),function(e){e.Error=ve()}(Fr||(Fr={}));var Vr=we("wxapp-bluetooth-helper/initBluetoothHelper"),Gr=!1;function zr(e){void 0===e&&(e={}),Vr.debug("initBluetoothHelper"),Gr||function(e){try{e.apis&&(t=e.apis,Xt=t),sr(),!e.disabledScanner&&(Tr||(Tr=new Ir)),qr()}catch(e){throw new Fr.Error("初始化未知异常",jr.Unknow)}var t}(e),Gr=!0}var Hr,Wr,Jr,Zr,Kr,Qr,Yr,Xr=tn(Ar,"scanDevices"),ei=tn(Ar,"scanDevicesObservable"),ti=function(){return ti=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ti.apply(this,arguments)};function ni(e){return ne((function(t,n){Pe(e).subscribe(re(n,(function(){return n.complete()}),P)),!n.closed&&t.subscribe(n)}))}!function(e){e.Error=ve()}(Hr||(Hr={})),function(e){e.Error=ve()}(Wr||(Wr={})),function(e){e.Error=ve()}(Jr||(Jr={})),function(e){e.Error=ve()}(Zr||(Zr={})),function(e){e.Error=ve()}(Kr||(Kr={})),function(e){e.Error=ve()}(Qr||(Qr={})),function(e){e.Error=ve()}(Yr||(Yr={}));var ri,ii=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},oi=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},ai=we("wxapp-bluetooth-helper/DeviceConnection"),ci=1,ui=function(){function e(e){var t=e.deviceId,n=this;this.state$=new te({connected:!1,connecting:!1}),this.expectConnected$=new te(!1),this.connectRequest$=new X,this.connectError$=new X,this.connectSuccess$=new X,this.createConnectionStart$=new X,this.currentRequestId$=new te(void 0),this.disconnectRequest$=new X,this.disconnected$=new X,this.changeState$=new X,this.destroy$=new X,this.deviceId=t,Ln(this.connectSuccess$.pipe(Re((function(e){var t=e.id;return ai.debug("connectDevice success id=".concat(t))}))),this.connectError$.pipe(Re((function(e){var t=e.id;return ai.debug("connectDevice error id=".concat(t))}))),this.disconnected$.pipe(Re((function(){return ai.debug("disconnected")})))).pipe(ni(this.destroy$)).subscribe(),this.changeState$.pipe(Re((function(e){return ai.debug("changeState",e)})),xn(),oe((function(e){return!e.connected})),Se((function(){})),ni(this.destroy$)).subscribe(this.disconnected$),Ln(this.connectRequest$.pipe(Se((function(){return!0}))),this.disconnectRequest$.pipe(Se((function(){return!1}))),this.connectError$.pipe(oe((function(e){var t=e.id;return n.currentRequestId$.getValue()===t})),Se((function(){return!1}))),this.disconnected$.pipe(Se((function(){return!1})))).pipe(Re((function(e){return ai.debug("expectConnected = ".concat(e))})),ni(this.destroy$)).subscribe(this.expectConnected$),this.createConnectionStart$.pipe(Se((function(e){return e.id})),Re((function(e){return ai.debug("currentRequestId = ".concat(e))})),ni(this.destroy$)).subscribe(this.currentRequestId$),Ln(this.createConnectionStart$.pipe(Se((function(){return{connected:!1,connecting:!0}}))),this.connectSuccess$.pipe(oe((function(e){var t=e.id;return n.currentRequestId$.getValue()===t})),Se((function(){return{connected:!0,connecting:!1}}))),this.connectError$.pipe(oe((function(e){var t=e.id;return n.currentRequestId$.getValue()===t})),Se((function(){return{connected:!1,connecting:!1}}))),this.disconnectRequest$.pipe(Se((function(){return{connected:!1,connecting:!1}}))),this.disconnected$.pipe(Se((function(){return{connected:!1,connecting:!1}})))).pipe(oe((function(e){var t=n.expectConnected$.getValue();return t&&(e.connected||e.connecting)||!t&&!e.connected&&!e.connecting})),ni(this.destroy$)).subscribe(this.state$),this.onStateChange$=this.state$.pipe(xn((function(e,t){return e.connecting===t.connecting&&e.connected===t.connected})),nt(),Se((function(e){return{prevState:e[0],state:e[1]}})),Re((function(e){ai.debug("连接状态变更 deviceId=".concat(n.deviceId),JSON.stringify(e))})),ni(this.destroy$),Nn()),this.connectRequest$.pipe(Re((function(){return ai.debug("connectDevice deviceId=".concat(n.deviceId))})),He((function(e){var t=e.id,r=e.option;return dt(void 0).pipe(oe((function(){var e=n.state$.getValue();if(e.connected)throw new Hr.Error("已连接",Rr.AlreadyConnected);if(e.connecting)throw new Hr.Error("连接中",Rr.AlreadyConnecting);return!0})),Re((function(){return n.createConnectionStart$.next({id:t})})),He((function(){return Xe(St(hn)({deviceId:n.deviceId,timeout:r.timeout})).pipe(Se((function(e){if(e.error){ai.debug("createBLEConnection error");var n=new Hr.Error("蓝牙连接失败",Rr.ConnectError);throw n.createBLEConnectionError=e.error,n}return ai.debug("createBLEConnection success"),{id:t}})))})),Se((function(){n.connectSuccess$.next({id:t})})),wt((function(e){var r=e;return r instanceof Hr.Error||(r=new Hr.Error("蓝牙连接失败，未知异常",jr.Unknow,{error:r})),ai.debug("connectDevice error id=".concat(t)),n.connectError$.next({id:t,error:r}),dt({id:t,error:r})})))}))).pipe(ni(this.destroy$)).subscribe()}return e.prototype.getState=function(){return this.state$.getValue()},e.prototype.connectDeviceObservable=function(e){var t=this,n=e.timeout,r=null!=n?n:1e4,i="".concat(this.deviceId,"-").concat(ci++);return Ln(this.connectError$.pipe(oe((function(e){return e.id===i})),Re((function(e){throw ai.debug("connectDeviceObservable error",e),e.error}))),this.connectSuccess$.pipe(oe((function(e){return e.id===i}))),Bn((function(){return t.connectRequest$.next({id:i,option:{timeout:r}}),ce}))).pipe(de(),Se((function(){})))},e.prototype.disconnectDevice=function(){return ii(this,void 0,void 0,(function(){var e,t,n,r;return oi(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),!(e=this.getState()).connected&&!e.connecting)throw new Wr.Error("断开连接异常, 不存在连接",Rr.DisconnectError);return this.disconnectRequest$.next(),ai.debug("closeBLEConnection deviceId=".concat(this.deviceId)),[4,St(vn)({deviceId:this.deviceId})];case 1:if((t=i.sent()).error)throw new Wr.Error("断开连接, closeBLEConnection 发生异常",Rr.DisconnectError,{error:t.error});return ai.debug("closeBLEConnection success",t),[2,t];case 2:throw n=i.sent(),(r=n)instanceof Hr.Error||(r=new Hr.Error("连接失败，未知异常",jr.Unknow,{error:r})),r;case 3:return[2]}}))}))},e.prototype.onStateChangeObservable=function(){return this.onStateChange$},e.prototype.changeState=function(e){var t=e.connected;ai.debug("changeState",t),this.changeState$.next({connected:t})},e.prototype.destroy=function(){ai.debug("destroy"),this.destroy$.next(),this.destroy$.complete()},e}(),si=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},li=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},fi=we("wxapp-bluetooth-helper/DeviceConnectionManager"),di=function(){function e(){var e=this;this.deviceConnectionMap=new Map,this.connectionStateChange$=new X,br({onChange:function(t){fi.debug("onBluetoothAdapterAvailableChange: ".concat(JSON.stringify(t))),t||Array.from(e.deviceConnectionMap.values()).forEach((function(e){e.changeState({connected:!1})}))}}),lr({immediate:!0}).pipe(Me((function(e){return e?_e(dn,pn):je}))).pipe(Re((function(t){fi.debug("onBLEConnectionStateChange: ".concat(JSON.stringify(t)));var n=e.deviceConnectionMap.get(t.deviceId);n&&n.changeState({connected:t.connected})}))).subscribe()}return e.prototype.connectDevice=function(e){var t=e.deviceId,n=e.timeout;return si(this,void 0,void 0,(function(){var e,r=this;return li(this,(function(i){return fi.debug("connectDevice deviceId=".concat(t)),(e=this.deviceConnectionMap.get(t))||((e=new ui({deviceId:t})).onStateChangeObservable().subscribe((function(e){return r.connectionStateChange$.next({deviceId:t,state:e.state,prevState:e.prevState})})),this.deviceConnectionMap.set(t,e)),[2,Jn(e.connectDeviceObservable({timeout:n}))]}))}))},e.prototype.disconnectDevice=function(e){var t=e.deviceId;return si(this,void 0,void 0,(function(){var e;return li(this,(function(n){switch(n.label){case 0:return fi.debug("disconnectDevice deviceId=".concat(t)),(e=this.deviceConnectionMap.get(t))?[4,e.disconnectDevice()]:[2];case 1:return n.sent(),[2]}}))}))},e.prototype.getConnectionState=function(e){var t,n=e.deviceId;try{var r=this.deviceConnectionMap.get(n);return null!==(t=null==r?void 0:r.getState())&&void 0!==t?t:{connecting:!1,connected:!1}}catch(e){throw new Kr.Error("获取设备连接状态，未知异常",jr.Unknow,{error:e})}},e.prototype.onConnectionStateChange=function(e){var t=e.deviceId,n=e.onStateChange;try{var r=this.onConnectionStateChangeObservable({deviceId:t}).subscribe((function(e){var t=e.deviceId,r=e.state,i=e.prevState;return n({deviceId:t,connected:r.connected,connecting:r.connecting},{deviceId:t,connected:i.connected,connecting:i.connecting})}));return function(){r.unsubscribe()}}catch(e){throw new Jr.Error("监听连接状态失败，未知异常",jr.Unknow,{error:e})}},e.prototype.onConnectionConnectedChangeObservable=function(e){var t=(void 0===e?{}:e).deviceId;return this.onConnectionStateChangeObservable({deviceId:t}).pipe(oe((function(e){var t=e.state,n=e.prevState;return t.connected!==n.connected})),Se((function(e){return{deviceId:e.deviceId,connected:e.state.connected}})))},e.prototype.onConnectionConnectedChange=function(e){var t=e.deviceId,n=e.onConnectedChange,r=this.onConnectionConnectedChangeObservable({deviceId:t}).subscribe((function(e){return n(e)}));return function(){r.unsubscribe()}},e.prototype.getConnectedDevices=function(){return Array.from(this.deviceConnectionMap.values()).filter((function(e){return e.getState().connected})).map((function(e){return{deviceId:e.deviceId}}))},e.prototype.getLatestConnectedDevices=function(e){var t=e.services;return si(this,void 0,void 0,(function(){var e;return li(this,(function(n){switch(n.label){case 0:return[4,St(yn)({services:t})];case 1:if((e=n.sent()).error)throw new Yr.Error("获取失败",jr.Unknow,{error:e.error});return fi.debug("获取最新已连接设备",e.success.devices),[2,e.success.devices]}}))}))},e.prototype.onConnectionStateChangeObservable=function(e){var t=(void 0===e?{}:e).deviceId,n=this.connectionStateChange$;return t?n.pipe(oe((function(e){return e.deviceId===t}))):n},e}();function pi(){return ri||(ri=new di),ri}var hi=tn(pi,"connectDevice"),vi=tn(pi,"disconnectDevice"),yi=tn(pi,"getConnectionState"),gi=(tn(pi,"onConnectionStateChange"),tn(pi,"onConnectionStateChangeObservable")),mi=tn(pi,"onConnectionConnectedChange"),bi=(tn(pi,"onConnectionConnectedChangeObservable"),tn(pi,"getConnectedDevices"),tn(pi,"getLatestConnectedDevices"));function wi(e){var t,n,r={errCode:0,errMsg:"ok"};null===(t=e.success)||void 0===t||t.call(e,r),null===(n=e.complete)||void 0===n||n.call(e,r)}function Si(e,t){var n,r,i,o,a={errCode:null!==(n=null==e?void 0:e.errCode)&&void 0!==n?n:10008,errMsg:null!==(r=null==e?void 0:e.errMsg)&&void 0!==r?r:"其余所有系统上报的异常"};null===(i=t.fail)||void 0===i||i.call(t,a),null===(o=t.complete)||void 0===o||o.call(t,a)}var Ii=function(){return Ii=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ii.apply(this,arguments)};function Ci(){var e={};function n(n,r){return{on:function(r){if(!e[n])return e[n]=r,void t[n]((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e[n].apply(e,t)}));e[n]=r},off:function(){e[n]&&t[r](e[n])}}}var r,i,o,a,c=n("onBluetoothAdapterStateChange","offBluetoothAdapterStateChange"),u=n("onBLECharacteristicValueChange","offBLECharacteristicValueChange");return Ii(Ii(Ii(Ii({},t),{onBLEConnectionStateChange:function(e){null==a||a(),a=void 0,a=mi({onConnectedChange:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(void 0,t)}})},offBLEConnectionStateChange:function(e){null==a||a(),a=void 0},createBLEConnection:function(e){hi({deviceId:e.deviceId,timeout:e.timeout}).then((function(){wi(e)})).catch((function(t){return(null==t?void 0:t.createBLEConnectionError)?Si(t.createBLEConnectionError,e):Si({errMsg:null==t?void 0:t.message},e)}))},closeBLEConnection:function(e){vi({deviceId:e.deviceId}).then((function(){wi(e)})).catch((function(t){return Si({errMsg:null==t?void 0:t.message},e)}))}}),(o=new X,{startBluetoothDevicesDiscovery:function(e){r&&(r(),r=void 0),r=Xr(ti(ti({},e),{onDeviceFound:function(e){o.next(e)}})),setTimeout((function(){var t,n,r={errCode:0,errMsg:"ok"};null===(t=e.success)||void 0===t||t.call(e,r),null===(n=e.complete)||void 0===n||n.call(e,r)}),0)},stopBluetoothDevicesDiscovery:function(e){r&&(r(),r=void 0),setTimeout((function(){var t,n,r={errCode:0,errMsg:"ok"};null===(t=null==e?void 0:e.success)||void 0===t||t.call(e,r),null===(n=null==e?void 0:e.complete)||void 0===n||n.call(e,r)}),0)},onBluetoothDeviceFound:function(e){i=o.subscribe((function(t){e({devices:[t.device]})}))},offBluetoothDeviceFound:function(){null==i||i.unsubscribe()}})),{writeBLECharacteristicValue:function(e){Nr({deviceId:e.deviceId,serviceId:e.serviceId,characteristicId:e.characteristicId,value:e.value}).then((function(){wi(e)})).catch((function(t){return Si(t,e)}))},onBluetoothAdapterStateChange:c.on,offBluetoothAdapterStateChange:c.off,onBLECharacteristicValueChange:u.on,offBLECharacteristicValueChange:u.off})}var _i=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},Di="DeviceSdk",Ti={loggerMethod:function(e){for(var t=e.methodName,n=e.loggerName,r=e.loggingMethod,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];r.apply(void 0,be.apply(void 0,_i([{methodName:t,loggerName:n}],i,!1)))}};function Ei(e){!function(e,t){var n=(void 0===t?{}:t).filter,r=ge().getLoggers(),i=Object.keys(r);n&&(i=i.filter(n)),i.forEach((function(t){var n;null===(n=r[t])||void 0===n||n.setLevel(e,!1)}))}(e,{filter:function(e){return e.startsWith("".concat(Di,"/"))}})}function Ai(e){var t=(0,ye.getLogger)("".concat(Di,"/").concat(e)),n=t.methodFactory;return t.methodFactory=function(e,t,r){var i=n(e,t,r);return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];Ti.loggerMethod.apply(Ti,_i([{methodName:e,logLevel:t,loggerName:r,loggingMethod:i}],n,!1))}},t}var xi=n(737);function Oi(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e();return t(i).bind(i).apply(void 0,n)}}function ki(e){return null!=e}function Bi(e,t){var n=C(e)?e:function(){return e},r=function(e){return e.error(n())};return new K(t?function(e){return t.schedule(r,0,e)}:r)}function Li(e){return ne((function(t,n){try{t.subscribe(n)}finally{n.add(e)}}))}var Pi,Ni=n(398),Mi=n.n(Ni);var ji=function(){return ji=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ji.apply(this,arguments)};function Ri(e){var t=function(e){return ei(ji(ji({},e),{services:f}))}(e).subscribe();return function(){return t.unsubscribe()}}var Ui,Fi,$i,qi,Vi=function(){return Vi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vi.apply(this,arguments)};function Gi(){var e,t=Ci();return Vi(Vi({},t),{startBluetoothDevicesDiscovery:function(t){e&&(e(),e=void 0),e=Ri(t),setTimeout((function(){var e,n,r={errCode:0,errMsg:"ok"};null===(e=t.success)||void 0===e||e.call(t,r),null===(n=t.complete)||void 0===n||n.call(t,r)}),0)},stopBluetoothDevicesDiscovery:function(t){e&&(e(),e=void 0),setTimeout((function(){var e,n,r={errCode:0,errMsg:"ok"};null===(e=null==t?void 0:t.success)||void 0===e||e.call(t,r),null===(n=null==t?void 0:t.complete)||void 0===n||n.call(t,r)}),0)},openBluetoothAdapter:function(e){setTimeout((function(){var t,n;console.error("openBluetoothAdapter",e);var r={errCode:0,errMsg:"ok"};null===(t=null==e?void 0:e.success)||void 0===t||t.call(e,r),null===(n=null==e?void 0:e.complete)||void 0===n||n.call(e,r)}),0)},closeBluetoothAdapter:function(e){setTimeout((function(){var t,n;console.error("openBluetoothAdapter",e);var r={errCode:0,errMsg:"ok"};null===(t=null==e?void 0:e.success)||void 0===t||t.call(e,r),null===(n=null==e?void 0:e.complete)||void 0===n||n.call(e,r)}),0)}})}function zi(){return Gi().getSystemInfoSync().platform}function Hi(){return zi()===Ui.Ios}!function(e){e.Ios="ios",e.Android="android"}(Ui||(Ui={})),function(e){e.Error=ve()}(Fi||(Fi={})),function(e){e.Error=ve()}($i||($i={})),function(e){e.Error=ve()}(qi||(qi={}));var Wi,Ji=function(){return Ji=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ji.apply(this,arguments)};function Zi(e){(function(){if(!Wi)throw new Error("请先调用 initRemoveDevice");return Wi})().next(e)}var Ki,Qi=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},Yi=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Xi=Ai("internal/deviceStorage/deviceStorage"),eo="devicInfo";function to(){if(!Ki)throw new Error("请先调用 initDeviceStorage");return Ki}function no(){Ki=new te({}),function(){return Qi(this,void 0,void 0,(function(){var e,t;return Yi(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Gi().getStorage({key:eo})];case 1:return e=n.sent(),t=e||{},Xi.debug("getStorage",t),[2,t];case 2:return n.sent(),[2,{}];case 3:return[2]}}))}))}().then((function(e){Xi.info("初始化设备数据缓存",e),null==Ki||Ki.next(e),null==Ki||Ki.pipe(kn(1)).subscribe((function(e){!function(e){Xi.debug("setStorage",e),Gi().setStorage({key:eo,data:e})}(e)}))})),function(){ro=new X;var e=to();ro.pipe(Ge(e,(function(e,t){return{device:e,deviceStorage:t}})),Se((function(e){var t,n=e.device,r=e.deviceStorage;return io(io({},r),((t={})[n.deviceId]=io(io({},r[n.deviceId]),n),t))}))).subscribe(e)}(),function(){Wi=new X;var e=to();Wi.pipe(Ge(e,(function(e,t){return{device:e,deviceStorage:t}})),Se((function(e){var t=e.device,n=e.deviceStorage;return Object.keys(n).reduce((function(e,r){var i,o=n[r];return t.deviceId&&t.deviceId===o.deviceId||t.deviceId&&t.deviceId===o.deviceId?e:Ji(Ji({},e),((i={})[r]=o,i))}),{})}))).subscribe(e)}()}var ro,io=function(){return io=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},io.apply(this,arguments)};function oo(e){(function(){if(!ro)throw new Error("请先调用 initSaveDevice");return ro})().next(e)}function ao(){var e=to().getValue();return Object.values(e)}var co,uo=Ai("internal/deviceMac");function so(){if(!co)throw new Error("请先调用 initDeviceMacInfo");return co}var lo=new X,fo=new X;function po(e){lo.next(e)}function ho(){return so().getValue()}function vo(e){if(!e.deviceId&&!e.mac)throw new Error("getDeviceMacInfo: deviceId 和 mac 必须传一个");return ho().find((function(t){return!(!e.deviceId||e.deviceId!==t.deviceId)||!(!e.mac||e.mac!==t.mac)}))}var yo=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},go=new Map,mo=Ai("internal/scanDevice/scanDevice");function bo(e){mo.debug("scanDeviceObservable",e);var t=e.timeout,n=e.mac,r=e.first,i=e.deviceName,o=e.allowDuplicatesKey,a=e.services,c=ei({allowDuplicatesKey:null==o||o,powerLevel:"high",services:null!=a?a:f}).pipe(oe((function(e){return(null!=i?i:d).includes(e.device.name)||(null!=i?i:d).includes(e.device.localName)})),Se((function(e){return function(e){var t=e.name,n=e.localName;if(t&&n){var r=e.serviceData,i=e.advertisServiceUUIDs||[],o=(0,xi.parseAdvertisData)(e.advertisData),a=null==o?void 0:o.mac;return r&&Object.keys(r).forEach((function(e){if(e.toUpperCase().indexOf("3802")>-1){var t=r[e];t.byteLength&&t.byteLength>0&&(a=kr(t))}})),a&&(a=a.toUpperCase()),{name:e.name,localName:e.localName,deviceId:e.deviceId,advertisData:e.advertisData,serviceUUIDs:i,serviceData:r,RSSI:e.RSSI,mac:a,timestamp:new Date}}}(e.device)})),oe(ki),oe((function(e){return!!e.mac})),Re((function(e){go.set(e.mac,e),e.mac&&po({deviceId:e.deviceId,mac:e.mac})})));return n&&(c=c.pipe(oe((function(e){return n===e.mac})))),r&&(c=c.pipe(de())),t&&(c=c.pipe(mt(t))),c}function wo(e){var t=null!=e?e:{},n=t.onDeviceFound,r=bo(yo(t,["onDeviceFound"])).subscribe((function(e){return null==n?void 0:n(e)}));return function(){return r.unsubscribe()}}function So(){return Array.from(go.values())}function Io(e,t,n,r,i){return function(o,a){var c=n,u=t,s=0;o.subscribe(re(a,(function(t){var n=s++;u=c?e(u,t,n):(c=!0,t),r&&a.next(u)}),i&&function(){c&&a.next(u),a.complete()}))}}function Co(e,t){return ne(Io(e,t,arguments.length>=2,!1,!0))}var _o,Do=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},To=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};!function(e){e.Error=ve()}(_o||(_o={}));var Eo=Ai("internal/deviceConnection/sdkConnection");function Ao(e){var t=e.deviceId,n=e.timeout,r=null!=n?n:1e4;return Eo.info("发起连接设备, deviceId=".concat(t)),new K((function(e){var n=!1;return xi.BLEManager.connectDevice(t,r).then((function(r){return r.success?(n=!0,Eo.debug("BLEManager 连接设备: 连接成功, deviceId=".concat(t)),e.next(),void e.complete()):Promise.reject(r)}),(function(r){n=!0,Eo.debug("BLEManager 连接设备: 连接失败, deviceId=".concat(t)),e.error(new Fi.Error("连接设备未知异常",a.Unknow,r))})),function(){n||(Eo.info("BLEManager 连接设备:  取消连接，deviceId=".concat(t,", 执行 disconnectDevice")),xo(t))}}))}function xo(e){return Eo.debug("断开连接 deviceId=".concat(e)),xi.BLEManager.disconnectDevice(e)}var Oo=Ai("internal/deviceConnection/findDevice/FindDeviceByConnectedDevices"),ko=function(){function e(){this.findDeviceMacs=[],this.readDeviceInfoMap=new Map,this.connectedDeviceLoop$=Zn(1e3).pipe(He((function(){return Xe(bi({services:f}))})),Re((function(e){return Oo.debug("getLatestConnectedDevices",e)})),Nn())}return e.prototype.getDeviceMac=function(e){var t=this;return dt(e.connectedDevice).pipe(Re((function(e){return Oo.debug("deviceConnection",e)})),xr((function(e){return e.deviceId})),He((function(e){return e.pipe(Se((function(e){return{deviceConnection:e,deviceMacInfo:vo({deviceId:e.deviceId})}})),Re((function(e){return Oo.debug("getLatestConnectedDevices and deviceMacInfo",e)})),He((function(e){var n=e.deviceConnection,r=e.deviceMacInfo;return r?(Oo.debug("从缓存中获取到 mac 信息 mac=".concat(r.mac)),dt({deviceId:n.deviceId,mac:r.mac})):t.connectAndReadDeviceInfoObservable({deviceId:n.deviceId})})),de())})))},e.prototype.findDevice=function(e){var t=this,n=e.mac;return this.findDeviceMacs.push(n),this.connectedDeviceLoop$.pipe(We(),He((function(e){return t.getDeviceMac({connectedDevice:e})})),oe((function(e){return e.mac===n})),de())},e.prototype.getMobileDeviceMac=function(){var e=this;return Jn(this.connectedDeviceLoop$.pipe(de(),We(),Re((function(e){Oo.debug("connectedDevice",e)})),He((function(t){return e.getDeviceMac({connectedDevice:t})})),Co((function(e,t){return e.push({mac:t.mac}),e}),[])))},e.prototype.connectAndReadDeviceInfoObservable=function(e){var t=this,n=e.deviceId,r=this.readDeviceInfoMap.get(n);return r||(r=function(e){var t=e.deviceId;return new K((function(e){dt(1).pipe(He((function(){return Oo.debug("连接设备进行获取 mac 信息 deviceId=".concat(t," 开始")),Ao({deviceId:t})})),He((function(){return Oo.debug("连接设备进行获取 mac 信息 deviceId=".concat(t," 连接成功")),Xe(function(e){var t,n,r=e.deviceId;return Do(this,void 0,void 0,(function(){var e;return To(this,(function(i){switch(i.label){case 0:return[4,xi.BLEManager.readDeviceInfo(r).then((function(e){return{deviceInfo:e}})).catch((function(e){return{error:e}}))];case 1:if((e=i.sent())&&"error"in e)throw new _o.Error((null===(t=e.error)||void 0===t?void 0:t.msg)||(null===(n=e.error)||void 0===n?void 0:n.errMsg)||"读取设备信息失败",a.Unknow,{error:e.error});return[2,e.deviceInfo]}}))}))}({deviceId:t})).pipe(Or(1))})),Re((function(e){return Oo.debug("连接设备进行获取 mac 信息 deviceId=".concat(t," 获取设备信息成功"),e)})),Se((function(e){return{mac:e.sn}})),Se((function(e){return{deviceId:t,mac:e.mac}})),wt((function(e){throw xo(t),e}))).subscribe(e)}))}({deviceId:n}).pipe(Re((function(e){var r=e.mac;po({deviceId:n,mac:r,saveToStorage:!0}),t.findDeviceMacs.includes(r)||xo(n)})),Li((function(){t.readDeviceInfoMap.delete(n)})),Nn()),this.readDeviceInfoMap.set(n,r)),r},e}();var Bo,Lo=function(){return Lo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Lo.apply(this,arguments)},Po=Ai("internalapis/deviceConnection/findDevice"),No=function(){function e(){this.findDeviceByConnectedDevices=new ko}return e.prototype.findDeviceObservable=function(e){var t=e.mac,n=e.timeout;Po.debug("start findDeviceId mac=".concat(t));var r=Ln(Hi()?this.findDeviceByConnectedDevices.findDevice({mac:t}).pipe(Se((function(e){return Lo(Lo({},e),{connected:!0})}))):ce,this.findDeviceByScan({mac:t}).pipe(Se((function(e){return Lo(Lo({},e),{connected:!1})})))).pipe(de(),Re((function(e){po({deviceId:e.deviceId,mac:t,saveToStorage:!0})})));return n&&(r=r.pipe(mt(n))),r},e.prototype.getMobileDeviceMac=function(){return this.findDeviceByConnectedDevices.getMobileDeviceMac()},e.prototype.findDeviceByScan=function(e){var t=e.mac;return dt(1).pipe(Re((function(){return Po.info("通过扫描查找设备 开始, mac=".concat(t))})),He((function(){return bo({mac:t,first:!0})})),Se((function(e){return{mac:t,deviceId:e.deviceId}})),Re((function(e){Po.info("通过扫描查找设备 找到设备, mac=".concat(t),e)})))},e}();function Mo(){if(!Bo)throw new Error("请先调用 initFindDevice");return Bo}var jo=Oi(Mo,(function(e){return e.findDeviceObservable})),Ro=Oi(Mo,(function(e){return e.getMobileDeviceMac})),Uo=function(){return Uo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Uo.apply(this,arguments)};var Fo=function(){return Fo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Fo.apply(this,arguments)},$o=Ai("internal/deviceConnection/DeviceConnection"),qo=function(){function e(e){var t=e.mac,n=this;this.connectRequest$=new X,this.connectError$=new X,this.connectSuccess$=new X,this.destroy$=new X,this.disconnectRequest$=new X,this.bleDisconnected$=new X,this.mac=t;var r=vo({mac:t}),i=null==r?void 0:r.deviceId;this.state$=new te(i?yi({deviceId:i}):{connected:!1,connecting:!1}),Ln(this.connectRequest$.pipe(Se((function(){return{connected:!1,connecting:!0}}))),this.connectSuccess$.pipe(Se((function(){return{connected:!0,connecting:!1}}))),this.connectError$.pipe(Se((function(){return{connected:!1,connecting:!1}}))),this.bleDisconnected$.pipe(Se((function(){return{connected:!1,connecting:!1}})))).pipe(ni(this.destroy$)).subscribe(this.state$),this.onStateChange$=this.state$.pipe(xn((function(e,t){return e.connecting===t.connecting&&e.connected===t.connected})),nt(),Se((function(e){return{prevState:e[0],state:e[1]}})),Re((function(e){$o.debug("连接状态变更 mac=".concat(n.mac),JSON.stringify(e))})),ni(this.destroy$),Nn()),function(e){var t=e.mac;return gi().pipe(Se((function(e){return Uo(Uo({},e),{deviceMacInfo:vo({deviceId:e.deviceId})})})),oe((function(e){var n;return!t||t===(null===(n=e.deviceMacInfo)||void 0===n?void 0:n.mac)})))}({mac:t}).pipe(oe((function(e){return e.prevState.connected&&!e.state.connected})),Se((function(){})),ni(this.destroy$),Re((function(){return $o.debug("连接已断开 mac=".concat(n.mac))}))).subscribe(this.bleDisconnected$)}return e.prototype.connectObservable=function(e){var t=this,n=e.timeout,r=Hi(),i=null!=n?n:1e4,o=!1,c=!1,s=dt(void 0).pipe(Re((function(){$o.info("连接设备 mac=".concat(t.mac," 开始，timeout=").concat(n))})),oe((function(){if(t.state$.getValue().connecting)throw new Fi.Error("连接设备 mac=".concat(t.mac,"，正在连接中"),u.AlreadyConnecting);if(t.state$.getValue().connected)throw new Fi.Error("连接设备 mac=".concat(t.mac,"，当前已连接"),u.AlreadyConnected);return!0})),He((function(){return t.connectRequest$.next(),!r||function(){var e;return null!=Pi||(Pi="wxwork"===(null===(e=Mi().getSystemInfoSync())||void 0===e?void 0:e.environment)),Pi}()?dt(void 0):function(e){var t=e.mac;return dt(1).pipe(Re((function(){return $o.debug("通过 mac 从设备缓存中查找是否找到对应设备缓存")})),Se((function(){return vo({mac:t})})),Re((function(e){return $o.debug("findByDeviceMacInfo result",e)})),Se((function(e){if(e)return{deviceId:e.deviceId}})))}({mac:t.mac}).pipe(Re((function(e){e?$o.info("通过 mac 从设备缓存中找到对应设备, mac=".concat(t.mac,", deviceId=").concat(e.deviceId)):$o.info("通过 mac 从设备缓存中找不到对应设备, mac=".concat(t.mac))})))})),He((function(e){return e?dt(Fo(Fo({},e),{connected:!1})):jo({mac:t.mac}).pipe(wt((function(e){throw $o.error("连接设备 mac=".concat(t.mac,"，查找设备过程发生异常"),e),new Fi.Error("连接设备 mac=".concat(t.mac,"，查找设备过程发生异常"),a.Unknow,{error:e})})))})),He((function(e){var n=e.deviceId,r=e.connected;return o=!0,r?dt(void 0):($o.info("连接设备 mac=".concat(t.mac,"， 找到 deviceId=").concat(n," 发起连接")),c=!0,Ao({deviceId:n}).pipe(wt((function(e){throw new Fi.Error("连接设备 mac=".concat(t.mac,"，创建连接发生异常"),a.Unknow,{error:e})}))))})),mt({each:i,with:function(){return Bi((function(){return o?new Fi.Error("连接设备 mac=".concat(t.mac,"，超时"),u.Timeout):new Fi.Error("连接设备 mac=".concat(t.mac,"，找不到目标设备"),u.NotFoundDevice)}))}}),wt((function(e){if(e instanceof Fi.Error)throw e;throw $o.error("连接设备 mac=".concat(t.mac,"，未知异常"),e),new Fi.Error("连接设备 mac=".concat(t.mac,"，未知异常"),a.Unknow,{error:e})})));return s.pipe(Re((function(){$o.debug("连接成功 mac=".concat(t.mac)),t.connectSuccess$.next()})),Li((function(){t.getState().connected||(c&&t.disconnect(),t.connectError$.next())})),ni(this.disconnectRequest$),ni(this.destroy$))},e.prototype.disconnect=function(){try{this.disconnectRequest$.next();var e=vo({mac:this.mac});if(!e)throw new $i.Error("连接设备 mac=".concat(this.mac,"，传入的 mac 没找到对应 deviceId"),u.NotConnected);return xo(e.deviceId)}catch(e){if(e instanceof $i.Error)throw e;throw new $i.Error("断开连接未知异常 mac=".concat(this.mac),a.Unknow)}},e.prototype.getState=function(){return this.state$.getValue()},e.prototype.onStateChangeObservable=function(){return this.onStateChange$},e.prototype.destroy=function(){this.destroy$.next(),this.destroy$.complete()},e}();var Vo,Go=function(){return Go=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Go.apply(this,arguments)},zo=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Ho=Ai("internal/deviceConnection/DeviceConnectionManager"),Wo=function(){function e(){this.deviceConnectionMap=new Map,this.connectionStateChange$=new X}return e.prototype.connectDeviceObservable=function(e){var t=e.mac,n=zo(e,["mac"]);return this.getAndInitDeviceConnection(t).connectObservable(n)},e.prototype.connectDevice=function(e){return Ho.debug("connectDevice mac=".concat(e.mac)),Jn(this.connectDeviceObservable(e))},e.prototype.disconnectDevice=function(e){var t=e.mac;Ho.debug("disconnectDevice mac=".concat(t));var n=this.getDeviceConnection(t);if(!n)throw new $i.Error("未连接",u.NotConnected);return n.disconnect()},e.prototype.getConnectionState=function(e){var t,n=e.mac,r=this.getDeviceConnection(n);return null!==(t=null==r?void 0:r.getState())&&void 0!==t?t:{connected:!1,connecting:!1}},e.prototype.onConnectionStateChangeObservable=function(e){var t=e.mac;return this.connectionStateChange$.pipe(oe((function(e){return!t||t===e.mac})),Re((function(e){return Ho.debug("连接状态变更",JSON.stringify(e))})))},e.prototype.onConnectionStateChange=function(e){var t=null!=e?e:{},n=t.onChange,r=zo(t,["onChange"]),i=this.onConnectionStateChangeObservable(Go({},r)).subscribe((function(e){return null==n?void 0:n(e)}));return function(){return i.unsubscribe()}},e.prototype.onConnectionConnectedChangeObservalbe=function(e){return this.onConnectionStateChangeObservable(e).pipe(oe((function(e){return e.prevState.connected!==e.state.connected})),Se((function(e){return{mac:e.mac,connected:e.state.connected}})),Re((function(e){return Ho.debug("已连接状态变更",JSON.stringify(e))})))},e.prototype.onConnectionConnectedChange=function(e){var t=e.onChange,n=zo(e,["onChange"]),r=this.onConnectionConnectedChangeObservalbe(Go({},n)).subscribe((function(e){return t(e)}));return function(){return r.unsubscribe()}},e.prototype.getConnectedDevices=function(){return Array.from(this.deviceConnectionMap.values()).map((function(e){return e.getState().connected?e.mac:void 0})).filter(ki)},e.prototype.getDeviceConnection=function(e){return this.deviceConnectionMap.get(e)},e.prototype.getAndInitDeviceConnection=function(e){var t=this,n=this.getDeviceConnection(e);if(n)return n;Ho.debug("创建新连接 mac=".concat(e));var r=new qo({mac:e});return r.onStateChangeObservable().pipe(Se((function(t){return Go({mac:e},t)})),Re((function(n){Ho.debug("onStateChangeObservable mac=".concat(e),JSON.stringify(n)),t.connectionStateChange$.next(n)}))).subscribe(),r.onStateChangeObservable().pipe(oe((function(e){return!e.state.connecting&&!e.state.connected})),Me((function(){return vt(3e3)})),oe((function(){var e=r.getState();return!e.connecting&&!e.connected}))).subscribe((function(){Ho.debug("销毁连接 mac=".concat(e)),r.destroy(),t.deviceConnectionMap.delete(e)})),this.deviceConnectionMap.set(e,r),r},e}();function Jo(){Bo=new No,Vo=new Wo}function Zo(){if(!Vo)throw new Error("请先调用 initDeviceConnection");return Vo}var Ko,Qo,Yo,Xo,ea,ta,na=Oi(Zo,(function(e){return e.connectDevice})),ra=Oi(Zo,(function(e){return e.connectDeviceObservable})),ia=Oi(Zo,(function(e){return e.disconnectDevice})),oa=Oi(Zo,(function(e){return e.getConnectionState})),aa=Oi(Zo,(function(e){return e.onConnectionStateChange})),ca=Oi(Zo,(function(e){return e.onConnectionStateChangeObservable})),ua=Oi(Zo,(function(e){return e.onConnectionConnectedChange})),sa=Oi(Zo,(function(e){return e.onConnectionConnectedChangeObservalbe})),la=Oi(Zo,(function(e){return e.getConnectedDevices}));function fa(e){return{type:null==e?void 0:e.Spo2Type,switch:1===(null==e?void 0:e.Spo2Switch),interval:null==e?void 0:e.Spo2Interval}}function da(e){return{Spo2Type:e.type,Spo2Switch:e.switch?1:0,Spo2Interval:e.interval}}function pa(e){return e}function ha(e){return e}function va(e){return e}function ya(e){return e}function ga(e){return e}function ma(e){return e}function ba(e){return{fileType:e.fileType,filename:e.fileName}}function wa(e){return e}function Sa(e){return e}function Ia(e){return e}function Ca(e){var t=e.dataType,n=e.recordType;if(t===Xo.RestingHeartRate&&n!==Yo.Recent)throw new Error("dataType=".concat(t,", recordType=").concat(n,", dataType=5(静息心率) 此时 recordType, 只能 0(近期记录)有效"));return{DataType:t,RecordType:n}}function _a(e){return e}function Da(e){return e}function Ta(e){return{SportIds:e.sportId}}function Ea(e){var t,n;return{StartTime:Math.round((null!==(t=e.startTime)&&void 0!==t?t:(new Date).getTime())/1e3),EndTime:Math.round((null!==(n=e.endTime)&&void 0!==n?n:(new Date).getTime())/1e3)}}function Aa(e){var t;return{sportIds:null!==(t=null==e?void 0:e.SportIds)&&void 0!==t?t:[]}}function xa(e){var t,n,r;return{HrSwitch:e.hrSwitch,HrInterval:null!==(t=e.hrInterval)&&void 0!==t?t:300,HrDailyWarnEn:e.hrDailyWarnSwitch,HrDailyWarnVal:null!==(n=e.hrDailyWarnValue)&&void 0!==n?n:60,HrSportWarnEn:e.hrSportWarnSwitch,HrSportWarnVal:null!==(r=e.hrSportWarnValue)&&void 0!==r?r:120}}function Oa(e){return{hrSwitch:e.HrSwitch,hrInterval:e.HrInterval,hrDailyWarnSwitch:e.HrDailyWarnEn,hrDailyWarnValue:e.HrDailyWarnVal,hrSportWarnSwitch:e.HrSportWarnEn,hrSportWarnValue:e.HrSportWarnVal}}!function(e){e[e.SleepBloodOxygen=0]="SleepBloodOxygen",e[e.AllDayBloodOxygen=1]="AllDayBloodOxygen"}(Ko||(Ko={})),function(e){e[e.Log=1]="Log",e[e.WatchFace=2]="WatchFace",e[e.Hr=3]="Hr",e[e.Spo2=4]="Spo2",e[e.Sleep=5]="Sleep",e[e.SportReport=6]="SportReport",e[e.DailyActivity=7]="DailyActivity",e[e.SportHr=8]="SportHr",e[e.DailyActivitySummary=12]="DailyActivitySummary",e[e.RestingHr=13]="RestingHr"}(Qo||(Qo={})),function(e){e[e.Recent=0]="Recent",e[e.History=1]="History",e[e.SpotTest=2]="SpotTest"}(Yo||(Yo={})),function(e){e[e.Hr=0]="Hr",e[e.BloodOxygen=1]="BloodOxygen",e[e.Sleep=2]="Sleep",e[e.DailyActivity=3]="DailyActivity",e[e.DailyActivityAndStatus=4]="DailyActivityAndStatus",e[e.RestingHeartRate=5]="RestingHeartRate"}(Xo||(Xo={})),function(e){e[e.BeforeSleep=1]="BeforeSleep"}(ea||(ea={})),function(e){e[e.Invalid=0]="Invalid",e[e.Closed=1]="Closed",e[e.Opened=2]="Opened"}(ta||(ta={}));var ka,Ba,La,Pa,Na=function(){return Na=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Na.apply(this,arguments)};function Ma(e){if(e){var t=function(e){if(!e||e.byteLength<=0)return[];var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e,e.byteLength));for(var n=new DataView(t.buffer),r=n.byteLength,i=[],o=0;o<r;o++){var a=n.getUint8(o);i.push(a)}return i}(e.sleepDetail);return Na(Na({},e),{sleepDetail:t})}}function ja(e){var t=0,n=e.length;if(n%2==0){n/=2;for(var r=[],i=0;i<n;i++){var o=e.substr(t,2),a=parseInt(o,16);r.push(a),t+=2}return r}}function Ra(e,t){if(!e)return"";for(var n="",r=0;r<t-e.length;r++)n+="0";return n+=e}function Ua(e){if(65535!==e){var t=ja(Ra(e.toString(16),4));if(t){var n=t;return{hour:n[0],minute:n[1]}}}}function Fa(e){if(!e)return parseInt("ffff",16);var t=[e.hour,e.minute].map((function(e){return e.toString(16)})).map((function(e){return Ra(e,2)})).join("");return parseInt(t,16)}function $a(e){var t,n;return{Enable:e.enable?1:0,ThresholdValue:{Duration:e.thresholdValue.duration,Step:e.thresholdValue.step},TimeSets:null!==(n=null===(t=e.timeSets)||void 0===t?void 0:t.map((function(e){return{StartTime:Fa(e.startTime),EndTime:Fa(e.endTime)}})))&&void 0!==n?n:[]}}function qa(e){var t,n;return{enable:1===e.Enable,thresholdValue:{duration:e.ThresholdValue.Duration,step:e.ThresholdValue.Step},timeSets:null!==(n=null===(t=e.TimeSets)||void 0===t?void 0:t.map((function(e){var t=Ua(e.StartTime),n=Ua(e.EndTime);if(t&&n)return{startTime:t,endTime:n}})).filter((function(e){return!!e})))&&void 0!==n?n:[]}}function Va(e){return{StateCode:e.stateCode,TimesTamp:e.timesTamp,Speed:e.speed,InvertSpeed:e.invertSpeed,Altitude:e.altitude,Distance:e.distance,Longitude:e.longitude,latitude:e.latitude,precision:e.precision}}function Ga(e){var t,n,r=e.SleepSchedule,i=r.FallAsleepRemindSet,o=i?{remindSwitch:1===i.RemindSwitch,remindTime:Ua(i.RemindTime),remindCycle:(n=i.RemindCycleMaskFlag,Ra(Number(n).toString(2).slice(0,7),7).split("").reverse().map((function(e,t){return 1===Number(e)?t+1:void 0})).filter((function(e){return!!e})))}:void 0;return{sleepSwitch:1===e.SleepSwitch,sleepScheduleEnabled:e.SleepScheduleEn,sleepSchedule:{sleepDuration:r.SleepDuration,sleepStartTime:Ua(r.SleepStartTime),sleepEndTime:Ua(r.SleepEndTime),fallAsleepRemindSetting:o,sleepReportSwitch:null!==(t=r.SleepReportSwitch)&&void 0!==t?t:Ba.Invalid}}}function za(e){var t,n=e.sleepSchedule,r=n.fallAsleepRemindSetting,i=r?{RemindSwitch:r.remindSwitch?1:0,RemindTime:Fa(r.remindTime),RemindCycleMaskFlag:(t=r.remindCycle,parseInt(t.filter((function(e){return e>0&&e<8})).reduce((function(e,t){return e[t-1]=1,e}),Array.from({length:7})).map((function(e){return e?1:0})).reverse().join(""),2))}:void 0;return{SleepSwitch:e.sleepSwitch?1:0,SleepScheduleEn:e.sleepScheduleEnabled,SleepSchedule:{SleepDuration:n.sleepDuration,SleepStartTime:Fa(n.sleepStartTime),SleepEndTime:Fa(n.sleepEndTime),FallAsleepRemindSet:i}}}function Ha(e){return e}function Wa(e){return e}function Ja(e){var t;return{Weight:e.weight,Height:e.height,Birthday:Ka(e.birthday),Age:null!==(t=e.age)&&void 0!==t?t:Ya(e.birthday),Gender:e.gender,NickName:e.nickName}}function Za(e){if(e)return{weight:e.Weight,height:e.Height,birthday:e.Birthday,age:e.Age,gender:e.Gender,nickName:e.NickName}}function Ka(e){if(Qa(e)){var t=new Date(e),n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),o=new ArrayBuffer(4),a=new DataView(o);return a.setUint16(0,n,!1),a.setUint8(2,r),a.setUint8(3,i),a.getInt32(0,!1)}}function Qa(e){return!!e&&new Date(e).getTime()<(new Date).getTime()}function Ya(e){if(Qa(e)){var t=new Date(e),n=new Date,r=t.getFullYear(),i=n.getFullYear();if(r===i)return 0;var o=i-r;return n.getMonth()<t.getMonth()||n.getDate()<t.getDate()?o-1:o}}function Xa(e){return{GoalSw:e.switch?1:0,GoalItem:e.items.map((function(e){return{SubType:e.type,SubSw:e.switch?1:0,SubValue:e.value}}))}}function ec(e){return{switch:1===e.GoalSw,items:e.GoalItem.map((function(e){return{type:e.SubType,switch:1===e.SubSw,value:e.SubValue}}))}}!function(e){!function(e){e[e.Closed=0]="Closed",e[e.Wait=1]="Wait",e[e.Weak=2]="Weak",e[e.Normal=3]="Normal"}(e.StateCode||(e.StateCode={}))}(ka||(ka={})),function(e){e[e.Invalid=0]="Invalid",e[e.Close=1]="Close",e[e.Open=2]="Open"}(Ba||(Ba={})),function(e){e[e.Male=1]="Male",e[e.Female=0]="Female"}(La||(La={})),function(e){e[e.Invalid=0]="Invalid",e[e.Steps=1]="Steps",e[e.Calorie=2]="Calorie",e[e.Distance=3]="Distance",e[e.StandingDuration=4]="StandingDuration",e[e.WeeklyActivityDuration=5]="WeeklyActivityDuration",e[e.Other=6]="Other"}(Pa||(Pa={}));var tc=function(){return tc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},tc.apply(this,arguments)},nc=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function rc(e){var t;if(e)return{weight:e.weight,height:e.height,birthday:e.birthday,age:null!==(t=e.age)&&void 0!==t?t:Ya(e.birthday),gender:e.gender,nickName:e.nickName}}var ic,oc=function(e){var t=e.scanResult,n=e.bindUserId,r=e.userInfo,i=nc(e,["scanResult","bindUserId","userInfo"]),o=Gi().getSystemInfoSync();return tc({scanResult:null!=t?t:{},languageConfig:{local:"CN",language:"zh"},userId:null!=n?n:"userId",userInfo:tc({},rc(r)),bindResult:void 0,platform:"ios"===o.platform?xi.Platform.ios:"android"===o.platform?xi.Platform.android:void 0},i)};function ac(e){return xi.AliceUtils.parseFileData(e)}function cc(e){try{if(e.byteLength>4096){for(var t=function(e,t){var n=[],r=e.byteLength;if(r>t){for(var i=0;i<r-t;){var o=e.slice(i,i+t);n.push(o),i+=t}var a=e.slice(i,i+t);n.push(a)}else n.push(e);return n}(e,4096),n=[],r=0;r<t.length;r++)n.push(cc(t[r]));return n.join("")}var i=new Uint8Array(e);return String.fromCharCode.apply(null,i)}catch(e){return console.error("字符串转换失败"+e,e),""}}function uc(e){if(void 0===e)return e;var t=kr(e);return parseInt(t,16)}function sc(e){var t;return null!==(t=ja(kr(e)))&&void 0!==t?t:[]}function lc(e){return cc(e)}!function(e){e.HR="HR",e["SPO2-S"]="SPO2-S",e["SPO2-P"]="SPO2-P",e.SLEP="SLEP",e.ACTI="ACTI",e.ACTIS="ACTIS",e["ACTI-2"]="ACTI-2",e.SPOR="SPOR",e.GPSD="GPSD",e.R_HR="R_HR"}(ic||(ic={}));var fc=Ai("internal/dataSync/parse/parseData/parseSportReport");var dc=Ai("internal/dataSync/parse/parseData/parseDailyActivityFile");var pc=function(){return pc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},pc.apply(this,arguments)},hc=Ai("internal/dataSync/parse/parseData/parseHr");function vc(e){var t=ac(e);if(!t.fileHeader.fileType.startsWith(ic.HR))throw hc.error("解析心率文件，无效文件类型 fileType=".concat(t.fileHeader.fileType),e),new Error("解析心率文件，无效文件类型 fileType=".concat(t.fileHeader.fileType));return{fileList:t.fileList.map((function(e){return t=e.data,pc(pc({},t),{HrData:t.HrData?yc(t.HrData):t.HrData});var t})),fileHeader:t.fileHeader}}function yc(e){if(e)return pc(pc({},e),{Type:gc(e.Type),HrValue:sc(e.HrValue),Reliability:uc(e.Reliability)})}function gc(e){if(void 0!==e){var t=kr(e);if(!(t.length<2))return parseInt(t.slice(0,2),16)}}var mc=function(){return mc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},mc.apply(this,arguments)},bc=Ai("internal/dataSync/parse/parseData/parseSleep");function wc(e){var t=ac(e);if(!t.fileHeader.fileType.startsWith(ic.SLEP))throw bc.error("解析睡眠文件，无效文件类型 fileType=".concat(t.fileHeader.fileType),e),new Error("解析睡眠文件，无效文件类型 fileType=".concat(t.fileHeader.fileType));return{fileList:t.fileList.map((function(t){return 0===t.originData.type?(n=t.data,mc(mc({},n),{SleepData:n.SleepData?kr(n.SleepData):n.SleepData})):1===t.originData.type?Ma(t.data):void bc.error("解析睡眠文件，无效的数据包类型 type=".concat(t.originData.type),e,t);var n})).filter((function(e){return e})),fileHeader:t.fileHeader}}var Sc=function(){return Sc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Sc.apply(this,arguments)},Ic=Ai("internal/dataSync/parse/parseData/parseSpo2");function Cc(e){var t=ac(e),n=t.fileHeader.fileType;if(!n.startsWith(ic["SPO2-S"])&&!n.startsWith(ic["SPO2-P"]))throw Ic.error("解析血氧文件，无效文件类型 fileType=".concat(n),e),new Error("解析血氧文件，无效文件类型 fileType=".concat(n));return{fileList:t.fileList.map((function(e){return t=e.data,Sc(Sc({},t),{Spo2Data:t.Spo2Data?Sc(Sc({},t.Spo2Data),{Spo2Value1:sc(t.Spo2Data.Spo2Value1),Spo2Value2:sc(t.Spo2Data.Spo2Value2),Reliability1:sc(t.Spo2Data.Reliability1),Reliability2:sc(t.Spo2Data.Reliability2)}):t.Spo2Data});var t})),fileHeader:t.fileHeader}}var _c=Ai("internal/dataSync/parse/parseData/parseDayActiveDataFile");var Dc=Ai("internal/dataSync/parse/parseData/parseRestingHr");var Tc=Ai("internal/dataSync/parseFile");function Ec(e){var t=e.getData();Tc.debug("toFileData",t);var n=function(e){if(e.fileType===Qo.Log)return{fileList:[lc(e.fileBuffer)]};if(e.fileType===Qo.Hr)return vc(e);if(e.fileType===Qo.Spo2)return Cc(e);if(e.fileType===Qo.Sleep)return wc(e);if(e.fileType===Qo.SportReport)return function(e){if(e.fileName.endsWith(".rpt"))return{fileList:[(t=e.fileBuffer,n=lc(t),JSON.parse(n))]};var t,n,r=ac(e),i=r.fileHeader.fileType;if(!i.startsWith(ic.SPOR)&&!i.startsWith(ic.GPSD))throw fc.error("解析运动报告文件，无效文件类型 fileType=".concat(i),e),new Error("解析运动报告文件，无效文件类型 fileType=".concat(i));return{fileList:r.fileList,fileHeader:r.fileHeader}}(e);if(e.fileType===Qo.DailyActivity)return function(e){dc.debug("receive fileInfo",e);var t=ac(e);dc.debug("parse fileInfo",t);var n=t.fileHeader.fileType;if(!n.startsWith(ic.ACTIS)&&!n.startsWith(ic.ACTI))throw dc.error("解析日常活动文件，无效文件类型 fileType=".concat(n),e),new Error("解析日常活动文件，无效文件类型 fileType=".concat(n));return{fileList:t.fileList.map((function(e){return e.data})),fileHeader:t.fileHeader}}(e);if(e.fileType===Qo.DailyActivitySummary)return function(e){_c.debug("receive fileInfo",e);var t=ac(e);_c.debug("parse fileInfo",t);var n=t.fileHeader.fileType;if(!n.startsWith(ic["ACTI-2"]))throw _c.error("解析日常活动汇总文件，无效文件类型 fileType=".concat(n),e),new Error("解析日常活动汇总文件，无效文件类型 fileType=".concat(n));return{fileList:t.fileList.map((function(e){return e.data})),fileHeader:t.fileHeader}}(e);if(e.fileType===Qo.SportHr)return function(e){for(var t=new DataView(e.fileBuffer),n=[],r=0;r<t.byteLength;r++){var i=t.getUint8(r);n.push(i)}return{fileList:[n]}}(e);if(e.fileType===Qo.RestingHr)return function(e){Dc.debug("receive fileInfo",e),Dc.debug("receive fileInfo",kr(e.fileBuffer));var t=ac(e);Dc.debug("parse fileInfo",t);var n=t.fileHeader.fileType;if(!n.startsWith(ic.R_HR))throw Dc.error("解析静息心率文件，无效文件类型 fileType=".concat(n),e),new Error("解析静息心率文件，无效文件类型 fileType=".concat(n));return{fileList:t.fileList.map((function(e){return e.data})),fileHeader:t.fileHeader}}(e);var t;try{t=lc(e.fileBuffer)}catch(e){return{fileList:[]}}try{return{fileList:[JSON.parse(t)]}}catch(n){return Tc.debug("尝试解析为 json 失败",e),{fileList:[t]}}}(t),r={fileName:t.fileName,fileType:t.fileType,fileList:n.fileList,fileHeader:n.fileHeader};return Tc.debug("toFileData result",r),r}var Ac=function(){return Ac=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ac.apply(this,arguments)},xc=Ai("internal/dataSync/parseReportData");function Oc(e){var t=e.reportData,n=(new Date).getTime();if(t.dataType===xi.DataType_Alice){var r=function(e){var t=e.getData();xc.debug("toNormalUploadData",t);var n={categoryId:t.categoryId,commandId:t.commandId,data:t.pbInfo,isReq:t.isReq,isRsp:t.isRsp,seq:t.seq};return xc.debug("toNormalUploadData result",n),n}(t);return Ac(Ac({},r),{type:kc.UploadDataType.Normal,ts:n})}if(t.dataType===xi.DataType_AliceFile){var i=Ec(t);return Ac(Ac({},i),{type:kc.UploadDataType.File,ts:n})}xc.error("onDataReport unknow dataType",t)}var kc,Bc=new X;function Lc(e){var t=e.onUpload,n=Bc.subscribe((function(e){t(e)}));return function(){return n.unsubscribe()}}function Pc(e){var t=e.mac,n=e.userInfo;if(!oa({mac:t}).connected)throw new Error("开始同步数据，设备未连接 mac=".concat(t));var r=vo({mac:t});if(!r)throw new Error("开始同步数据，找不到设备 mac=".concat(t));var i=r.deviceId;return Bn((function(){return xi.BLEManager.startDataSync(i,oc({scanResult:{},userInfo:n,listeners:{onDataReport:function(e){var t=Oc({reportData:e});t&&function(e){var t=e.data,n=vo({deviceId:e.deviceId}),r=null==n?void 0:n.mac;r?Bc.next({mac:r,data:t}):console.warn("数据上报，mac 不存在")}({deviceId:i,data:t})}}}))}))}function Nc(e){return Jn(Pc({mac:e.mac,userInfo:e.userInfo}))}!function(e){!function(e){e.Normal="normal",e.File="file"}(e.UploadDataType||(e.UploadDataType={}))}(kc||(kc={}));var Mc=function(){function e(){this.subscriptions=new Set}return e.prototype.emit=function(e){this.subscriptions.forEach((function(t){t(e)}))},e.prototype.on=function(e){var t=this;return this.subscriptions.add(e),function(){t.subscriptions.delete(e)}},e.prototype.once=function(e){var t=this,n=function(){t.subscriptions.delete(e)};return this.subscriptions.add((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n(),e.apply(void 0,t)})),n},e}(),jc=new Mc;function Rc(e){return jc.on(e)}var Uc=new Mc;function Fc(e){return Uc.on(e)}var $c,qc=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},Vc=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Gc=Ai("internal/gps/GpsHandler"),zc=function(){function e(){var e=this;this.gpsStatus=xi.GpsStatus.Close,this.isStart=!1,this.gpsManager=new xi.GpsManager({onStartRequest:function(t){return qc(e,void 0,void 0,(function(){return Vc(this,(function(e){return Gc.debug("gps start",t),this.isStart||(this.isStart=!0,jc.emit()),[2]}))}))},onStopRequest:function(t){return qc(e,void 0,void 0,(function(){return Vc(this,(function(e){return Gc.debug("gps stop",t),0===t.deviceIds.length&&(this.isStart=!1,Uc.emit()),[2]}))}))},getGpsInfo:function(){return{locationInfo:e.locationInfo,gpsStatus:e.gpsStatus}}})}return e.prototype.updateLocationInfo=function(e){this.locationInfo=e},e.prototype.updateGpsStatus=function(e){this.gpsStatus=e},e.prototype.handleDeviceRequestGps=function(e){var t=e.uploadData,n=e.mac;Gc.debug("收到gps下发请求, deviceId=".concat(n),t.data);var r=vo({mac:n});r?this.gpsManager.receiveDeviceGpsSwitch({deviceId:r.deviceId,categoryId:t.categoryId,commandId:t.commandId,gpsSwitch:t.data,seq:t.seq,gpsStatus:this.gpsStatus}):Gc.warn("收到gps下发请求，通过 mac=".concat(n," 找不到对应 deviceId"))},e}();function Hc(){if(!$c)throw new Error("请先调用 initPgs");return $c}var Wc=Oi(Hc,(function(e){return e.handleDeviceRequestGps})),Jc=Oi(Hc,(function(e){return e.updateGpsStatus})),Zc=Oi(Hc,(function(e){return e.updateLocationInfo})),Kc=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},Qc=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Yc=Ai("internal/requestDevice/requestByAliceRequest");function Xc(e){var t,n,r,i,o,a,c;return Kc(this,void 0,void 0,(function(){var u,s,l,f,d,p,h,v,y;return Qc(this,(function(g){switch(g.label){case 0:u=(new Date).getTime(),s=e.request?function(e){var t=e.buffer,n=e.root,r=e.lookup,i=e.data;if(t)return t;if(n&&r)return xi.PbHandler.encodePb(n,r,i);return}(e.request):void 0,l=new xi.AliceRequest(e.categoryId,e.commandId+(e.isRsp?128:0),s,e.seq),e.timeout&&l.setTimeout(e.timeout),g.label=1;case 1:return g.trys.push([1,3,,4]),[4,xi.BLEManager.send(e.deviceId,l)];case 2:return f=g.sent(),d=void 0,p=void 0,(h=null===(t=null==f?void 0:f.originResponse)||void 0===t?void 0:t.responseData)&&(h.parsePb(null!==(r=null===(n=e.response)||void 0===n?void 0:n.root)&&void 0!==r?r:xi.pdfile.error,null!==(o=null===(i=e.response)||void 0===i?void 0:i.lookup)&&void 0!==o?o:"ErrorCode_t"),d=h.packet.pbArrayBuffer,p=h.packet.pbInfo),y=(new Date).getTime(),Yc.info("requestDevice success: startTs=".concat(u,", spendTs=").concat(y-u,", categoryId=").concat(l.categoryId,", commandId=").concat(l.commandId,", reqData=").concat(JSON.stringify(null===(a=e.request)||void 0===a?void 0:a.data),", reqHex=").concat(s&&kr(s),", respHex=").concat(d&&kr(d),", respData=").concat(JSON.stringify(p)," ")),[2,p];case 3:throw v=g.sent(),y=(new Date).getTime(),Yc.error("requestDevice error: startTs=".concat(u,", spendTs=").concat(y-u,",  categoryId=").concat(l.categoryId,", commandId=").concat(l.commandId,", reqData=").concat(JSON.stringify(null===(c=e.request)||void 0===c?void 0:c.data),", reqHex=").concat(s&&kr(s))),v;case 4:return[2]}}))}))}var eu=Ai("internal/requestDevice/config"),tu={GetBindInfo:{categoryId:0,commandId:3,response:{root:xi.pdfile.bind,lookup:"bindInfo_t"}},Unbind:{categoryId:0,commandId:7,request:{root:xi.pdfile.bind,lookup:"unbindReq_t"}},GetDeviceTime:{categoryId:1,commandId:1,response:{root:xi.pdfile.deviceinfo,lookup:"time_t",format:ha}},SetDeviceTime:{categoryId:1,commandId:2,request:{root:xi.pdfile.deviceinfo,lookup:"time_t",parse:pa}},GetDeviceInfo:{categoryId:1,commandId:3,response:{root:xi.pdfile.deviceinfo,lookup:"device_info_t",format:va}},GetBatteryInfo:{categoryId:1,commandId:4,response:{root:xi.pdfile.deviceinfo,lookup:"battery_info_t",format:ya}},SetLanguage:{categoryId:1,commandId:13,request:{root:xi.pdfile.deviceinfo,lookup:"DeviceLanguageSet_t",parse:ma}},GetHrSetting:{categoryId:2,commandId:1,response:{root:xi.pdfile.health,lookup:"HrSwitch_t",format:Oa}},SetHrSetting:{categoryId:2,commandId:2,request:{root:xi.pdfile.health,lookup:"HrSwitch_t",parse:xa}},GetBloodOxygenSetting:{categoryId:2,commandId:3,response:{root:xi.pdfile.health,lookup:"Spo2Switch_t",format:fa}},SetBloodOxygenSetting:{categoryId:2,commandId:4,request:{root:xi.pdfile.health,lookup:"Spo2Switch_t",parse:da}},GetSleepSetting:{categoryId:2,commandId:5,response:{root:xi.pdfile.health,lookup:"SleepSwitch_t",format:Ga}},SetSleepSetting:{categoryId:2,commandId:6,request:{root:xi.pdfile.health,lookup:"SleepSwitch_t",parse:za}},GetUserInfo:{categoryId:2,commandId:7,response:{root:xi.pdfile.userinfo,lookup:"UserInfo_t",format:Za}},SetUserInfo:{categoryId:2,commandId:8,request:{root:xi.pdfile.userinfo,lookup:"UserInfo_t",parse:Ja}},GetSedentaryReminder:{categoryId:2,commandId:9,response:{root:xi.pdfile.health,lookup:"SedentaryReminder_t",format:qa}},SetSedentaryReminder:{categoryId:2,commandId:10,request:{root:xi.pdfile.health,lookup:"SedentaryReminder_t",parse:$a}},GetDailyRecordData:{categoryId:2,commandId:11,isGetFile:!0,request:{root:xi.pdfile.health,lookup:"RecordData_t",parse:Ca}},GetSleepReport:{categoryId:2,commandId:12,response:{root:xi.pdfile.health,lookup:"sleepReport_t",format:Ma}},GetPressureStatus:{categoryId:2,commandId:18,request:{root:xi.pdfile.health,lookup:"pressureStatusReq_t",parse:_a},response:{root:xi.pdfile.health,lookup:"pressureStatusReport_t",format:Da}},GetActivaGoalSetting:{categoryId:3,commandId:1,response:{root:xi.pdfile.sport,lookup:"TodayActiveGoalGet_t",format:ec}},SetActivaGoalSetting:{categoryId:3,commandId:2,request:{root:xi.pdfile.sport,lookup:"TodayActiveGoalGet_t",parse:Xa}},GetTodayActivityData:{categoryId:3,commandId:7,response:{root:xi.pdfile.sport,lookup:"TodayActiveTotalGet_t"}},GetSportRecordList:{categoryId:3,commandId:8,request:{root:xi.pdfile.sport,lookup:"SportDescription_t",parse:Ea},response:{root:xi.pdfile.sport,lookup:"SportDescription_t",format:Aa}},GetSportRecordFile:{categoryId:3,commandId:9,isGetFile:!0,request:{root:xi.pdfile.sport,lookup:"SportDetail_t",parse:Ta}},GetDailyRecordSummaryFile:{categoryId:3,commandId:10,isGetFile:!0},SendGpsLocation:{categoryId:3,commandId:13,request:{root:xi.pdfile.sport,lookup:"GpsLocation_t",parse:Va}},GetActivityStrength:{categoryId:3,commandId:14,response:{root:xi.pdfile.sport,lookup:"activityStrengthDetail_t",format:Ia}},GetSetSportHrSectionSetting:{categoryId:3,commandId:15,request:{root:xi.pdfile.health,lookup:"sportHrSectionCfg_t",parse:Wa},response:{root:xi.pdfile.health,lookup:"sportHrSectionCfg_t",format:Ha}},GetFileList:{categoryId:8,commandId:1,request:{root:xi.pdfile.file,lookup:"getFlieListReqRsp_t",parse:wa},response:{root:xi.pdfile.file,lookup:"getFlieListReqRsp_t",format:Sa}},GetFile:{categoryId:8,commandId:2,isGetFile:!0,request:{root:xi.pdfile.file,lookup:"getFlieRequest_t",parse:ba}}};Object.keys(tu).forEach((function(e){tu[e].requestType=e})),eu.debug("AllRequestType",tu);var nu=Array.isArray;function ru(e){return 1===e.length&&nu(e[0])?e[0]:e}function iu(e){return function(t){for(var n=[],r=function(r){n.push(Pe(e[r]).subscribe(re(t,(function(e){if(n){for(var i=0;i<n.length;i++)i!==r&&n[i].unsubscribe();n=null}t.next(e)}))))},i=0;n&&!t.closed&&i<e.length;i++)r(i)}}var ou=function(){function e(e){var t=e.executer,n=e.waitTimeout,r=e.runTimeout,i=this;this.isStart=!1,this.isWaitTimeout=!1,this.start$=new X,this.executer=t,this.createdTs=(new Date).getTime(),this.waitTimeout=n,this.runTimeout=r;var o=this.genWaitTimeoutObservable().pipe(Re((function(){i.isWaitTimeout=!0})));this.result$=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===(e=ru(e)).length?Pe(e[0]):new K(iu(e))}(o.pipe(Se((function(){return{timeout:!0}}))),this.start$.pipe(Se((function(){return{timeout:!1}})))).pipe(He((function(e){return e.timeout?Bi((function(){return i.genWaitTimeoutError()})):i.genExecuteObservable()}))).pipe(de(),Nn()),this.result$.subscribe()}return e.prototype.start=function(){var e=this;if(this.isStart)throw new Error("已经 start");return this.isWaitTimeout?Bi((function(){return e.genWaitTimeoutError()})):(this.isStart=!0,this.start$.next(),this.result$)},e.prototype.genWaitTimeoutObservable=function(){var e;return(null!==(e=this.waitTimeout)&&void 0!==e?e:0)>0?vt(this.waitTimeout).pipe(Se((function(){}))):je},e.prototype.genExecuteObservable=function(){var e=this,t=Bn((function(){return e.waitTimeout&&(new Date).getTime()-e.createdTs>e.waitTimeout?Bi((function(){return e.genWaitTimeoutError()})):e.executer()}));return this.runTimeout&&(t=t.pipe(mt({first:this.runTimeout,with:function(){return Bi((function(){return new Error("执行超时 timeout=".concat(e.runTimeout))}))}}))),t},e.prototype.genWaitTimeoutError=function(){return new Error("等待超时, waitTimeout=".concat(this.waitTimeout))},e}(),au=function(){return au=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},au.apply(this,arguments)},cu=function(){function e(e){var t=e.concurrent,n=e.waitTimeout,r=e.runTimeout;this.task$=new X,this.concurrent=t,this.waitTimeout=n,this.runTimeout=r,this.subscription=this.task$.pipe(He((function(e){return e.start().pipe(wt((function(){return ce})))}),this.concurrent)).subscribe()}return e.prototype.runTask=function(e,t){var n=this;return new Promise((function(r,i){var o,a,c=new ou(au(au({},t),{waitTimeout:null!==(o=null==t?void 0:t.waitTimeout)&&void 0!==o?o:n.waitTimeout,runTimeout:null!==(a=null==t?void 0:t.runTimeout)&&void 0!==a?a:n.runTimeout,executer:e}));Jn(c.result$).then(r,i),n.task$.next(c)}))},e.prototype.destroy=function(){this.subscription.unsubscribe()},e}(),uu=new Map;function su(e,t){return function(e){return uu.has(e)||uu.set(e,new cu({concurrent:1})),uu.get(e)}(e).runTask(t,{waitTimeout:1e4,runTimeout:3e3})}var lu,fu=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},du=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},pu=new Map,hu=new X;function vu(e){hu.next(e)}function yu(e){var t=this,n=e.mac,r=e.requestDevice,i=e.onReceiveFile;function o(){var e={status:lu.Timeout};return null==i||i(e),gu(e)}return function(e){return pu.has(e)||pu.set(e,new cu({concurrent:1})),pu.get(e)}(n).runTask((function(){return fu(t,void 0,void 0,(function(){var e;return du(this,(function(t){switch(t.label){case 0:return[4,r()];case 1:return 1e6!==(null==(e=t.sent())?void 0:e.ErrorCode)?[3,3]:[4,Jn(hu.pipe(oe((function(e){return e.mac===n})),mt({first:3e3,with:function(){return Bi(o)}}),Se((function(e){return function(e){if(e.type===kc.UploadDataType.Normal){var t={3:lu.Request,4:lu.SendChunk,5:lu.SendComplete,6:lu.Cancel};if(!(e.commandId in t))throw new Error("toReceiveFileInfo 异常 commandId=".concat(e.commandId));return{status:t[e.commandId],data:e.data}}if(e.type===kc.UploadDataType.File){return{status:lu.Complete,data:e}}throw new Error("toReceiveFileInfo 异常类型")}(e.data)})),Re((function(e){null==i||i(e)})),xr((function(e){return e.status===lu.Complete?"complete":"notComplete"})),He((function(e){return"complete"===e.key?e:e.pipe(Re((function(e){if(e.status===lu.Cancel)throw gu(e)})),lt(3e3),He((function(){return Bi(o)})))}))))];case 2:t.sent(),t.label=3;case 3:return[2,e]}}))}))}),{waitTimeout:12e4,runTimeout:6e4})}function gu(e){var t=e.status,n=new Error("接收文件异常 status=".concat(t));return n.status=t,n}!function(e){e.Request="request",e.SendChunk="sendChunk",e.SendComplete="sendComplete",e.Complete="complete",e.Cancel="cancel",e.Timeout="timeout"}(lu||(lu={}));var mu=function(){return mu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},mu.apply(this,arguments)},bu=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},wu=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Su=Ai("internal/requestDevice/requestDevice");function Iu(e){var t=e.mac,n=e.requestType,r=e.data,i=e.isRsp,o=e.seq,a=e.onReceiveFile;return bu(this,void 0,void 0,(function(){var e,c;return wu(this,(function(u){if(Su.debug("requestDevice: requestType=".concat(n," "),r),!(e=tu[n]))throw new Error("requestDevice: 暂不支持 requestType=".concat(n));return c=function(){return function(e){var t,n,r,i,o,a,c,u=e.mac,s=e.requestType,l=e.requestConfig,f=e.data,d=e.seq,p=e.isRsp;return bu(this,void 0,void 0,(function(){var e,h,v,y,g,m,b,w=this;return wu(this,(function(S){switch(S.label){case 0:return e=l.categoryId,h=l.commandId,v=null!==(r=null===(n=null===(t=l.request)||void 0===t?void 0:t.parse)||void 0===n?void 0:n.call(t,f))&&void 0!==r?r:f,y=null!==(i=l.response)&&void 0!==i?i:{root:xi.pdfile.error,lookup:"ErrorCode_t"},Su.debug("requestDevice: requestType=".concat(s," "),f),g=l.request?mu(mu({},l.request),{data:v}):void 0,[4,su(u,(function(){return bu(w,void 0,void 0,(function(){var t,n;return wu(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),Su.debug("requestDeviceNative: categoryId=".concat(e,", commandId=").concat(h),g),[4,Xc({deviceId:Cu({mac:u}),categoryId:e,commandId:h,request:g,response:y,isRsp:p,seq:d})];case 1:return t=r.sent(),Su.debug("requestDeviceNative:  categoryId=".concat(e,", commandId=").concat(h),t),[2,t];case 2:throw n=r.sent(),Su.error("requestDevice error: requestType=".concat(s),n),n;case 3:return[2]}}))}))}))];case 1:return m=S.sent(),b=null!==(c=null===(a=null===(o=l.response)||void 0===o?void 0:o.format)||void 0===a?void 0:a.call(o,m))&&void 0!==c?c:m,Su.debug("requestDevice result: requestType=".concat(s," "),f,b),[2,b]}}))}))}({mac:t,requestType:n,requestConfig:e,data:r,isRsp:i,seq:o})},e.isGetFile?[2,new Promise((function(e,n){yu({mac:t,requestDevice:function(){return c().then((function(t){return e(t),Promise.resolve(t)}),(function(e){return n(e),Promise.reject(e)}))},onReceiveFile:a})}))]:[2,c()]}))}))}function Cu(e){var t=vo({mac:e.mac});if(!t)throw new Error("getDeviceId：没找到对应 mac");return t.deviceId}var _u,Du=function(){return Du=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Du.apply(this,arguments)},Tu=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},Eu=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Au=Ai("internal/requestDevice/requestDeviceGetFile");function xu(e){return Tu(this,void 0,void 0,(function(){var t,n,r,i;return Eu(this,(function(o){if(t=e.requestType,n=e.data,r=e.onReceiveFile,Au.debug("requestDeviceGetFile: requestType=".concat(t," "),n),!(null==(i=tu[t])?void 0:i.isGetFile))throw new Error("requestDeviceGetFile: 暂不支持 requestType=".concat(t));return[2,new Promise((function(t,n){Iu(Du(Du({},e),{onReceiveFile:function(e){null==r||r(e),e.status===lu.Complete?t(e.data):[lu.Cancel,lu.Timeout].includes(e.status)&&n(e)}})).then((function(e){1e6!==(null==e?void 0:e.ErrorCode)&&n(e)}))}))]}))}))}!function(e){!function(e){e[e.Invalid=0]="Invalid",e[e.Sleep=1]="Sleep",e[e.WakeUp=2]="WakeUp",e[e.StartSport=3]="StartSport",e[e.EndSport=4]="EndSport",e[e.FileUpdate=5]="FileUpdate"}(e.EventType||(e.EventType={})),function(e){e[e.HeartRate=0]="HeartRate",e[e.BloodOxygen=1]="BloodOxygen",e[e.Sleep=2]="Sleep",e[e.DailyActivities=3]="DailyActivities",e[e.DailyActivitiesStatus=4]="DailyActivitiesStatus",e[e.Pressure=5]="Pressure",e[e.DailyActivitiesSummary=6]="DailyActivitiesSummary",e[e.PointBloodOxygen=7]="PointBloodOxygen",e[e.SportRecord=8]="SportRecord",e[e.TodayActivities=9]="TodayActivities",e[e.RestingHeartRate=10]="RestingHeartRate",e[e.All=31]="All"}(e.FileUpdateType||(e.FileUpdateType={}))}(_u||(_u={}));var Ou=function(){return Ou=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ou.apply(this,arguments)};function ku(e){var t=e.EventID,n={type:t,time:e.EventTime,originEvent:e};switch(t){case _u.EventType.Invalid:case _u.EventType.Sleep:case _u.EventType.WakeUp:return n;case _u.EventType.StartSport:case _u.EventType.EndSport:return Ou(Ou({},n),{data:{sportId:e.EventParaStr}});case _u.EventType.FileUpdate:return function(e){var t=Number(e.originEvent.EventParaUint).toString(2).split("").reverse().map(Number).reduce((function(e,t,n){return 1===t&&e.push(n),e}),[]);return Ou(Ou({},e),{data:{fileTypes:t}})}(n);default:throw new Error("无效 type=".concat(t))}}var Bu,Lu=Ai("internal/dataSync/event/EventManager"),Pu=function(){function e(){this.event$=new X}return e.prototype.onEventObservable=function(e){var t=void 0===e?{}:e,n=t.mac,r=t.eventType,i=this.event$.asObservable();return n&&(i=i.pipe(oe((function(e){return e.mac===n})))),r&&(i=i.pipe(oe((function(e){return e.event.type===r})))),i},e.prototype.onEvent=function(e){var t=this.event$.subscribe(e);return function(){t.unsubscribe()}},e.prototype.triggerEvent=function(e,t){Lu.getLevel()<=Lu.levels.DEBUG&&Lu.debug("triggerEvent originEvent = ".concat(JSON.stringify(t)));var n=ku(t);Lu.getLevel()<=Lu.levels.DEBUG&&Lu.debug("triggerEvent event = ".concat(JSON.stringify(n))),this.event$.next({mac:e,event:n})},e}();function Nu(){return Bu||(Bu=new Pu),Bu}var Mu=Oi(Nu,(function(e){return e.onEvent})),ju=Oi(Nu,(function(e){return e.onEventObservable})),Ru=Oi(Nu,(function(e){return e.triggerEvent}));function Uu(){Lc({onUpload:function(e){var t=e.data,n=e.mac;if(t.type===kc.UploadDataType.Normal){var r=t.categoryId,i=t.commandId;switch(r){case 1:return void(16===i&&Ru(n,t.data));case 3:return 12===i?Wc({mac:n,uploadData:t}):void 0;case 8:return void([3,4,5,6].includes(i)&&vu({mac:n,data:t}))}}if(t.type===kc.UploadDataType.File&&(vu({mac:n,data:t}),t.fileType===Qo.SportReport))return function(e){var t=e.uploadData,n=e.mac;t.fileList.forEach((function(e){e.hrSimpleDataFile&&Iu({mac:n,requestType:"GetFile",data:{fileType:Qo.SportHr,fileName:e.hrSimpleDataFile}}),e.detailDataFile&&Iu({mac:n,requestType:"GetFile",data:{fileType:Qo.SportReport,fileName:e.detailDataFile}}),e.gpsDataFile&&Iu({mac:n,requestType:"GetFile",data:{fileType:Qo.SportReport,fileName:e.gpsDataFile}})}))}({mac:n,uploadData:t})}})}var Fu=Ai("internal/initInternal"),$u=Ai("LifesenseSdk");function qu(){return no(),function(){var e=ao().filter((function(e){return e.mac})).map((function(e){return{deviceId:e.deviceId,mac:e.mac}}));co=new te(e),lo.pipe(oe((function(e){return!(!e.deviceId||!e.mac)||(uo.error("updateDeviceMac：无效数据",e),!1)})),Re((function(e){e.saveToStorage&&(uo.debug("saveToStorage=true, 保存到设备缓存",e),oo({deviceId:e.deviceId,mac:e.mac}))})),Ge(so(),(function(e,t){return{options:e,deviceMacInfoList:t}})),Se((function(e){var t=e.options,n=e.deviceMacInfoList,r=n.filter((function(e){return e.deviceId===t.deviceId||e.mac===t.mac}));return{options:t,deviceMacInfoList:n,oldItemList:r}})),oe((function(e){var t=e.options,n=e.oldItemList;if(1===n.length){var r=n[0];if(r.mac===t.mac&&r.deviceId===t.deviceId)return!1}return!0})),Re((function(e){var t=e.options;fo.next({deviceId:t.deviceId,mac:t.mac})})),Se((function(e){var t=e.options,n=e.deviceMacInfoList,r=e.oldItemList,i=n.filter((function(e){return!r.includes(e)})),o={deviceId:t.deviceId,mac:t.mac};return i.push(o),i}))).subscribe(co)}(),Jo(),Uu(),$c=new zc,Fu.debug("init"),xi.BLEManager.init({openBLEAdapter:!1,bluetooth:Gi(),platform:"wx",logger:$u,discoverDelay:0,printValueChange:!0,printWrite:!0})}var Vu,Gu=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},zu=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};!function(e){e.Error=ve()}(Vu||(Vu={}));var Hu=Ai("internal/init"),Wu=new te({initializing:!1,initialized:!1});function Ju(e){return void 0===e&&(e={}),Gu(this,void 0,void 0,(function(){var t,n,r,i;return zu(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),t=Wu.getValue(),n=t.initialized,r=t.initializing,n)throw new Vu.Error("已经初始化",c.Initialized);if(r)throw new Vu.Error("正在初始化",c.Initializing);return Wu.next({initialized:!1,initializing:!0}),e.logger&&(void 0!==e.logger.level&&Ei(e.logger.level),e.logger.method&&(u=e.logger.method,Ti.loggerMethod=u)),zr({apis:e.apis}),[4,qu().catch((function(e){return{error:e,success:void 0}}))];case 1:if(!o.sent().success)throw Wu.next({initialized:!1,initializing:!1}),new Vu.Error("初始化失败",c.InitBluetoothError);return Hu.debug("init success"),Wu.next({initialized:!0,initializing:!1}),[3,3];case 2:throw i=o.sent(),console.error(i),new Vu.Error("初始化失败",a.Unknow,i);case 3:return[2]}var u}))}))}function Zu(e){var t=Wu.pipe(oe((function(e){return e.initialized})),de()).subscribe((function(){return e()}));return function(){return t.unsubscribe()}}var Ku,Qu,Yu=n(803);function Xu(e){var t=Yu.parse(e.substr(e.indexOf("?")));return void 0!==t.m&&void 0!==t.s?{mac:t.m,sn:t.s}:{model:t.p,mac:t.mac}}function es(){Gi().removeStorage({key:eo})}!function(e){e.Error=ve()}(Ku||(Ku={})),function(e){e.Error=ve()}(Qu||(Qu={}));var ts=function(e,t){return void 0===t&&(t={}),new Promise((function(n,r){var i,o,a=!1,c=e.subscribe({next:function(e){var n;o=e,a=!0,null===(n=t.next)||void 0===n||n.call(t,e)},error:r,complete:function(){a?n(o):r(new ae)}});null===(i=t.canceler)||void 0===i||i.call(t,(function(){c.unsubscribe()}))}))},ns=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},rs=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},is=Ai("internal/bindDevice/bindDevice");function os(e){var t=this,n=e.userId,r=e.mac,i=e.language,o=e.onConfirmBind;return new K((function(e){if(oa({mac:r}).connected){var c=vo({mac:r});if(c){var u=c.deviceId;po({deviceId:u,mac:r,saveToStorage:!0}),e.next({state:"waitUserConfirm"}),xi.BLEManager.bindDevice(u,oc({scanResult:{},bindUserId:n,languageConfig:i,listeners:{onConfirmBind:function(){return ns(t,void 0,void 0,(function(){return rs(this,(function(t){return o?(e.next({state:"startConfirmBind"}),is.debug("startConfirmBind"),[2,o()]):[2,{success:!0}]}))}))}}})).then((function(t){is.debug("bindDevice success",t),e.next({state:"success"}),e.complete()}),(function(t){var n;if(e.next({state:"error"}),t instanceof Ku.Error)e.error(t);else if(1!==(null==t?void 0:t.code)){if(2===(null==t?void 0:t.code)){var r=null===(n=null==t?void 0:t.originResponse)||void 0===n?void 0:n.BindReqAck;if(2===r)return void e.error(new Ku.Error("设备拒绝绑定，已被其他用户绑定",s.DeviceAlreadyBind,{error:t}));if(3===r)return void e.error(new Ku.Error("设备拒绝绑定，正在充电中",s.DeviceCharging,{error:t}))}3!==(null==t?void 0:t.code)?4!==(null==t?void 0:t.code)?(is.debug("bindDevice error",t),e.error(new Ku.Error("未知异常",a.Unknow,{error:t}))):e.error(new Ku.Error("onConfirmBind 函数返回结果中 success 不为 true",s.OnConfirmBindResultNotSuccess,{confirmResult:t.value.confirmResult})):e.error(new Ku.Error("onConfirmBind 发生异常",s.OnConfirmBindError,{error:t}))}else e.error(new Ku.Error("用户拒绝绑定",s.UserDeny,{error:t}))}))}else e.error(new Ku.Error("绑定设备，找不到设备",s.NotFoundDevice))}else e.error(new Ku.Error("绑定设备，设备未连接",s.NotConnected))}))}function as(e){var t=e.mac,n=e.userId,r=e.language,i=e.onConfirmBind,o=e.onStateChange,a=e.canceler;return ts(os({mac:t,userId:n,language:r,onConfirmBind:i}),{next:o,canceler:a})}var cs=Ai("internal/bindDevice/connectAndBindDevice");function us(e){var t=e.mac,n=e.userId,r=e.language,i=e.onConfirmBind,o=e.onStateChange,c=e.canceler;return ts(function(e){var t=e.mac,n=e.userId,r=e.language,i=e.onConfirmBind;return new K((function(e){var o=!1,c=!1;e.next({state:"connectStart"}),dt(1).pipe(He((function(){return ra({mac:t}).pipe(Re((function(){o=!0})),wt((function(e){if(cs.debug("连接异常",e),e instanceof Fi.Error)throw new Qu.Error(e.message,e.code,{error:e});throw new Qu.Error("连接设备未知异常",a.Unknow,{error:e})})))})),Re((function(){e.next({state:"connectSuccess"})})),He((function(){return os({mac:t,userId:n,language:r,onConfirmBind:i}).pipe(wt((function(e){if(cs.debug("绑定异常",e),e instanceof Ku.Error)throw new Qu.Error(e.message,e.code,e.data);throw new Qu.Error("绑定未知异常",a.Unknow,{error:e})})))})),wt((function(e){if(c=!0,cs.debug("连接设备并进行绑定失败 发生异常",e,e instanceof Qu.Error),e instanceof Qu.Error)throw e;throw new Qu.Error("连接设备并进行绑定失败, 未知异常",a.Unknow,{error:e})})),Li((function(){cs.debug("连接并绑定设备 结束, isError=".concat(c,", connected=").concat(o)),c&&o&&ia({mac:t})}))).subscribe(e)}))}({mac:t,userId:n,language:r,onConfirmBind:i}),{next:o,canceler:c})}var ss=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},ls=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};function fs(e){var t=e.mac,n=e.bindUserId;return ss(this,void 0,void 0,(function(){var e,r,i;return ls(this,(function(o){switch(o.label){case 0:if(!vo({mac:t}))throw new Error("没找到对应 mac");o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Iu({mac:t,requestType:"Unbind",data:{account:n}})];case 2:return e=o.sent(),[3,4];case 3:throw r=o.sent(),console.error(r),r;case 4:return o.trys.push([4,6,,7]),[4,ia({mac:t})];case 5:return o.sent(),Zi({mac:t}),[3,7];case 6:return i=o.sent(),console.error(i),[3,7];case 7:return[2,e]}}))}))}var ds=o("A700"),ps=o("A701"),hs=o("A702"),vs=o("A703"),ys=we("band-bluetooth-wxapp-sdk/internal/ota/initMainService");function gs(e){var t=e.deviceId,n=ds;return dt(1).pipe(Re((function(){ys.debug("初始化主服务特征值 开始")})),He((function(){return function(e){var t=e.deviceId,n=e.serviceId;return dt(1).pipe(Re((function(){return Mr.debug("获取蓝牙设备某个服务中所有特征值 deviceId=".concat(t,", serviceId=").concat(n," 开始"))})),He((function(){return St(bn)({deviceId:t,serviceId:n})})),Se((function(e){if(e.error)throw e.error;return e.success})),wt((function(e){throw Mr.debug("获取蓝牙设备某个服务中所有特征值 deviceId=".concat(t," 失败")),e})),Re((function(e){return Mr.debug("获取蓝牙设备某个服务中所有特征值 deviceId=".concat(t,", serviceId=").concat(n," 成功"),e)})))}({deviceId:t,serviceId:n})})),Re((function(e){ys.debug("初始化主服务特征值 获取特征值成功",e)})),Se((function(e){return function(e){var t=e.reduce((function(e,t){return e[t.uuid]=t,e}),{}),n=t[ps];if(!n)throw new Error("主服务不存在 A701 通道");if(!n.properties.indicate)throw new Error("主服务 A701 特征值不支持 indicate");var r=t[hs];if(!r)throw new Error("主服务不存在 A702 特征值");if(!r.properties.write)throw new Error("主服务 A702 特征值不支持 write");var i=t[vs];if(!i)throw new Error("主服务不存在 A703 特征值");if(!i.properties.write)throw new Error("主服务 A703 特征值不支持 write");return{A701:n,A702:r,A703:i}}(e.characteristics)})),He((function(e){ys.debug("初始化主服务特征值 处理特征值",e);var r=[];return r.push(function(e){var t=e.deviceId,n=e.serviceId,r=e.characteristic;return function(e){var t=e.deviceId,n=e.serviceId,r=e.characteristicId,i=e.state;return Bn((function(){return $r.debug("订阅特征值 deviceId=".concat(t,", serviceId=").concat(n,", characteristicId=").concat(r," 开始")),St(In)({deviceId:t,serviceId:n,characteristicId:r,state:i})})).pipe(Se((function(e){if(e.error)throw e.error;return e.success})),wt((function(e){throw $r.debug("订阅特征值 deviceId=".concat(t,", serviceId=").concat(n,", characteristicId=").concat(r," 失败")),e})),Re((function(e){return $r.debug("订阅特征值 deviceId=".concat(t,", serviceId=").concat(n,", characteristicId=").concat(r," 成功"),e)})))}({deviceId:t,serviceId:n,characteristicId:r.uuid,state:!0}).pipe(Se((function(e){return{characteristic:r,notifyResult:e}})))}({deviceId:t,serviceId:n,characteristic:e.A701}).pipe(Se((function(e){return{A701:e}})))),r.push(dt({A702:{characteristic:e.A702}})),r.push(dt({A703:{characteristic:e.A703}})),Xe(r)})),Je(),Co((function(e,t){return Object.assign(e,t),e})),Re((function(e){return ys.debug("初始化主服务特征值 成功",e)})),wt((function(e){throw ys.debug("初始化主服务特征值 异常",e),e})))}var ms=new Map;function bs(e){if("fields"in e&&e.fields)return ws(e);if("decode"in e&&e.decode)return e;if("encode"in e&&e.encode)return e;throw new Error("无效的类型配置")}function ws(e){var t=Object.keys(e.fields).map((function(t){return{fieldName:t,fieldConfig:e.fields[t]}})).sort((function(e,t){return e.fieldConfig.id-t.fieldConfig.id})).map((function(e){var t=e.fieldName,n=e.fieldConfig,r=function(e,t){if("string"==typeof t.type){var n=ms.get(t.type);if(!n)throw new Error("解析类型配置 fieldName=".concat(e,", type=").concat(t.type,": 找不到类型"));return n}return bs(t.type)}(t,n);return function(e,t){t.array&&void 0!==t.size&&console.warn("解析类型配置 fieldName=".concat(e,", type=").concat(t.type,": array 为 true 时，不需要设置 size; 如需设置 type 的大小，请用 itemSize; 如需设置 数组 size 请用 arraySize；"))}(t,n),function(e,t){if(void 0!==t.size&&t.size<=0)throw new Error("解析类型配置 fieldName=".concat(e,", type=").concat(t.type,": size 不能少于等于 0"))}(t,n),n.array?function(e){var t=e.fieldName,n=e.fieldConfig,r=e.type,i=function(e){var t,n=e.fieldConfig,r=e.fieldName,i=e.type,o=n.itemSize||i.size;if(void 0===o)throw new Error("解析类型配置 fieldName=".concat(r,", type=").concat(n.type,": 使用数组时，必须确定数组每一个值的 size (type 有预设 size 或 手动设置 itemSize)"));if(void 0!==n.arraySize&&n.arraySize<=0)throw new Error("解析类型配置 fieldName=".concat(r,", type=").concat(n.type,": arraySize 不能少于等于 0"));"number"==typeof n.arraySize&&(t=n.arraySize*o);return{size:t,itemSize:o}}({fieldConfig:n,fieldName:t,type:r});return{fieldName:t,type:r,reversed:n.reversed,optional:n.optional,size:i.size,array:{itemSize:i.itemSize,itemReversed:n.itemReversed,arraySize:n.arraySize}}}({fieldName:t,fieldConfig:n,type:r}):function(e){var t,n=e.fieldName,r=e.fieldConfig,i=e.type,o=null!==(t=r.size)&&void 0!==t?t:i.size;return{fieldName:n,type:i,reversed:r.reversed,optional:r.optional,size:o}}({fieldName:t,fieldConfig:n,type:r})})),n=0;for(var r in t){var i=t[r];if("number"!=typeof i.size){n=void 0;break}n+=i.size}return{fields:t,size:n}}function Ss(e,t){var n=bs(t);ms.set(e,n)}var Is={decode:function(e){return kr(e.buffer)},encode:function(e){var t=e.data,n=t.length;if(n%2!=0)throw new Error("hex encode, hex 长度应为 2 的倍数");n/=2;for(var r=new Uint8Array(n),i=0;i<n;i++){var o=t.substr(2*i,2),a=parseInt(o,16);r.set([a],i)}return r}},Cs={size:1,decode:function(e){var t=e.buffer;return new DataView(t).getUint8(0)},encode:function(e){var t=e.data;return new Uint8Array([t])}},_s={size:2,decode:function(e){var t=e.buffer;return new DataView(t).getUint16(0)},encode:function(e){var t=e.data,n=new Uint8Array(2);return new DataView(n.buffer).setUint16(0,t),n}},Ds={size:4,decode:function(e){var t=e.buffer;return new DataView(t).getUint32(0)},encode:function(e){var t=e.data,n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}},Ts={decode:function(e){return cc(e.buffer)}};function Es(e){return new Uint8Array(e).reverse().buffer}Ss("bytes",{decode:function(e){return e.buffer},encode:function(e){var t=e.data;return new Uint8Array(t)}}),Ss("hex",Is),Ss("uint8",Cs),Ss("uint16",_s),Ss("uint32",Ds),Ss("string",Ts);var As=we("byte-handler/internal/decode/decode");function xs(e){var t=e.type,n=e.buffer,r=e.reversed;As.debug("decode 开始",t);var i=ws(t);As.debug("decode parsedType",i);var o=ks({type:i,buffer:n,reversed:r});return As.debug("decode data",o),o}function Os(e){var t=e.field,n=e.buffer;return t.array?function(e){var t=e.field,n=e.buffer,r=t.array;if(!r)throw new Error("decodeArrayField: array 不存在");var i=t.reversed?Es(n):n,o=Math.ceil(i.byteLength/r.itemSize);return Array.from({length:o}).map((function(e,n){var a=n===o-1?void 0:(n+1)*r.itemSize,c=i.slice(n*r.itemSize,a);return Bs({type:t.type,buffer:c,reversed:r.itemReversed})}))}({field:t,buffer:n}):Bs({type:t.type,buffer:n,reversed:t.reversed})}function ks(e){for(var t=e.type,n=e.buffer,r=e.reversed?Es(n):n,i=0,o={},a=0;a<t.fields.length;a++){var c=t.fields[a];try{var u=a===t.fields.length-1,s=void 0,l=Ls({field:c,data:o});if(void 0===l){if(!u)throw(d=new Error("无效的 field=".concat(c.fieldName,"，不是最后一个字段，缺少 size"))).type=t,d}else if((s=i+l)&&r.byteLength<s){if(c.optional)break;throw new Error("实际数据大小 少于 期望解析的数据大小 ")}var f=r.slice(i,s);o[c.fieldName]=Os({field:c,buffer:f}),void 0!==s&&(i=s),As.getLevel()<=As.levels.DEBUG&&As.debug("fieldName=".concat(c.fieldName,", size=").concat(l,", offset=").concat(i,", end=").concat(s,", fieldBuffer=").concat(kr(f),", fieldValue=").concat(o[c.fieldName]))}catch(e){var d=e;throw new Error("解析 field=".concat(c.fieldName,"异常: ").concat(d.message))}}return o}function Bs(e){var t=e.type,n=e.buffer,r=e.reversed;if("fields"in t&&t.fields)return ks({type:t,buffer:n,reversed:r});if("decode"in t&&t.decode)return t.decode({buffer:r?Es(n):n});throw new Error("无效类型")}function Ls(e){var t=e.field,n=e.data;if(t.array){var r=Ps({size:t.array.arraySize,data:n});return void 0===r?r:r*t.array.itemSize}if(void 0!==t.size)return Ps({size:t.size,data:n})}function Ps(e){var t=e.size,n=e.data;if(void 0!==t){if("number"==typeof t)return t;if("object"==typeof t){if("number"==typeof t.decode)return t.decode;if("function"==typeof t.decode){var r=t.decode({data:n}),i=typeof r;if("number"!==i&&"undefined"!==i)throw new Error("size.decode 返回的值的类型不对，只能是 undefined 或 number");return r}}throw new Error("无效的 size 类型不对 field.size=".concat(t))}}var Ns=we("byte-handler/internal/encode/encode");function Ms(e){var t=e.type,n=e.data,r=e.reversed;Ns.debug("encode 开始",t);var i=ws(t);Ns.debug("encode parsedType",i);var o=js({type:i,data:n,reversed:r});return Ns.debug("encode uint8Array",o),o.buffer}function js(e){var t=e.type,n=e.data,r=e.reversed,i=[];for(var o in t.fields){var a=t.fields[o],c=n[a.fieldName];if(a.optional&&void 0===c)break;var u=Rs({field:a,data:c});i.push(u)}var s=Fs(i);return r?s.reverse():s}function Rs(e){var t=e.field,n=e.data;if(void 0===n)throw new Error("字段 field=".concat(t.fieldName," 数据不存在"));return t.array?function(e){var t=e.field,n=e.data,r=e.reversed;if(!t.array)throw new Error("encodeArrayField: array 不存在");var i=n.map((function(e){return Us({type:t.type,data:e,reversed:t.reversed})})),o=Fs(i);return r?o.reverse():o}({field:t,data:n,reversed:t.reversed}):Us({type:t.type,data:n,reversed:t.reversed})}function Us(e){var t=e.type,n=e.data,r=e.reversed;if("fields"in t&&t.fields)return js({type:t,data:n,reversed:r});if("encode"in t&&t.encode){var i=t.encode({data:n});return r?i.reverse():i}throw new Error("无效类型")}function Fs(e){var t=e.reduce((function(e,t){return e+t.length}),0),n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}var $s=function(){return $s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$s.apply(this,arguments)},qs={commandId:{id:1,type:"uint8"},frameId:{id:2,type:"uint8"}},Vs={fields:$s($s({},qs),{dataLength:{id:3,type:"uint8"},data:{id:4,type:"bytes"}})},Gs={fields:$s($s({},qs),{data:{id:3,type:"bytes"}})},zs=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},Hs=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Ws=we("band-bluetooth-wxapp-sdk/internal/ota/send"),Js=ds;function Zs(e,t,n){var r=Ms({type:Vs,data:n});return Nr({deviceId:e,serviceId:Js,characteristicId:t,value:r})}function Ks(e,t,n){var r=Ms({type:Gs,data:n});return Nr({deviceId:e,serviceId:Js,characteristicId:t,value:r})}var Qs=17,Ys=18;function Xs(e){var t=e.deviceId,n=e.characteristicId,r=e.sendData;return zs(this,void 0,void 0,(function(){var e,i,o,a,c,u,s,l,f;return Hs(this,(function(d){switch(d.label){case 0:return e=r.data,i={commandId:r.commandId,frameId:1,dataLength:e.byteLength,data:e.slice(0,17)},o=[],[4,Zs(t,n,i)];case 1:a=d.sent(),o.push(a),c=function(e,t){if(t.data.byteLength<=Qs)return[];var n=Math.ceil((t.data.byteLength-Qs)/Ys),r=Array.from({length:n}).map((function(n,r){var i=Qs+r*Ys;return{commandId:e,data:t.data.slice(i,i+Ys),frameId:r+2}}));return r}(r.commandId,r),u=0,s=c,d.label=2;case 2:return u<s.length?(l=s[u],[4,Ks(t,n,l)]):[3,5];case 3:f=d.sent(),o.push(f),d.label=4;case 4:return u++,[3,2];case 5:return Ws.debug("获取下发的帧数数据",o),[2,o]}}))}))}var el=function(){return el=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},el.apply(this,arguments)},tl={u8RspCmdId:{id:1,type:"uint8"},u8RspCode:{id:2,type:"uint8"}},nl={fields:el({},tl)},rl={fields:el(el({},tl),{u8MaxFrmPerInter:{id:3,type:"uint8"},u8CntFrmBufBlock:{id:4,type:"uint8"},u32OffsetDnldStart:{id:6,type:"uint32"},u32OffsetDnldCurrent:{id:7,type:"uint32"},u32SizeNeedDnld:{id:8,type:"uint32"}})},il={fields:el(el({},tl),{u32OffsetNextBlock:{id:3,type:"uint32"},u16PercentDnlded:{id:4,type:"uint16"}})},ol=function(){return ol=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ol.apply(this,arguments)},al=we("band-bluetooth-wxapp-sdk/internal/ota/index");function cl(e){var t=e.deviceId;return lr({immediate:!0}).pipe(Me((function(e){return e?_e(an,cn):je}))).pipe(oe((function(e){return e.deviceId===t&&e.serviceId===ds&&e.characteristicId===ps})),Se((function(e){return xs({type:Vs,buffer:e.value})})),Se((function(e){var n={deviceId:t,commandId:e.commandId,originData:e.data,dataLength:e.dataLength,data:ul(e)};return al.debug("解析后的数据包",n),n})))}function ul(e){var t=xs({type:{fields:tl},buffer:e.data}),n=xs({type:sl(t.u8RspCmdId),buffer:e.data});return ol(ol({},t),n)}function sl(e){if(2===e)return rl;if(3===e)return il;if(4===e||5===e||6===e)return nl;throw new Error("收到未知命令, commandId=".concat(e))}var ll=[];function fl(){var e,t,n;for(t=0;t<256;t++){for(e=t,n=0;n<8;n++)1==(1&e)?e=3988292384^e>>>1:e>>>=1;ll.push(e>>>0)}}function dl(e){var t=0;0===ll.length&&fl();for(var n=e.length,r=0;r<n;r++){var i=parseInt((t^e[r])>>>0&255,10),o=t>>>8;t=(ll[i]^o)>>>0}return t}var pl={fields:{u32SizeTxedData:{id:1,type:"uint32"},u32CrcTxedData:{id:2,type:"uint32"},u32OffsetCurrent:{id:3,type:"uint32"}}},hl=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},vl=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},yl=ds,gl=vs,ml=we("band-bluetooth-wxapp-sdk/internal/ota/sendOtaFile");function bl(e){var t=e.deviceId,n=e.otaFile,r=e.u8MaxFrmPerInter,i=e.u8CntFrmBufBlock,o=e.offset;return hl(this,void 0,void 0,(function(){var e,a,c,u,s,l,f;return vl(this,(function(d){switch(d.label){case 0:e=r*i,a=n.slice(o,o+e),c=0,d.label=1;case 1:if(!(c<a.byteLength))return[3,6];u=c+r,s=a.slice(c,u),d.label=2;case 2:return d.trys.push([2,4,,5]),[4,Nr({deviceId:t,serviceId:yl,characteristicId:gl,value:s})];case 3:return d.sent(),[3,5];case 4:throw l=d.sent(),console.error("sentOTaFILE error",l),l;case 5:return c+=r,[3,1];case 6:ml.debug("FileData0x03",kr(Ms({type:pl,data:{u32CrcTxedData:dl(new Uint8Array(a)),u32OffsetCurrent:o,u32SizeTxedData:e}}))),d.label=7;case 7:return d.trys.push([7,9,,10]),[4,Xs({deviceId:t,characteristicId:hs,sendData:{commandId:3,data:Ms({type:pl,data:{u32CrcTxedData:dl(new Uint8Array(a)),u32OffsetCurrent:o,u32SizeTxedData:a.byteLength}})}})];case 8:return[2,d.sent()];case 9:throw f=d.sent(),ml.error("发送失败",f),f;case 10:return[2]}}))}))}var wl=n(983),Sl=n.n(wl)()((function(){return new Map}));function Il(e,t){Sl().set(e,t)}var Cl,_l=we("band-bluetooth-wxapp-sdk/internal/ota/index");function Dl(e){var t=function(e){var t,n,r=e.mac,i=e.otaFile,o=new K((function(e){t=e})),c=new K((function(e){n=e}));return{mainProcess:new K((function(e){t.next(Cl.State.Start),function(e){Il(e,{isUpgrading:!0})}(r);var o=vo({mac:r});if(o){var c=o.deviceId,u=cl({deviceId:c}).pipe(Nn()),s=u.subscribe();if(sa({mac:r}).subscribe((function(e){return e.connected}))){var f=dt(1).pipe(He((function(){return gs({deviceId:c}).pipe(mt({each:3e3,with:function(){return Bi((function(){return new Cl.Error("主服务初始化失败",l.NotFoundDevice)}))}}))})),Or(1)).pipe(He((function(){return Xs({deviceId:c,characteristicId:hs,sendData:{commandId:2,data:i.slice(0,120)}}),u.pipe(oe((function(e){return 2===e.data.u8RspCmdId&&0===e.data.u8RspCode})),de()).pipe(wt((function(e){return e instanceof Cl.Error?Bi((function(){return e})):Bi((function(){return new Cl.Error("ota升级异常，数据传输失败",a.Unknow,{error:e})}))})))})),Re((function(){t.next(Cl.State.DownLoadFileStart)})),He((function(e){var t=u.pipe(oe((function(e){return 3===e.data.u8RspCmdId})),mt({each:3e3,with:function(){return Bi((function(){return new Cl.Error("文件发送超时",l.Timeout)}))}})).pipe(Re((function(e){n.next(e.data.u16PercentDnlded/100),_l.debug("文件已发送百分比",e.data.u16PercentDnlded/100)}))).pipe(wt((function(e){return e instanceof Cl.Error?Bi((function(){return e})):Bi((function(){return new Cl.Error("ota升级异常，下发OTA文件出错",a.Unknow,{error:e})}))})));return function(e){var t=this,n=e.deviceId,r=e.otaFile,i=e.DataConfig,o=e.receiveData$,a=i.data,c=a.u8MaxFrmPerInter,u=a.u32OffsetDnldStart,s=a.u8CntFrmBufBlock,l=a.u32SizeNeedDnld;return new K((function(e){f(u);var i=0,a=o.subscribe((function(n){return hl(t,void 0,void 0,(function(){var t;return vl(this,(function(o){return t=n.data.u32OffsetNextBlock,i>2?[2]:0!==n.data.u8RspCode?(i=void 0===t?++i:0,f(t,i),[2]):t>=Math.min(l,r.byteLength-120)?(e.next(n),e.complete(),a.unsubscribe(),[2]):(f(t),[2])}))}))}));function f(e,t){return hl(this,void 0,void 0,(function(){var i,a,u;return vl(this,(function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),i=(null!=t?t:0)>0?20:c,[4,bl({deviceId:n,otaFile:r,receiveData$:o,u8MaxFrmPerInter:Math.max(i,20),offset:e,u8CntFrmBufBlock:s,u32SizeNeedDnld:l})];case 1:return a=f.sent(),ml.debug("0x03发送成功",a),[3,3];case 2:throw u=f.sent(),console.log("error"),u;case 3:return[2]}}))}))}return function(){a.unsubscribe()}}))}({deviceId:c,otaFile:i,DataConfig:e,receiveData$:t})})),Re((function(){t.next(Cl.State.DownLoadFileComplete)})),He((function(){return Xs({deviceId:c,characteristicId:hs,sendData:{commandId:4,data:new ArrayBuffer(0)}}),u.pipe(oe((function(e){return 4===e.data.u8RspCmdId})),de()).pipe(wt((function(e){return e instanceof Cl.Error?Bi((function(){return e})):Bi((function(){return new Cl.Error("ota升级异常，OTA文件校验失败",a.Unknow,{error:e})}))})))})),He((function(){return Xs({deviceId:c,characteristicId:hs,sendData:{commandId:5,data:new ArrayBuffer(0)}}),u.pipe(oe((function(e){return 5===e.data.u8RspCmdId})),de())}))).pipe(He((function(){return Xs({deviceId:c,characteristicId:hs,sendData:{commandId:6,data:new ArrayBuffer(0)}}),u.pipe(oe((function(e){return 6===e.data.u8RspCmdId})),de()).pipe(Re((function(){t.next(Cl.State.Complete)})),de(),wt((function(e){return e instanceof Cl.Error?Bi((function(){return e})):Bi((function(){return new Cl.Error("ota升级异常，OTA更新失败",a.Unknow,{error:e})}))})))}))).pipe(wt((function(e){return e instanceof Cl.Error?Bi((function(){return e})):Bi((function(){return new Cl.Error("ota升级异常，请检查蓝牙是否连接正常",a.Unknow,{error:e})}))}))).subscribe(e);return function(){n.unsubscribe(),t.unsubscribe(),s.unsubscribe(),f.unsubscribe(),function(e){Il(e,{isUpgrading:!1})}(r)}}e.error(new Cl.Error("请检查设备是否正常连接, mac=".concat(r),l.NotFoundDevice))}else e.error(new Cl.Error("找不到设备, mac=".concat(r),l.NotFoundDevice))})),state:o,uploadFilePercent:c}}(e),n=t.mainProcess,r=t.state,i=t.uploadFilePercent;return e.onStateChange&&r.subscribe((function(t){var n;null===(n=e.onStateChange)||void 0===n||n.call(e,t)})),e.onUploadFilePercent&&i.subscribe((function(t){var n;return null===(n=e.onUploadFilePercent)||void 0===n?void 0:n.call(e,t)})),ts(n,{canceler:e.canceler})}function Tl(e){return!(/^T[0-9]{3}$/.exec(e)&&Number(e.substr(1))<=11)}!function(e){!function(e){e.Start="start",e.DownLoadFileStart="downLoadFileStart",e.DownLoadFileComplete="downLoadFileComplete",e.Complete="complete"}(e.State||(e.State={})),e.Error=ve()}(Cl||(Cl={}))}();var i=exports;for(var o in r)i[o]=r[o];r.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})}();